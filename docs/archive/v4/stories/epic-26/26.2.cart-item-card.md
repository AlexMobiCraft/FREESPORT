# Story 26.2: Cart Item Card Component

## Status

Ready for Done

## Story

**–ö–∞–∫** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,  
**–Ø —Ö–æ—á—É** –≤–∏–¥–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º —Ç–æ–≤–∞—Ä–µ –≤ –∫–æ—Ä–∑–∏–Ω–µ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º,  
**–ß—Ç–æ–±—ã** —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π –∑–∞–∫–∞–∑ –ø–µ—Ä–µ–¥ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º.

## Dependencies

> [!NOTE]
> **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
>
> - [Story 26.1: CartPageLayout](26.1.cart-page-layout.md#relevant-source-tree): Cart Page Layout –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
> - [Story 12.3: cartStore](../epic-12/12.3.add-to-cart.md#cartstore-implementation): cartStore —Å Optimistic Updates (`updateQuantity`, `removeItem`)

## Acceptance Criteria

1. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (88x88px, border-radius: 12px)
2. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –∞—Ä—Ç–∏–∫—É–ª (SKU), —Ü–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä
3. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É –∏ —Å—É–º–º–∞ –ø–æ –ø–æ–∑–∏—Ü–∏–∏
4. –ö–Ω–æ–ø–∫–∏ +/- –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–∞
5. Input –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
6. –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ (–∏–∫–æ–Ω–∫–∞ üóë)
7. Optimistic Updates –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ quantity
8. –í–∞–ª–∏–¥–∞—Ü–∏—è quantity: min=1, max=99 (stock –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ CartItem)
9. Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞
10. Disabled state –¥–ª—è +/- –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ min/max quantity
11. Loading indicator –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ quantity (spinner –Ω–∞ –∫–Ω–æ–ø–∫–µ)
12. Image placeholder –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
13. Accessibility: aria-labels, keyboard navigation, role="spinbutton"

## Tasks / Subtasks

- [x] –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç CartItemCard (AC: 1-3)
  - [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/components/cart/CartItemCard.tsx`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É `'use client'`
  - [x] Props: `item: CartItem`, `onQuantityChange`, `onRemove`
  - [x] Layout: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π flex —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å–ª–µ–≤–∞
  - [x] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: 88x88px, object-cover, rounded-xl
  - [x] –ù–∞–∑–≤–∞–Ω–∏–µ: body-l, font-semibold
  - [x] SKU, —Ü–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä: body-s, text-secondary
  - [x] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ `frontend/src/components/cart/index.ts` (barrel export)

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Image Placeholder (AC: 12)
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ `item.product.image === null`
  - [x] Placeholder: —Å–µ—Ä—ã–π —Ñ–æ–Ω —Å –∏–∫–æ–Ω–∫–æ–π Package –∏–ª–∏ ImageOff
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `next/image` —Å onError fallback

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Quantity Selector (AC: 4-5, 8, 10-11)
  - [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/components/cart/QuantitySelector.tsx` (–æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
  - [x] –î–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É `'use client'`
  - [x] –ö–Ω–æ–ø–∫–∞ "-": —É–º–µ–Ω—å—à–∏—Ç—å quantity
  - [x] Input: –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ quantity
  - [x] –ö–Ω–æ–ø–∫–∞ "+": —É–≤–µ–ª–∏—á–∏—Ç—å quantity
  - [x] –í–∞–ª–∏–¥–∞—Ü–∏—è: quantity >= 1, quantity <= 99 (max hardcoded)
  - [x] Disabled states: "-" –ø—Ä–∏ quantity=1, "+" –ø—Ä–∏ quantity=99
  - [x] **Debounce input**: 300ms –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ API call
  - [x] Loading state: spinner –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–µ –ø—Ä–∏ `isUpdating`
  - [x] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ `frontend/src/components/cart/index.ts`
  - [x] Accessibility: `role="spinbutton"`, `aria-valuenow`, `aria-valuemin`, `aria-valuemax`

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Price Display (AC: 3)
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `formatPrice` –∏–∑ [`@/utils/pricing`](file:///c:/Users/38670/DEV_WEB/FREESPORT/frontend/src/utils/pricing.ts)
  - [x] ‚ö†Ô∏è –í–ê–ñ–ù–û: `unit_price` –∏ `total_price` –≤ CartItem ‚Äî —ç—Ç–æ **string** (Decimal), –Ω—É–∂–µ–Ω `parseFloat()`
  - [x] –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É: body-m, text-secondary
  - [x] –°—É–º–º–∞ –ø–æ–∑–∏—Ü–∏–∏: title-m, text-primary, font-bold

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Delete Action (AC: 6, 9)
  - [x] –ò–∫–æ–Ω–∫–∞ Trash2 –∏–∑ lucide-react
  - [x] Hover state: color ‚Üí danger
  - [x] Optimistic delete ‚Üí API call ‚Üí Toast notification
  - [x] Confirmation optional (–¥–ª—è MVP –±–µ–∑ confirmation)
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `toast` –∏–∑ `react-hot-toast` –∏–ª–∏ UI-Kit `@/components/ui/Toast`

- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å cartStore (AC: 7, 11)
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `updateQuantity(id, quantity)` action (–Ω–µ updateItemQuantity!)
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `removeItem(id)` action
  - [x] Optimistic updates —á–µ—Ä–µ–∑ cartStore
  - [x] –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `isLoading` –≤ QuantitySelector –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è loading state

- [x] –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã
  - [x] –¢–µ—Å—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤—Å–µ—Ö –ø–æ–ª–µ–π
  - [x] –¢–µ—Å—Ç +/- –∫–Ω–æ–ø–æ–∫ —Å Optimistic Updates
  - [x] –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
  - [x] –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ quantity bounds
  - [x] –¢–µ—Å—Ç image placeholder
  - [x] –¢–µ—Å—Ç debounce –Ω–∞ input
  - [x] –¢–µ—Å—Ç loading state

## Dev Notes

### Relevant Source Tree

```
frontend/src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ cart/
‚îÇ       ‚îú‚îÄ‚îÄ CartItemCard.tsx            (NEW)
‚îÇ       ‚îú‚îÄ‚îÄ QuantitySelector.tsx        (NEW - optional, can be inline)
‚îÇ       ‚îî‚îÄ‚îÄ __tests__/
‚îÇ           ‚îî‚îÄ‚îÄ CartItemCard.test.tsx   (NEW)
‚îú‚îÄ‚îÄ stores/
‚îÇ   ‚îî‚îÄ‚îÄ cartStore.ts                    (UPDATE - ensure actions exist)
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ cart.ts                         (EXISTS)
```

### CartItemCard Layout

```tsx
// CartItemCard.tsx - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ globals.css
<div 
  className="flex gap-4 p-6 bg-[var(--bg-panel)] rounded-[var(--radius-md)] 
             shadow-[var(--shadow-default)]" 
  data-testid="cart-item-card"
>
  {/* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ */}
  <div className="flex-shrink-0">
    <Image
      src={item.product.image}
      alt={item.product.name}
      width={88}
      height={88}
      className="rounded-[var(--radius)] object-cover" // 12px –∏–∑ design-system
    />
  </div>
  
  {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
  <div className="flex-1 flex flex-col justify-between">
    <div>
      <h3 className="text-body-l font-semibold text-[var(--color-text-primary)]">
        {item.product.name}
      </h3>
      <p className="text-body-s text-[var(--color-text-secondary)]">
        –ê—Ä—Ç: {item.variant.sku}
        {item.variant.color_name && ` | –¶–≤–µ—Ç: ${item.variant.color_name}`}
        {item.variant.size_value && ` | –†–∞–∑–º–µ—Ä: ${item.variant.size_value}`}
      </p>
    </div>
    
    {/* Quantity + Price Row */}
    <div className="flex items-center justify-between mt-4">
      <QuantitySelector
        value={item.quantity}
        min={1}
        max={99} // –°–æ–≥–ª–∞—Å–Ω–æ AC 8: stock –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ CartItem
        onChange={(qty) => handleQuantityChange(item.id, qty)}
      />
      
      <div className="text-right">
        <p className="text-body-s text-[var(--color-text-secondary)]">
          {formatPrice(item.unit_price)} √ó {item.quantity}
        </p>
        <p className="text-title-m font-bold text-[var(--color-text-primary)]">
          {formatPrice(item.total_price)}
        </p>
      </div>
    </div>
  </div>
  
  {/* Delete Button */}
  <button
    onClick={() => handleRemove(item.id)}
    className="flex-shrink-0 p-2 text-[var(--color-text-secondary)] 
               hover:text-[var(--color-accent-danger)] transition-colors"
    aria-label="–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä"
    data-testid="remove-item-button"
  >
    <Trash2 size={20} />
  </button>
</div>
```

### QuantitySelector Component

```tsx
// QuantitySelector.tsx - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ globals.css
<div className="inline-flex items-center border border-[var(--color-neutral-400)] rounded-[var(--radius-sm)]">
  <button
    onClick={() => onChange(value - 1)}
    disabled={value <= min}
    className="w-10 h-10 flex items-center justify-center text-[var(--color-text-primary)]
               disabled:opacity-50 disabled:cursor-not-allowed
               hover:bg-[var(--color-neutral-300)] transition-colors rounded-l-[var(--radius-sm)]"
    data-testid="quantity-decrement"
  >
    <Minus size={16} />
  </button>
  
  <input
    type="number"
    value={value}
    onChange={(e) => onChange(parseInt(e.target.value) || 1)}
    min={min}
    max={max}
    className="w-12 h-10 text-center text-body-m border-x border-[var(--color-neutral-400)]
               focus:outline-none focus:ring-[var(--focus-ring)] bg-[var(--bg-panel)]"
    data-testid="quantity-input"
  />
  
  <button
    onClick={() => onChange(value + 1)}
    disabled={value >= max}
    className="w-10 h-10 flex items-center justify-center text-[var(--color-text-primary)]
               disabled:opacity-50 disabled:cursor-not-allowed
               hover:bg-[var(--color-neutral-300)] transition-colors rounded-r-[var(--radius-sm)]"
    data-testid="quantity-increment"
  >
    <Plus size={16} />
  </button>
</div>
```

### Data Test IDs

| –≠–ª–µ–º–µ–Ω—Ç | data-testid | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------------|----------|
| –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ | `cart-item-card` | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ | `cart-item-image` | –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ |
| –ù–∞–∑–≤–∞–Ω–∏–µ | `cart-item-name` | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ |
| –ê—Ä—Ç–∏–∫—É–ª | `cart-item-sku` | SKU —Ç–æ–≤–∞—Ä–∞ |
| –ö–Ω–æ–ø–∫–∞ "-" | `quantity-decrement` | –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| Input –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ | `quantity-input` | –ü–æ–ª–µ –≤–≤–æ–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ |
| –ö–Ω–æ–ø–∫–∞ "+" | `quantity-increment` | –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É | `cart-item-unit-price` | –¶–µ–Ω–∞ –∑–∞ 1 —à—Ç |
| –û–±—â–∞—è —Å—É–º–º–∞ | `cart-item-total-price` | –°—É–º–º–∞ –ø–æ–∑–∏—Ü–∏–∏ |
| –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è | `remove-item-button` | –ò–∫–æ–Ω–∫–∞ üóë |

### TypeScript Types

```typescript
// Props interface
interface CartItemCardProps {
  item: CartItem;
  onQuantityChange?: (id: number, quantity: number) => Promise<void>;
  onRemove?: (id: number) => Promise<void>;
  isUpdating?: boolean; // Loading state from parent
}

// QuantitySelector props
interface QuantitySelectorProps {
  value: number;
  min?: number; // default: 1
  max?: number; // default: 99
  onChange: (value: number) => void;
  isLoading?: boolean;
  disabled?: boolean;
}

// CartItem type (from types/cart.ts)
// ‚ö†Ô∏è –í–ê–ñ–ù–û: unit_price –∏ total_price ‚Äî —ç—Ç–æ STRING (Decimal from backend)
interface CartItem {
  id: number;
  variant_id: number;
  product: {
    id: number;
    name: string;
    slug: string;
    image: string | null; // –º–æ–∂–µ—Ç –±—ã—Ç—å null!
  };
  variant: {
    sku: string;
    color_name: string | null;
    size_value: string | null;
  };
  quantity: number;
  unit_price: string;  // ‚ö†Ô∏è STRING! –ò—Å–ø–æ–ª—å–∑—É–π parseFloat()
  total_price: string; // ‚ö†Ô∏è STRING! –ò—Å–ø–æ–ª—å–∑—É–π parseFloat()
  added_at: string;
}
```

### Optimistic Updates Pattern

```typescript
const handleQuantityChange = async (itemId: number, newQuantity: number) => {
  // Optimistic update —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ cartStore
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º updateQuantity (—Å—Ç—Ä–æ–∫–∞ 20 –≤ cartStore.ts)
  const result = await updateQuantity(itemId, newQuantity);
  
  if (!result.success) {
    toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ');
    // Rollback –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ cartStore
  }
};

const handleRemove = async (itemId: number) => {
  const result = await removeItem(itemId);
  
  if (result.success) {
    toast.success('–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
  } else {
    toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä');
  }
};
```

## Testing

**Framework:** Vitest + React Testing Library

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

1. **Render:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π —Ç–æ–≤–∞—Ä–∞
2. **Quantity increment:** –ö–ª–∏–∫ –Ω–∞ "+" ‚Üí quantity —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
3. **Quantity decrement:** –ö–ª–∏–∫ –Ω–∞ "-" ‚Üí quantity —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
4. **Quantity bounds:** "-" disabled –ø—Ä–∏ quantity=1, "+" disabled –ø—Ä–∏ max
5. **Remove item:** –ö–ª–∏–∫ –Ω–∞ üóë ‚Üí –≤—ã–∑–æ–≤ onRemove
6. **Price calculation:** total_price = unit_price √ó quantity
7. **Image fallback:** Placeholder –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
8. **Debounce input:** –†—É—á–Ω–æ–π –≤–≤–æ–¥ quantity ‚Üí API –≤—ã–∑–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ 300ms (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `vi.useFakeTimers()` –∏ `vi.advanceTimersByTime(300)`)

## Definition of Done

- [x] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [x] Quantity selector —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (min=1, max=99)
- [x] Debounce –Ω–∞ input —Ä–∞–±–æ—Ç–∞–µ—Ç (300ms)
- [x] Loading state –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- [x] Optimistic Updates —Ä–∞–±–æ—Ç–∞—é—Ç —Å rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ
- [x] Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
- [x] Image placeholder –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [x] Unit —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç (62 —Ç–µ—Å—Ç–∞)
- [x] Barrel exports –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ index.ts
- [x] Accessibility: aria-labels, role="spinbutton", keyboard navigation

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4 (Cascade)

### Debug Log References

N/A - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫

### Completion Notes

- –°–æ–∑–¥–∞–Ω CartItemCard.tsx —Å –ø–æ–ª–Ω—ã–º layout –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å cartStore
- –°–æ–∑–¥–∞–Ω QuantitySelector.tsx —Å debounce 300ms, keyboard navigation, accessibility
- Image placeholder —Å Package icon –ø—Ä–∏ image === null
- Barrel exports –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ index.ts
- 62 unit —Ç–µ—Å—Ç–∞ (28 CartItemCard + 34 QuantitySelector)
- –í—Å–µ 121 —Ç–µ—Å—Ç –≤ cart/ –ø—Ä–æ—à–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—é
- Lint –ø—Ä–æ–π–¥–µ–Ω (—Ç–æ–ª—å–∫–æ warnings –æ–± –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–∞—Ö, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)

### File List

| File | Action |
|------|--------|
| frontend/src/components/cart/CartItemCard.tsx | NEW |
| frontend/src/components/cart/QuantitySelector.tsx | NEW |
| frontend/src/components/cart/index.ts | MODIFIED |
| frontend/src/components/cart/\_\_tests\_\_/CartItemCard.test.tsx | NEW |
| frontend/src/components/cart/\_\_tests\_\_/QuantitySelector.test.tsx | NEW |

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-07 | 1.0 | Initial story creation | Sarah (PO) |
| 2025-12-07 | 1.1 | –î–æ–±–∞–≤–ª–µ–Ω—ã: debounce, loading state, image placeholder, barrel exports, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã CartItem | Bob (SM) |
| 2025-12-07 | 1.2 | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è action name (updateQuantity), –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–µ–∫—Ü–∏–∏ –≤ Dependencies, –¥–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç-–∫–µ–π—Å –¥–ª—è debounce, —É—Ç–æ—á–Ω—ë–Ω –ø—É—Ç—å –∫ formatPrice | Sarah (PO) |
| 2025-12-07 | 1.3 | –í–∞–ª–∏–¥–∞—Ü–∏—è: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å stockQuantity ‚Üí 99 –≤ –ø—Ä–∏–º–µ—Ä–µ, GO –¥–ª—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ | Sarah (PO) |
| 2025-12-07 | 2.0 | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≤—Å–µ AC –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, 62 —Ç–µ—Å—Ç–∞ | James (Dev) |

## QA Results

### Review Date: 2025-12-07

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

**–û—Ü–µ–Ω–∫–∞: –û—Ç–ª–∏—á–Ω–æ ‚úì**

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Cart Item Card Component –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ:

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –¥–∏–∑–∞–π–Ω**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ `CartItemCard` –∏ `QuantitySelector`, –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–º–µ–µ—Ç —á—ë—Ç–∫—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –•–æ—Ä–æ—à–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeScript —Å –ø–æ–ª–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏.

2. **–ö–æ–¥ –∫–∞—á–µ—Å—Ç–≤–∞**:
   - `'use client'` –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Decimal —Å—Ç—Ä–æ–∫–∞–º–∏ (`parseFloat()`)
   - Image placeholder —Å Package –∏–∫–æ–Ω–∫–æ–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - Debounce 300ms —Å `useRef` –∏ cleanup –ø—Ä–∏ unmount
   - Keyboard navigation (ArrowUp/Down, Enter)

3. **Optimistic Updates**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å cartStore –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `updateQuantity` –∏ `removeItem` actions —Å rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

4. **Accessibility**: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî `role="spinbutton"`, `aria-valuenow/min/max`, `aria-label` –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö.

### Refactoring Performed

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞.

### Compliance Check

- Coding Standards: ‚úì –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
- Project Structure: ‚úì –§–∞–π–ª—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö, barrel exports –¥–æ–±–∞–≤–ª–µ–Ω—ã
- Testing Strategy: ‚úì 28 unit —Ç–µ—Å—Ç–æ–≤ (CartItemCard), 34 —Ç–µ—Å—Ç–∞ (QuantitySelector) ‚Äî –∏—Ç–æ–≥–æ 62 —Ç–µ—Å—Ç–∞
- All ACs Met: ‚úì –í—Å–µ 13 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

### Improvements Checklist

- [x] Debounce input (300ms) —Å cleanup
- [x] Loading spinner –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–µ (+/-)
- [x] Image placeholder —Å Package icon
- [x] Keyboard navigation (ArrowUp/Down, Enter)
- [x] Accessibility: role="spinbutton", aria-labels
- [x] Toast notifications (react-hot-toast)
- [x] Barrel exports –≤ index.ts
- [x] String price parsing (parseFloat)
- [x] Validation bounds (min=1, max=99)
- [ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ confirmation modal –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–æ—Ç–ª–æ–∂–µ–Ω–æ –¥–ª—è MVP)
- [ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ (fade-out transition)

### Security Review

–ù–µ—Ç security concerns ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, –≤—Å–µ API –≤—ã–∑–æ–≤—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ cartService.

### Performance Considerations

- ‚úì Debounce 300ms –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ª–∏—à–Ω–∏–µ API –≤—ã–∑–æ–≤—ã
- ‚úì –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π UI –æ—Ç–∫–ª–∏–∫
- ‚úì `next/image` —Å lazy loading –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úì –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ª—ë–≥–∫–∏–π

### Files Modified During Review

–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Äî –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º.

### Gate Status

Gate: **PASS** ‚Üí `docs/qa/gates/26.2-cart-item-card.yml`

### Recommended Status

**‚úì Ready for Done**

–í—Å–µ Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, –∫–æ–¥ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π. Story –≥–æ—Ç–æ–≤ –∫ –∑–∞–∫—Ä—ã—Ç–∏—é.
