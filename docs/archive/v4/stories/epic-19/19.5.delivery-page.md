# Story 19.5: Страница «Доставка» (/delivery)

<!-- Powered by BMAD™ Core -->

## Status

Ready for Review

---

## Story

**As a** покупатель,  
**I want** узнать условия доставки,  
**so that** я могу спланировать получение заказа.

---

## Acceptance Criteria

1. [x] Создана страница /delivery
2. [x] Hero-секция с заголовком
3. [x] Секция «Доставка до ТК» (карточка с badge «БЕСПЛАТНО»)
4. [x] Секция «Самовывоз» (карточка с адресом)
5. [x] Яндекс.Карты или ссылка на карту (lazy load)
6. [x] Секция контактов логистики (телефон, email как ссылки)
7. [x] Breadcrumb навигация
8. [x] SEO метаданные

---

## Dependencies

> [!IMPORTANT]
> **Блокирующая зависимость:** Story 19.1 (компоненты).

---

## Tasks / Subtasks

### Task 1: Создать страницу /delivery (AC: 1, 8)

- [x] 1.1 Создать `frontend/src/app/delivery/page.tsx`
- [x] 1.2 Настроить SEO metadata

### Task 2: Реализовать Hero-секцию (AC: 2)

- [x] 2.1 Заголовок h1: «Условия доставки»
- [x] 2.2 Подзаголовок: «Мы предлагаем удобные варианты получения заказа»

### Task 3: Реализовать секцию «Доставка до ТК» (AC: 3)

- [x] 3.1 Создать карточку с описанием доставки до ТК
- [x] 3.2 Добавить badge «БЕСПЛАТНО от 35 000 ₽» (использовать `Badge` variant="delivered")
- [x] 3.3 Описание условий:
  - Согласуем выбранную ТК после оформления заказа
  - Доставим до терминала без дополнительной платы
  - Дальнейшую доставку осуществляет ТК по её тарифам

### Task 4: Реализовать секцию «Самовывоз» (AC: 4)

- [x] 4.1 Создать карточку с информацией о самовывозе
- [x] 4.2 Минимальный заказ: от 1 500 ₽
- [x] 4.3 Адрес: г. Ставрополь, ул. Коломийцева, 40/1
- [x] 4.4 Примечание: «Перед приездом уточните готовность заказа»

### Task 5: Интегрировать карту (AC: 5)

- [x] 5.1 Создать компонент `MapEmbed` с lazy loading
- [x] 5.2 Опция 1: Яндекс.Карты iframe (если есть API-ключ)
- [x] 5.3 Опция 2: Статическое изображение + ссылка на Яндекс.Карты
- [x] 5.4 Использовать `loading="lazy"` для iframe

### Task 6: Реализовать секцию контактов (AC: 6)

- [x] 6.1 Телефон: `+7 968 273-21-68` (ссылка `tel:`)
- [x] 6.2 Email: `logist@freesportopt.ru` (ссылка `mailto:`)
- [x] 6.3 Иконки: Phone, Mail из lucide-react

### Task 7: Добавить Breadcrumb (AC: 7)

- [x] 7.1 Структура: Главная → Доставка

### Task 8: Добавить unit-тесты

- [x] 8.1 Создать `frontend/src/app/delivery/__tests__/page.test.tsx`

---

## Dev Notes

### Структура страницы

[Source: docs/frontend/info-pages-spec.md#4.6 Страница /delivery]

```
┌─────────────────────────────────────────────────────────┐
│ Главная / Доставка                       [Breadcrumb]  │
├─────────────────────────────────────────────────────────┤
│ ┌─ HERO ──────────────────────────────────────────────┐ │
│ │                Условия доставки                    │ │
│ │   Мы предлагаем удобные варианты получения заказа │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─ ДОСТАВКА ДО ТК ────────────────────────────────────┐ │
│ │  🚚 Доставка до транспортной компании              │ │
│ │  ┌───────────────────────────┐                     │ │
│ │  │   БЕСПЛАТНО от 35 000 ₽   │                     │ │
│ │  └───────────────────────────┘                     │ │
│ │  • Согласуем выбранную ТК после оформления         │ │
│ │  • Доставим до терминала без дополнительной платы  │ │
│ │  • Дальнейшую доставку осуществляет ТК             │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─ САМОВЫВОЗ ─────────────────────────────────────────┐ │
│ │  📍 Самовывоз со склада                            │ │
│ │  Минимальный заказ: от 1 500 ₽                     │ │
│ │  Адрес: г. Ставрополь, ул. Коломийцева, 40/1       │ │
│ │  ┌─────────────────────────────────────────────┐   │ │
│ │  │              [ЯНДЕКС КАРТА]                 │   │ │
│ │  └─────────────────────────────────────────────┘   │ │
│ │  ⚠️ Перед приездом уточните готовность заказа      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─ КОНТАКТЫ ──────────────────────────────────────────┐ │
│ │  📞 +7 968 273-21-68                               │ │
│ │  📧 logist@freesportopt.ru                         │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### Компоненты

```typescript
import { Badge, Breadcrumb, InfoPanel, SupportPanel } from '@/components/ui';
import { Truck, MapPin, Phone, Mail, AlertTriangle } from 'lucide-react';
```

### Данные для доставки

```typescript
const deliveryOptions = {
  tk: {
    icon: Truck,
    title: 'Доставка до транспортной компании',
    badge: 'БЕСПЛАТНО от 35 000 ₽',
    conditions: [
      'Согласуем выбранную ТК после оформления заказа',
      'Доставим до терминала без дополнительной платы',
      'Дальнейшую доставку осуществляет ТК по её тарифам',
    ],
  },
  pickup: {
    icon: MapPin,
    title: 'Самовывоз со склада',
    minOrder: 'от 1 500 ₽',
    address: 'г. Ставрополь, ул. Коломийцева, 40/1',
    warning: 'Перед приездом уточните готовность заказа по телефону',
  },
};
```

### Контакты

```typescript
const contacts = {
  phone: '+7 968 273-21-68',
  phoneLink: 'tel:+79682732168',
  email: 'logist@freesportopt.ru',
  emailLink: 'mailto:logist@freesportopt.ru',
};
```

### Яндекс.Карты

```typescript
// Опция 1: iframe с lazy loading
<iframe
  src="https://yandex.ru/map-widget/v1/?ll=41.977485%2C45.018893&z=17&pt=41.977485,45.018893,pm2rdm"
  width="100%"
  height="300"
  loading="lazy"
  title="Пункт самовывоза FREESPORT"
/>

// Опция 2: Ссылка на карту
<a 
  href="https://yandex.ru/maps/-/CDqxXDAv" 
  target="_blank" 
  rel="noopener noreferrer"
>
  Открыть на Яндекс.Картах
</a>
```

### SEO Metadata

```typescript
export const metadata: Metadata = {
  title: 'Доставка | FREESPORT',
  description: 'Условия доставки FREESPORT. Бесплатная доставка до ТК от 35 000 ₽. Самовывоз со склада в Ставрополе от 1 500 ₽.',
};
```

### Badge стили

```css
/* Бейдж "БЕСПЛАТНО" */
.badge-free {
  background: #E0F5E8;
  color: #00AA5B;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: 600;
}
```

---

## Testing

### Ключевые тест-кейсы

```typescript
describe('DeliveryPage', () => {
  it('renders breadcrumb');
  it('renders hero section');
  it('renders TK delivery card with badge');
  it('renders pickup card with address');
  it('renders map or map link');
  it('renders contact phone as tel: link');
  it('renders contact email as mailto: link');
});
```

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-22 | 1.0 | Начальный черновик истории | Bob (SM) |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References

N/A - Разработка прошла без критических проблем

### Completion Notes List

- ✅ Создана страница /delivery с полной функциональностью
- ✅ Реализованы все 8 Acceptance Criteria
- ✅ Hero-секция с заголовком и подзаголовком
- ✅ Секция «Доставка до ТК» с badge «БЕСПЛАТНО от 35 000 ₽» (variant="delivered")
- ✅ Секция «Самовывоз» с адресом и минимальным заказом
- ✅ Интегрирована Яндекс.Карта с lazy loading (iframe)
- ✅ Секция контактов с кликабельными ссылками (tel: и mailto:)
- ✅ Breadcrumb навигация: Главная → Доставка
- ✅ SEO metadata: title и description
- ✅ Использованы компоненты из Story 19.1: Breadcrumb, Badge, Card
- ✅ Иконки из lucide-react: Truck, MapPin, Phone, Mail, AlertTriangle
- ✅ Написаны unit-тесты с покрытием всех функций (29 тестов)
- ✅ Все тесты пройдены успешно
- ✅ ESLint проверка пройдена без ошибок
- ✅ Предупреждение о готовности заказа с иконкой AlertTriangle

### File List

**Созданные файлы:**

- frontend/src/app/delivery/page.tsx
- frontend/src/app/delivery/\_\_tests\_\_/page.test.tsx

**Модифицированные файлы:**

- docs/stories/epic-19/19.5.delivery-page.md (обновлены чекбоксы AC и Tasks)

---

## QA Results

_To be filled by QA Agent_
