# История 28.2: Поток регистрации B2B

**Эпик**: [28: Реализация системы аутентификации](../../epics/epic-28/epic-28-authentication.md)
**Статус**: Черновик
**Приоритет**: Высокий

## Пользовательская история (User Story)

**Как** Бизнес-партнер (B2B),
**Я хочу** зарегистрироваться, указав реквизиты компании,
**Чтобы** получить доступ к оптовым ценам.

## Контекст истории

**Интеграция с существующей системой:**

- **Интегрируется с**: Backend Endpoints регистрации B2B, `authStore`
- **Технологии**: Next.js Data Fetching, React Hook Form, Zod (кастомные валидаторы)
- **Точки взаимодействия**:
  - `src/app/(auth)/b2b-register/page.tsx`
  - `src/services/authService.ts`

## Критерии приемки (Acceptance Criteria)

### Функциональные требования

1. **Форма регистрации B2B:**
   - Отдельная страница по адресу `/b2b-register`.
   - Поля: Название компании, ИНН, ОГРН, Юридический адрес, Контактное лицо.
   - При успехе: отображение сообщения "Заявка на рассмотрении" или переход в статус ожидания (уточнить поведение бэкенда).

2. **Валидация:**
   - **ИНН**: Числовой, строгая проверка длины (10 или 12 цифр в зависимости от типа лица).
   - **ОГРН**: Числовой, проверка специфичного формата.
   - Обязательные поля строго проверяются.

3. **UI/UX:**
   - Четкое визуальное отличие, что это форма для "Бизнес-партнеров".
   - Ссылка обратно на стандартную регистрацию B2C ("Не бизнес-клиент? Регистрация здесь").

### Требования к интеграции

4. Отправка данных на корректный эндпоинт регистрации B2B (или использование флага `type: 'b2b'` в общем методе).
5. Обработка ошибок, специфичная для кейса "Компания уже зарегистрирована" (409).

### Требования к качеству

7. Unit-тесты для логики валидации ИНН/ОГРН.
8. Доступность: Форма доступна для навигации с клавиатуры, лейблы понятны.

## Технические заметки

- **Подход к интеграции**: Изучить Backend API на предмет структуры пейлоада для B2B.
- **Ключевые ограничения**:
  - Алгоритмы валидации ИНН (контрольная сумма) в идеале должны быть реализованы или использована библиотека. Для MVP обязательна проверка длины и числового формата.
  - Состояние должно обрабатывать статус пользователя "Pending" (На рассмотрении), если бэкенд возвращает пользователя, но он еще не активен.

## Критерии готовности (Definition of Done)

- [ ] Страница регистрации B2B реализована
- [ ] Валидация ИНН/ОГРН работает
- [ ] Интеграция с API завершена
- [ ] Состояние/сообщение "На рассмотрении" обработано
- [ ] Unit-тесты для валидаторов пройдены
