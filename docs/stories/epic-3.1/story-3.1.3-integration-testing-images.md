# Story 3.1.3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - Brownfield Enhancement

## Status

Ready

## Business Value

**Why is this important?**
–≠—Ç–∞ –∏—Å—Ç–æ—Ä–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∫–ª—é—á–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∞ –∫–∞—Ç–∞–ª–æ–≥–∞. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—é. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç–∏—Ç –Ω–∞—Å –æ—Ç –±—É–¥—É—â–∏—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–π, —Å–Ω–∏–∑–∏—Ç —Ä–∏—Å–∫–∏ –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö –≤—Å–µ–≥–¥–∞ –±—É–¥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤–µ—Ä–Ω–æ.

## Story

**As a** –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏,
**I want to** —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π,
**so that** –º—ã –º–æ–∂–µ–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏ –∏–º–ø–æ—Ä—Ç–∞, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –±—É–¥—É—â–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## Acceptance Criteria

### AC 1: Happy Path - –°—Ü–µ–Ω–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
- [ ] **E2E —Ç–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç `test_import_catalog_with_images_full_workflow()`, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Ä–µ–∞–ª—å–Ω—ã–µ XML –∏ —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ `data/import_1c/goods/`.
- [ ] **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –ë–î:** –¢–µ—Å—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ–ª—è `main_image` –∏ `gallery_images`.
- [ ] **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:** –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ—Å—Ç–æ–≤—ã–π `MEDIA_ROOT`.
- [ ] **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–≤—è–∑–µ–π:** –ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ XML —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `main_image`, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `gallery_images`.

### AC 2: Edge Cases - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- [ ] **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã:** –¢–µ—Å—Ç `test_import_with_missing_image_files()` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –∏–º–ø–æ—Ä—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç, –∞ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ `images_errors` > 0.
- [ ] **–î—É–±–ª–∏–∫–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:** –¢–µ—Å—Ç `test_import_with_duplicate_images()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è, –∞ —Å—á–µ—Ç—á–∏–∫ `images_skipped` –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.
- [ ] **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** –¢–µ—Å—Ç `test_import_with_invalid_image_format()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏–º–ø–æ—Ä—Ç.
- [ ] **–¢–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:** –¢–µ—Å—Ç `test_import_products_without_images()` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Ç–µ–≥–∞ `<–ö–∞—Ä—Ç–∏–Ω–∫–∞>`.
- [ ] **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç:** –¢–µ—Å—Ç `test_reimport_updates_images()` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–º–ø–æ—Ä—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è.

### AC 3: Feature Flags - –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏
- [ ] **–§–ª–∞–≥ `--skip-images`:** –¢–µ—Å—Ç `test_import_with_skip_images_flag()` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Ñ–ª–∞–≥–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è, –∞ `images_copied = 0`.

### AC 4: Non-Functional Requirements (NFR)
- [ ] **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç performance-—Ç–µ—Å—Ç `test_import_large_volume_images()` (–Ω–µ –º–µ–Ω–µ–µ 1000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π), –∫–æ—Ç–æ—Ä—ã–π –∏–∑–º–µ—Ä—è–µ—Ç –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –Ω–∏–∂–µ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/—Å–µ–∫.
- [ ] **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `pytest-cov`) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–µ –º–µ–Ω–µ–µ 90% –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π `processor.py` –∏ `parser.py`.
- [ ] **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∏–∑–æ–ª—è—Ü–∏—è:** –í—Å–µ —Ç–µ—Å—Ç—ã —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–∏ —Å PostgreSQL –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è `MEDIA_ROOT` –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏.
- [ ] **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–º–ø–æ—Ä—Ç–∞ `ImportSession.report_details` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–º, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º –∏ –æ—à–∏–±–æ—á–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º.

## Tasks / Subtasks

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** (AC: 8)
  - [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `backend/tests/integration/test_import_images_integration.py`
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `TestImportImagesIntegration` —Å setUp/tearDown
  - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å temporary MEDIA_ROOT –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ `data/import_1c/goods/`
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å helper –º–µ—Ç–æ–¥—ã `_count_files_in_media()` –∏ `_verify_image_exists()`

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π E2E —Ç–µ—Å—Ç –∏–º–ø–æ—Ä—Ç–∞** (AC: 1, 2)
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_import_catalog_with_images_full_workflow()`
  - [ ] –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω—ã—Ö XML —Ñ–∞–π–ª–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
  - [ ] –°–æ–∑–¥–∞–Ω–∏–µ ImportSession –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ ProductDataProcessor
  - [ ] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è main_image –∏ gallery_images –≤ –ë–î
  - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ temporary MEDIA_ROOT
  - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ processor.stats (images_copied, images_skipped, images_errors)

### Edge Cases —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Edge Cases —Ç–µ—Å—Ç—ã** (AC: 3)
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_import_with_missing_image_files()` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –∏–º–ø–æ—Ä—Ç –ù–ï –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π
    - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ images_errors > 0
    - –¢–æ–≤–∞—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_import_with_duplicate_images()` - –¥—É–±–ª–∏–∫–∞—Ç—ã
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –ø—É—Ç–µ–π
    - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ images_skipped –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_import_with_invalid_image_format()` - –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
    - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ WARNING –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø—É—Ç–µ–π
    - –ò–º–ø–æ—Ä—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –±–µ–∑ —Å–±–æ–µ–≤
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_import_products_without_images()` - —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Ç–µ–≥–æ–≤ `<–ö–∞—Ä—Ç–∏–Ω–∫–∞>`
    - –¢–æ–≤–∞—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_reimport_updates_images()` - –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–º–ø–æ—Ä—Ç–µ
    - –ù–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ gallery

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ performance

- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç —Ñ–ª–∞–≥–∞ --skip-images** (AC: 4)
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å `test_import_with_skip_images_flag()`
  - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ images_copied = 0 –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ–ª–∞–≥–∞
  - [ ] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —á—Ç–æ —Ñ–∞–π–ª—ã –ù–ï –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ media
  - [ ] –¢–æ–≤–∞—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Performance —Ç–µ—Å—Ç** (AC: 5, 6)
  - [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `backend/tests/performance/test_image_import_performance.py`
  - [ ] –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `test_import_large_volume_images_performance()` –≤ –Ω–µ–º
  - [ ] –ü–∞—Ä—Å–∏–Ω–≥ –í–°–ï–• goods_*.xml —Ñ–∞–π–ª–æ–≤ –∏–∑ data/import_1c/goods/
  - [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
  - [ ] –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ (images/sec)
  - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ performance –º–µ—Ç—Ä–∏–∫
  - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ >= 10 images/sec (performance requirement)

### –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

- [ ] **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã** (AC: 7, 8)
  - [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –≤ Docker: `make test` –∏–ª–∏ `docker-compose -f docker/docker-compose.test.yml run --rm backend pytest`
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å coverage >= 90% –¥–ª—è processor.py –∏ parser.py
  - [ ] –£–±–µ–¥–∏—Ç—å—Å—è –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (no flaky failures –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞—Ö)
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cleanup –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤ (tearDown —Ä–∞–±–æ—Ç–∞–µ—Ç)
  - [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑ performance: `pytest -m "not slow"`

- [ ] **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ code review**
  - [ ] –û–±–Ω–æ–≤–∏—Ç—å docstrings –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤
  - [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å–ª–æ–∂–Ω—ã–º –ø—Ä–æ–≤–µ—Ä–∫–∞–º
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Testing Strategy —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º (AAA Pattern, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞)
  - [ ] –û–±–Ω–æ–≤–∏—Ç—å Testing Strategy –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## Dev Notes

### Story Context

**–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å:**
- –í—Å—è —Ü–µ–ø–æ—á–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: XMLDataParser ‚Üí ProductDataProcessor ‚Üí import_catalog_from_1c –∫–æ–º–∞–Ω–¥–∞
- –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `data/import_1c/goods/` - XML —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `import_files/`
- Django test framework —Å PostgreSQL database
- Django FileSystemStorage –¥–ª—è media —Ñ–∞–π–ª–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã Epic 3 –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- pytest + pytest-django –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- Django TestCase —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–µ–π
- Temporary directories –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Factory Boy –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- PostgreSQL –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```python
# –ò–∑ backend/docs/testing-standards.md
# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
@pytest.mark.integration
class TestImportCatalogFrom1C:
    def test_full_import_workflow(self):
        # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ data/import_1c/
        pass
```

**–¢–æ—á–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
1. –†–µ–∞–ª—å–Ω—ã–µ XML —Ñ–∞–π–ª—ã –∏–∑ `data/import_1c/goods/goods_*.xml`
2. –†–µ–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ `data/import_1c/goods/import_files/`
3. –¢–µ—Å—Ç–æ–≤–∞—è –ë–î PostgreSQL
4. Temporary MEDIA_ROOT –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

‚úÖ **–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ë–∞–∑–æ–≤—ã–µ unit-—Ç–µ—Å—Ç—ã –¥–ª—è XMLDataParser –∏ ProductDataProcessor
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Epic 3)
- –§–∞–±—Ä–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Product, ImportSession)
- –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ 1–° –≤ `data/import_1c/`

‚ùå **–ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:**
1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞** –∏–º–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **–¢–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** –∏–∑ production –≤—ã–≥—Ä—É–∑–∫–∏ 1–°
3. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤** –≤ media storage
4. **Edge cases —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã, –¥—É–±–ª–∏–∫–∞—Ç—ã, –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã
5. **Performance —Ç–µ—Å—Ç—ã** - –∏–º–ø–æ—Ä—Ç 1000+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
6. **Rollback —Å—Ü–µ–Ω–∞—Ä–∏–∏** - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫

### Technical Notes

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

**–§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤:**
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ:** `backend/tests/integration/test_import_images_integration.py`
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** `backend/tests/performance/test_image_import_performance.py`

**–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Ç–µ—Å—Ç–∞:**

```python
import os
import pytest
import tempfile
import shutil
from pathlib import Path
from django.test import TestCase, override_settings
from django.core.management import call_command
from django.core.files.storage import default_storage

from apps.products.models import Product, ImportSession
from apps.products.services.parser import XMLDataParser
from apps.products.services.processor import ProductDataProcessor


@pytest.mark.integration
class TestImportImagesIntegration(TestCase):
    """–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ 1–°"""

    @classmethod
    def setUpClass(cls):
        super().setUpClass()
        # –ü—É—Ç—å –∫ —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º 1–°
        cls.real_data_dir = Path(__file__).parent.parent.parent.parent.parent / "data" / "import_1c"
        cls.goods_dir = cls.real_data_dir / "goods"
        cls.import_files_dir = cls.goods_dir / "import_files"

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if not cls.goods_dir.exists():
            pytest.skip("Real 1C data not found in data/import_1c/goods/")

    def setUp(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ temporary MEDIA_ROOT –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞"""
        self.temp_media = tempfile.mkdtemp(prefix="test_media_")
        self.media_override = override_settings(MEDIA_ROOT=self.temp_media)
        self.media_override.__enter__()

    def tearDown(self):
        """–û—á–∏—Å—Ç–∫–∞ temporary MEDIA_ROOT –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞"""
        self.media_override.__exit__(None, None, None)
        if os.path.exists(self.temp_media):
            shutil.rmtree(self.temp_media)

    def _count_files_in_media(self, subdirectory: str = "products") -> int:
        """–ü–æ–¥—Å—á–µ—Ç —Ñ–∞–π–ª–æ–≤ –≤ media subdirectory"""
        media_path = Path(self.temp_media) / subdirectory
        if not media_path.exists():
            return 0
        return len(list(media_path.glob("*")))

    def _verify_image_exists(self, image_path: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ media"""
        full_path = Path(self.temp_media) / image_path
        return full_path.exists() and full_path.is_file()
```

#### –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç

**Test 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∏–º–ø–æ—Ä—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏**

```python
def test_import_catalog_with_images_full_workflow(self):
    """
    End-to-end —Ç–µ—Å—Ç –∏–º–ø–æ—Ä—Ç–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö 1–°

    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
    1. –ü–∞—Ä—Å–∏–Ω–≥ goods.xml —Å –ø—É—Ç—è–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    2. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ media storage
    3. –£—Å—Ç–∞–Ω–æ–≤–∫—É —Å–≤—è–∑–µ–π main_image –∏ gallery_images
    4. –ö–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–º–ø–æ—Ä—Ç–∞
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: –ù–∞—Ö–æ–¥–∏–º —Ä–µ–∞–ª—å–Ω—ã–π goods.xml —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    goods_files = list(self.goods_dir.glob("goods_*.xml"))
    if not goods_files:
        self.skipTest("No goods XML files found")

    goods_file = goods_files[0]

    # –®–∞–≥ 1: –ü–∞—Ä—Å–∏–Ω–≥ XML
    parser = XMLDataParser()
    goods_data_list = parser.parse_goods_xml(str(goods_file))

    # –ù–∞—Ö–æ–¥–∏–º —Ç–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    goods_with_images = [g for g in goods_data_list if g.get("images")]
    self.assertGreater(
        len(goods_with_images), 0,
        "Expected at least one product with images in real data"
    )

    # –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –∏–º–ø–æ—Ä—Ç–∞
    session = ImportSession.objects.create(
        import_type=ImportSession.ImportType.CATALOG,
        status=ImportSession.ImportStatus.STARTED,
    )

    # –®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    processor = ProductDataProcessor(session_id=session.id, chunk_size=100)

    for goods_data in goods_with_images[:5]:  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ç–µ—Å—Ç–∞
        product = processor.create_product_placeholder(
            goods_data=goods_data,
            base_dir=str(self.goods_dir),
            skip_images=False
        )

        self.assertIsNotNone(product, f"Failed to create product {goods_data.get('id')}")

        # –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ë–î
        product.refresh_from_db()

        if goods_data.get("images"):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º main_image
            self.assertTrue(
                product.main_image,
                f"Product {product.onec_id} should have main_image"
            )

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ main_image
            self.assertTrue(
                self._verify_image_exists(product.main_image),
                f"Main image file not found: {product.main_image}"
            )

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º gallery_images
            if len(goods_data["images"]) > 1:
                self.assertGreater(
                    len(product.gallery_images), 0,
                    f"Product {product.onec_id} should have gallery images"
                )

                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ gallery –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                for gallery_path in product.gallery_images:
                    self.assertTrue(
                        self._verify_image_exists(gallery_path),
                        f"Gallery image file not found: {gallery_path}"
                    )

    # –®–∞–≥ 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    self.assertGreater(
        processor.stats.get("images_copied", 0), 0,
        "Expected at least one image to be copied"
    )

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ media
    files_count = self._count_files_in_media("products")
    self.assertGreater(files_count, 0, "Expected files in media/products/")

    # –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏
    processor.finalize_session(status=ImportSession.ImportStatus.COMPLETED)
    session.refresh_from_db()
    self.assertEqual(session.status, ImportSession.ImportStatus.COMPLETED)
```

#### Edge Cases —Ç–µ—Å—Ç—ã

**Test 2: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

```python
def test_import_with_missing_image_files(self):
    """–ò–º–ø–æ—Ä—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
    session = ImportSession.objects.create(
        import_type=ImportSession.ImportType.CATALOG,
        status=ImportSession.ImportStatus.STARTED,
    )
    processor = ProductDataProcessor(session_id=session.id)

    # –°–æ–∑–¥–∞–µ–º GoodsData —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø—É—Ç—è–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    goods_data = {
        "id": "test-product-123",
        "name": "Test Product",
        "images": [
            "import_files/99/nonexistent_image1.png",
            "import_files/99/nonexistent_image2.jpg"
        ]
    }

    # –ò–º–ø–æ—Ä—Ç –ù–ï –¥–æ–ª–∂–µ–Ω —É–ø–∞—Å—Ç—å —Å –æ—à–∏–±–∫–æ–π
    product = processor.create_product_placeholder(
        goods_data=goods_data,
        base_dir=str(self.goods_dir),
        skip_images=False
    )

    self.assertIsNotNone(product)

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—à–∏–±–æ–∫
    self.assertGreater(
        processor.stats.get("images_errors", 0), 0,
        "Expected errors for missing image files"
    )

    # –¢–æ–≤–∞—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω, –Ω–æ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    product.refresh_from_db()
    # main_image –º–æ–∂–µ—Ç –±—ã—Ç—å placeholder –∏–ª–∏ –ø—É—Å—Ç—ã–º
```

**Test 3: –§–ª–∞–≥ --skip-images**

```python
def test_import_with_skip_images_flag(self):
    """–ò–º–ø–æ—Ä—Ç —Å —Ñ–ª–∞–≥–æ–º --skip-images –Ω–µ –∫–æ–ø–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    session = ImportSession.objects.create(
        import_type=ImportSession.ImportType.CATALOG,
        status=ImportSession.ImportStatus.STARTED,
    )
    processor = ProductDataProcessor(session_id=session.id)

    # –ü–∞—Ä—Å–∏–º —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    goods_files = list(self.goods_dir.glob("goods_*.xml"))
    if not goods_files:
        self.skipTest("No goods XML files found")

    parser = XMLDataParser()
    goods_data_list = parser.parse_goods_xml(str(goods_files[0]))
    goods_with_images = [g for g in goods_data_list if g.get("images")]

    if not goods_with_images:
        self.skipTest("No products with images in XML")

    goods_data = goods_with_images[0]

    # –ò–º–ø–æ—Ä—Ç —Å skip_images=True
    product = processor.create_product_placeholder(
        goods_data=goods_data,
        base_dir=str(self.goods_dir),
        skip_images=True  # –ö–õ–Æ–ß–ï–í–û–ô –ü–ê–†–ê–ú–ï–¢–†
    )

    self.assertIsNotNone(product)

    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω—É–ª–µ–≤–∞—è
    self.assertEqual(processor.stats.get("images_copied", 0), 0)
    self.assertEqual(processor.stats.get("images_skipped", 0), 0)

    # –§–∞–π–ª—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ media
    files_count = self._count_files_in_media("products")
    self.assertEqual(files_count, 0, "No files should be copied with --skip-images")
```

#### Performance —Ç–µ—Å—Ç

**Test 4: –ò–º–ø–æ—Ä—Ç –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ—Ç —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `backend/tests/performance/test_image_import_performance.py` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞. –î–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `setUp` –º–æ–∂–Ω–æ —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∞—Å—Å.

```python
@pytest.mark.slow
def test_import_large_volume_images_performance(self):
    """Performance —Ç–µ—Å—Ç –∏–º–ø–æ—Ä—Ç–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
    import time

    # –ü–∞—Ä—Å–∏–º –í–°–ï goods —Ñ–∞–π–ª—ã
    goods_files = sorted(self.goods_dir.glob("goods_*.xml"))
    if not goods_files:
        self.skipTest("No goods XML files found")

    session = ImportSession.objects.create(
        import_type=ImportSession.ImportType.CATALOG,
        status=ImportSession.ImportStatus.STARTED,
    )
    processor = ProductDataProcessor(session_id=session.id, chunk_size=1000)

    parser = XMLDataParser()
    total_products = 0
    total_images = 0

    start_time = time.time()

    for goods_file in goods_files:
        goods_data_list = parser.parse_goods_xml(str(goods_file))
        goods_with_images = [g for g in goods_data_list if g.get("images")]

        for goods_data in goods_with_images:
            processor.create_product_placeholder(
                goods_data=goods_data,
                base_dir=str(self.goods_dir),
                skip_images=False
            )
            total_products += 1
            total_images += len(goods_data.get("images", []))

    end_time = time.time()
    elapsed_time = end_time - start_time

    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ performance –º–µ—Ç—Ä–∏–∫
    print(f"\n{'='*50}")
    print(f"PERFORMANCE METRICS:")
    print(f"Total products: {total_products}")
    print(f"Total images: {total_images}")
    print(f"Elapsed time: {elapsed_time:.2f}s")
    print(f"Products/sec: {total_products / elapsed_time:.2f}")
    print(f"Images/sec: {total_images / elapsed_time:.2f}")
    print(f"Images copied: {processor.stats.get('images_copied', 0)}")
    print(f"Images skipped: {processor.stats.get('images_skipped', 0)}")
    print(f"Images errors: {processor.stats.get('images_errors', 0)}")
    print(f"{'='*50}\n")

    # Assertions
    self.assertGreater(total_products, 0)
    self.assertGreater(processor.stats.get("images_copied", 0), 0)

    # Performance requirement: —Ö–æ—Ç—è –±—ã 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
    images_per_sec = processor.stats.get("images_copied", 0) / elapsed_time
    self.assertGreater(
        images_per_sec, 10,
        f"Performance too slow: {images_per_sec:.2f} images/sec"
    )
```

### Testing

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

**üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –í—Å–µ —Ç–µ—Å—Ç—ã –î–û–õ–ñ–ù–´ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å [Testing Strategy](docs/architecture/10-testing-strategy.md) –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∏–∑–æ–ª—è—Ü–∏–∏ (—Ä–∞–∑–¥–µ–ª 10.4).

#### –¢–µ—Å—Ç–æ–≤—ã–π Workflow

```text
1. Setup Environment
   ‚îú‚îÄ‚îÄ Check real data exists (data/import_1c/goods/)
   ‚îú‚îÄ‚îÄ Create temporary MEDIA_ROOT
   ‚îî‚îÄ‚îÄ Initialize test DB (PostgreSQL)

2. Main E2E Test
   ‚îú‚îÄ‚îÄ Parse goods.xml with images
   ‚îú‚îÄ‚îÄ Process products with images
   ‚îú‚îÄ‚îÄ Verify DB records (main_image, gallery_images)
   ‚îî‚îÄ‚îÄ Verify physical files in media

3. Edge Cases Tests
   ‚îú‚îÄ‚îÄ Missing files ‚Üí Warning + continue
   ‚îú‚îÄ‚îÄ Duplicates ‚Üí Skip + log
   ‚îú‚îÄ‚îÄ Invalid formats ‚Üí Error + skip
   ‚îî‚îÄ‚îÄ No images ‚Üí Success (empty images)

4. Performance Test
   ‚îú‚îÄ‚îÄ Import 1000+ images
   ‚îú‚îÄ‚îÄ Measure time and throughput
   ‚îî‚îÄ‚îÄ Log metrics

5. Cleanup
   ‚îú‚îÄ‚îÄ Remove temporary MEDIA_ROOT
   ‚îî‚îÄ‚îÄ Rollback DB transactions
```

#### Unit-—Ç–µ—Å—Ç—ã

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:** `backend/tests/integration/test_import_images_integration.py`
- **–¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** `backend/tests/performance/test_image_import_performance.py`

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤:**
```python
import pytest

# –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –≤—Å–µ–≥–æ –º–æ–¥—É–ª—è
pytestmark = pytest.mark.django_db

@pytest.mark.integration
class TestImportImagesIntegration:
    """–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ goods.xml"""
    # —Ç–µ—Å—Ç—ã –∑–¥–µ—Å—å
```

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑–æ–ª—è—Ü–∏–∏

**üö® –ö–†–ò–¢–ò–ß–ù–û:** –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è constraint violations –∏ flaky tests:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_unique_suffix()` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
```python
from tests.conftest import get_unique_suffix

# –í —Ç–µ—Å—Ç–æ–≤—ã—Ö XML –¥–∞–Ω–Ω—ã—Ö:
unique_id = get_unique_suffix()
xml_content = f"""
<–ö–∞—Ç–∞–ª–æ–≥>
    <–¢–æ–≤–∞—Ä—ã>
        <–¢–æ–≤–∞—Ä>
            <–ò–¥>{unique_id}</–ò–¥>
            ...
```

2. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ pytest –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - `--create-db` - —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–∏—Å—Ç—É—é –ë–î –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏
   - `--nomigrations` - –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
   - –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker —Å PostgreSQL (–ù–ï SQLite)

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ fixtures:**
   - `@pytest.fixture(autouse=True)` –≤ `conftest.py` –æ—á–∏—â–∞–µ—Ç –ë–î –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TRUNCATE TABLE ... RESTART IDENTITY CASCADE`

#### –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

**üî¥ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Docker —Å PostgreSQL:

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∏–º–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±)
make test

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ docker-compose –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
docker-compose -f docker/docker-compose.test.yml run --rm backend \
  pytest backend/tests/integration/test_import_images_integration.py -v

# –¢–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã (–±–µ–∑ performance)
docker-compose -f docker/docker-compose.test.yml run --rm backend \
  pytest backend/tests/integration/test_import_images_integration.py -v -m "not slow"

# Performance —Ç–µ—Å—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
docker-compose -f docker/docker-compose.test.yml run --rm backend \
  pytest backend/tests/performance/test_image_import_performance.py -v -s

# –° coverage –æ—Ç—á–µ—Ç–æ–º –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
docker-compose -f docker/docker-compose.test.yml run --rm backend \
  pytest backend/tests/integration/test_import_images_integration.py --cov=apps.products.services --cov-report=html
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** SQLite –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π JSON –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ PostgreSQL.

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–∫—Ä—ã—Ç–∏—é

–°–æ–≥–ª–∞—Å–Ω–æ [Testing Strategy ¬ß10.7](docs/architecture/10-testing-strategy.md#10.7):

- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** >= 70%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –¥–ª—è processor.py –∏ parser.py:** >= 90% (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏)
- **–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:** >= 90%

#### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `data/import_1c/goods/goods_*.xml` - XML —Ñ–∞–π–ª—ã —Å —Ç–æ–≤–∞—Ä–∞–º–∏
- `data/import_1c/goods/import_files/` - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- –ú–∏–Ω–∏–º—É–º 5-10 —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –ú–∏–Ω–∏–º—É–º 20-30 —Ñ–∞–π–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–µ—Å—Ç–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º:**
- –î–∞–Ω–Ω—ã–µ –ù–ï –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ git (gitignore)
- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ production –≤—ã–≥—Ä—É–∑–∫–∏ 1–°
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç CommerceML 3.1

#### Expected Performance Baseline

| –ú–µ—Ç—Ä–∏–∫–∞ | –ú–∏–Ω–∏–º—É–º | –¶–µ–ª–µ–≤–æ–µ | Excellent |
|---------|---------|---------|-----------|
| Images/sec | >= 10 | 50 | 100+ |
| Total time (1000 imgs) | < 100s | 20s | 10s |
| Memory usage | < 500MB | 200MB | 100MB |

## Definition of Done

–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Story 3.1.3:

- [ ] **–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç** - 100% pass –≤ Docker —Å PostgreSQL
- [ ] **–ü–æ–∫—Ä—ã—Ç–∏–µ >= 90%** - –¥–ª—è processor.py –∏ parser.py (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏)
- [ ] **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤** - no flaky failures –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞—Ö
- [ ] **–ò–∑–æ–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç** - cleanup —É–¥–∞–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∞–Ω–Ω—ã–µ
- [ ] **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** - —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ñ–∞–π–ª–∞–º–∏ –∏–∑ data/import_1c/
- [ ] **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞** - docstrings –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- [ ] **Code review –ø—Ä–æ–π–¥–µ–Ω** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Testing Strategy —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º (AAA Pattern, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞)
- [ ] **CI/CD integration** - —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ GitHub Actions
- [ ] **Performance —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã** - >= 10 images/sec –≤ performance —Ç–µ—Å—Ç–µ
- [ ] **Edge cases –ø–æ–∫—Ä—ã—Ç—ã** - –≤—Å–µ 5 edge cases —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

## Dependencies

**–ó–∞–≤–∏—Å–∏—Ç –æ—Ç:**
- ‚úÖ Story 3.1.1 - –ü–∞—Ä—Å–∏–Ω–≥ –ø—É—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ XML
- ‚úÖ Story 3.1.2 - –ò–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Django media storage
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `data/import_1c/goods/`

**–ë–ª–æ–∫–∏—Ä—É–µ—Ç:**
- ‚è≥ –†–µ–ª–∏–∑ Epic 3.1 –≤ production

## Risk Mitigation

**–†–∏—Å–∫ 1:** –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ 1–° –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ CI/CD

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- pytest.skip() –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ S3 –≤ CI
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫ fallback

**–†–∏—Å–∫ 2:** Performance —Ç–µ—Å—Ç—ã –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã –≤ CI

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –∫–∞–∫ @pytest.mark.slow - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ threshold –¥–ª—è performance (–∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–≥–∏—Ö assertions

**–†–∏—Å–∫ 3:** –¢–µ—Å—Ç—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç –¥–∏—Å–∫ –≤ CI

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- Temporary directories —Å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–æ–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö
- –û—á–∏—Å—Ç–∫–∞ –≤ tearDown() –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**Rollback –ø–ª–∞–Ω:**
- –¢–µ—Å—Ç—ã –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ production –¥–∞–Ω–Ω—ã–µ
- –ò–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ temporary MEDIA_ROOT
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π rollback –ë–î

## Story Complexity

**–û—Ü–µ–Ω–∫–∞:** 3 Story Points (—Å—Ä–µ–¥–Ω—è—è –∑–∞–¥–∞—á–∞)

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Ç—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- Performance —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∏–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ temporary directories
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è:** 3-4 —á–∞—Å–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ—Å—Ç–æ–≤ + 1-2 —á–∞—Å–∞ –æ—Ç–ª–∞–¥–∫–∏

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-08 | 1.0 | Initial story creation | Developer Team |
| 2025-11-09 | 2.0 | Template compliance fixes: added Tasks/Subtasks, Change Log, Dev Agent Record, QA Results sections. Reformatted Definition of Done as completion criteria. Added test workflow diagram and performance baseline table. | Sarah (Product Owner) |

---

## Dev Agent Record

_This section will be populated by the development agent during implementation._

### Agent Model Used

_To be filled by Dev Agent (e.g., "Claude Sonnet 3.5")_

### Debug Log References

_Links to debug logs and traces generated during development_

### Completion Notes

_Notes about task completion and any issues encountered:_

- Task 1: ...
- Task 2: ...

### File List

_List of all files created, modified, or affected during story implementation:_

**Created:**
- `backend/tests/integration/test_import_images_integration.py`
- `backend/tests/performance/test_image_import_performance.py`

**Modified:**
- _(to be filled by Dev Agent)_

---

## QA Results

_This section will be populated by QA Agent after story implementation is completed._

### Test Execution Summary

- **Total Tests Run:** _TBD_
- **Passed:** _TBD_
- **Failed:** _TBD_
- **Coverage:** _TBD_%

### Quality Gate Status

- [ ] All tests pass (100%)
- [ ] Coverage >= 90% for processor.py and parser.py
- [ ] No flaky tests detected
- [ ] Performance requirements met (>= 10 images/sec)
- [ ] Code review approved
- [ ] Documentation complete

### QA Sign-Off

**Reviewed by:** _QA Agent Name_
**Date:** _YYYY-MM-DD_
**Status:** _PASS / FAIL / CONDITIONAL PASS_

**Notes:** _Detailed QA findings and recommendations_

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-08
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-11-09
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** High (–±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–ª–∏–∑ Epic 3.1)
**Epic:** Epic 3.1 - –ò–º–ø–æ—Ä—Ç –∏ —Å–≤—è–∑—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ 1–°
**Assigned to:** QA/Developer Team
**Depends on:** Story 3.1.1, Story 3.1.2
