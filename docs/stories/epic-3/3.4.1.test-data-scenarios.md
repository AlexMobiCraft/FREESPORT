# Story 3.4.1: test-data-scenarios

## Status

Ready for Development

## Story

**As a** QA инженер,
**I want** иметь полный набор тестовых данных,
**so that** проверить все сценарии интеграции с 1С.

## Примечание

Большая часть описанных ниже тестовых данных уже генерируется командой `load_test_catalog`, реализованной в рамках **[Истории 3.1.2](./3.1.2.loading-scripts.md)**. Эта история должна использоваться как чек-лист для проверки полноты и качества генерируемых данных.

## Acceptance Criteria

1. Создан набор тестовых товаров (500+ записей)
2. Создан набор тестовых клиентов (100+ записей)
3. Подготовлены файлы импорта в различных форматах
4. Созданы сценарии с ошибочными данными
5. Настроены фикстуры для автоматических тестов
6. Покрыты все edge cases и граничные условия
7. Созданы сценарии для тестирования детерминированной идентификации (Story 3.3.1)
8. Созданы сценарии для тестирования автоматического разрешения конфликтов (Story 3.2.2)

### Test Data Scenarios

**Товары (500+ records):**

- Различные категории: одежда, обувь, инвентарь
- Все типы цен для 7 ролей пользователей
- Технические характеристики в JSONB
- Различные статусы наличия (in stock, low stock, out of stock)
- Товары с/без изображений
- Товары с различными брендами (20+)

**Клиенты (100+ records):**

- Физические лица: 60 записей
- Юридические лица: 40 записей
- Все 7 ролей: retail, wholesale_level1-3, trainer, federation_rep, admin
- Полные и неполные данные
- Потенциальные конфликты (дубли email, схожие ФИО)
- Различные форматы телефонов и адресов

**Конфликтные сценарии (для тестирования Stories 3.2.2 и 3.3.1):**

**Сценарии идентификации (Story 3.3.1):**

- Клиенты с onec_id для точного поиска
- Клиенты с onec_guid для точного поиска
- Клиенты с ИНН (tax_id) для B2B идентификации
- Клиенты с email для B2C идентификации
- Клиенты с различными форматами ИНН (с пробелами, без пробелов)
- Клиенты с различными форматами email (верхний/нижний регистр)

**Сценарии конфликтов (Story 3.2.2):**

- **portal_registration:** Клиент из 1С пытается зарегистрироваться на портале (по ИНН или email)
- **data_import:** Клиент существует на портале, импортируется из 1С с отличающимися данными
- Конфликтующие поля: first_name, last_name, email, phone, company_name, tax_id, legal_address
- Различные комбинации конфликтующих полей (1 поле, несколько полей, все поля)

## Definition of Done

- [ ] Все тестовые данные загружаются без ошибок
- [ ] Покрыты все edge cases
- [ ] Тесты воспроизводимы и изолированы
- [ ] Созданы фикстуры для pytest
- [ ] Созданы тестовые данные для детерминированной идентификации (onec_id, onec_guid, tax_id, email)
- [ ] Созданы тестовые данные для сценариев portal_registration и data_import
- [ ] Подготовлены клиенты с различными комбинациями конфликтующих полей

## Story Points

**3** (Low complexity, data preparation)

## Priority

**Medium** - Необходимо для качественного тестирования

## Labels

`epic-3` `test-data` `qa` `fixtures` `edge-cases`