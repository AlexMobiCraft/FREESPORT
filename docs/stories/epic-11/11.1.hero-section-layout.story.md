# Story 11.1: Hero-секция и Layout главной страницы

## Status
**Draft**

## Story

**As a** посетитель платформы FREESPORT (B2B или B2C пользователь),
**I want** видеть привлекательную главную страницу с адаптированным под мою роль баннером,
**so that** я сразу понимаю ценностное предложение платформы и могу начать взаимодействие с каталогом товаров.

## Acceptance Criteria

1. **Роут главной страницы:**
   - Реализован роут `/` (src/app/page.tsx)
   - Страница доступна для всех пользователей (авторизованных и неавторизованных)

2. **Hero-секция с ролевыми баннерами:**
   - Hero-секция с баннером адаптируется под роль пользователя из `authStore`
   - Для B2B клиентов отображается баннер "Узнать оптовые условия" с CTA
   - Для B2C клиентов отображается баннер "Новая коллекция 2025" с CTA
   - Для неавторизованных отображается универсальный баннер

3. **Дизайн-система:**
   - Применены токены из `frontend/docs/design-system.json`:
     - Цвета: `colors.primary`, `colors.neutral`
     - Типографика: `typography.display-l`, `typography.body-m`
     - Отступы: `spacing` (8px grid)
     - Радиусы: `radius.default` (12px)
     - Тени: `shadows.default`

4. **Адаптивная вёрстка:**
   - Mobile (< 640px): вертикальный layout, hero на всю ширину
   - Tablet (640-1024px): двухколоночный layout для некоторых секций
   - Desktop (> 1024px): полный layout с максимальной шириной 1280px

5. **SSG/ISR настройка:**
   - Страница использует SSG (Static Site Generation)
   - Настроен ISR с `revalidate: 3600` (1 час)
   - Динамические данные (роль пользователя) обрабатываются на клиенте через `authStore`

6. **SEO метатеги:**
   - Заполнены `title`: "FREESPORT - Оптовые поставки спортивных товаров | B2B и Розница"
   - Заполнены `description` с ключевыми словами
   - OG tags для соцсетей (og:title, og:description, og:image)

## Tasks / Subtasks

- [ ] **Task 1: Создать базовую структуру главной страницы** (AC: 1, 4)
  - [ ] Создать файл `src/app/page.tsx` с базовым layout
  - [ ] Настроить export metadata для SEO (title, description, OG tags)
  - [ ] Добавить контейнер с max-width 1280px и центрированием
  - [ ] Применить адаптивные breakpoints (mobile/tablet/desktop)

- [ ] **Task 2: Реализовать Hero-секцию с ролевыми баннерами** (AC: 2, 3)
  - [ ] Создать компонент `src/components/home/HeroSection.tsx`
  - [ ] Интегрировать `authStore` для получения роли пользователя
  - [ ] Реализовать условный рендеринг баннеров:
    - B2B баннер: "Узнать оптовые условия" + CTA кнопка
    - B2C баннер: "Новая коллекция 2025" + CTA кнопка
    - Неавторизованный баннер: Универсальное предложение
  - [ ] Применить токены дизайн-системы (colors, typography, spacing)
  - [ ] Добавить адаптивные стили для mobile/tablet/desktop

- [ ] **Task 3: Настроить SSG/ISR для главной страницы** (AC: 5)
  - [ ] Настроить `generateStaticParams()` если требуется
  - [ ] Добавить `export const revalidate = 3600` для ISR
  - [ ] Убедиться что динамические данные (authStore) обрабатываются на клиенте
  - [ ] Проверить корректность гидратации компонентов

- [ ] **Task 4: Unit-тесты для HeroSection** (AC: Все)
  - [ ] Создать `src/components/home/__tests__/HeroSection.test.tsx`
  - [ ] Тест 1: Рендеринг B2B баннера для авторизованного B2B пользователя
  - [ ] Тест 2: Рендеринг B2C баннера для авторизованного B2C пользователя
  - [ ] Тест 3: Рендеринг универсального баннера для неавторизованного
  - [ ] Тест 4: Проверка применения design tokens (className проверка)
  - [ ] Тест 5: Проверка CTA кнопок и их onClick handlers
  - [ ] Достичь покрытия 80%+

- [ ] **Task 5: Интеграционные тесты для главной страницы** (AC: 1, 5, 6)
  - [ ] Создать `src/app/__tests__/page.test.tsx`
  - [ ] Тест 1: Корректный рендеринг страницы на роуте `/`
  - [ ] Тест 2: Наличие SEO метатегов (title, description, OG tags)
  - [ ] Тест 3: Адаптивность на разных viewport размерах
  - [ ] Тест 4: Проверка SSG/ISR конфигурации

## Dev Notes

### Предыдущие Story Insights
Это первая story в Epic 11, предыдущих зависимостей нет. Базируется на результатах **Epic 10 (Фундамент)**, где были реализованы:
- UI Kit компоненты (Button, Header) в `src/components/ui/`
- Zustand stores (`authStore`, `cartStore`)
- API клиент с интерцепторами
- Design system tokens

### Архитектура и структура проекта

**Source Tree:** [Source: docs/architecture/source-tree.md]
```
frontend/src/
├── app/
│   ├── page.tsx                    # ← СОЗДАТЬ: Главная страница (/)
│   └── layout.tsx                  # Из Epic 10: Global layout
├── components/
│   ├── ui/                         # Из Epic 10: UI Kit
│   │   ├── Header.tsx
│   │   ├── Button.tsx
│   │   └── Badge.tsx
│   └── home/                       # ← СОЗДАТЬ: Компоненты главной
│       └── HeroSection.tsx         # Hero-секция с баннерами
├── stores/
│   └── authStore.ts                # Из Epic 10: Zustand store
└── types/
    └── api.ts                      # Из Epic 10: Типы API
```

### Design System Tokens

**Источник:** `frontend/docs/design-system.json` [Source: frontend/docs/design-system.json#foundations]

**Цвета:**
```typescript
colors.primary.default: "#1F1F1F"  // Основной цвет для CTA
colors.primary.hover: "#3A3A3A"
colors.neutral[100]: "#FFFFFF"     // Фон
colors.neutral[900]: "#1F1F1F"     // Текст
colors.text.primary: "#1B1B1B"
colors.text.secondary: "#4D4D4D"
```

**Типографика:**
```typescript
typography.display-l: { size: 48px, lineHeight: 56px, weight: 700 }  // Hero заголовок
typography.headline-m: { size: 28px, lineHeight: 36px, weight: 600 } // Подзаголовки
typography.body-m: { size: 16px, lineHeight: 24px, weight: 500 }     // Основной текст
fontFamily: ["Inter", "SF Pro Display", "-apple-system", "sans-serif"]
```

**Отступы (8px grid):**
```typescript
spacing.scale: [4, 8, 12, 16, 20, 24, 32, 40, 48, 56, 64]
sectionSpacing.aboveFold: 64px     // Отступ для hero-секции
componentSpacing.cardGap: 16px
```

**Радиусы и тени:**
```typescript
radius.default: 12px               // Карточки
radius.sm: 6px                     // Кнопки
shadows.default: "0 8px 24px rgba(15, 23, 42, 0.08)"
shadows.hover: "0 10px 32px rgba(15, 23, 42, 0.12)"
```

**Grid и Breakpoints:** [Source: frontend/docs/design-system.json#foundations.grid]
```typescript
grid.pageWidth: 1280px
grid.breakpoints: {
  mobile: 640px,
  tablet: 1024px,
  desktop: 1440px
}
grid.padding: {
  desktop: 24px,
  tablet: 16px,
  mobile: 12px
}
```

### Component Specifications

**Header Component:** [Source: frontend/docs/design-system.json#components.Header]
```typescript
// Из Epic 10 - использовать как есть
Header {
  heightDesktop: 60px,
  heightMobile: 60px,
  shadow: "0 6px 16px rgba(31, 42, 68, 0.05)",
  structure: ["Логотип", "Поиск", "Корзина", "Профиль"]
}
```

**HeroSection Component:** [Source: docs/front-end-spec.md, docs/prd/user-interface-design-goals.md]
```typescript
interface HeroSectionProps {
  // Пропсы определяются динамически на основе authStore
}

// Логика переключения баннеров:
// - authStore.user?.role === 'wholesale_level1|2|3' → B2B баннер
// - authStore.user?.role === 'retail' → B2C баннер
// - authStore.user === null → Универсальный баннер
```

### State Management

**authStore:** [Source: docs/architecture/tech-stack.md#Zustand]
```typescript
// Из Epic 10 - использовать для определения роли
interface AuthState {
  user: User | null;
  isAuthenticated: boolean;
  login: (email: string, password: string) => Promise<void>;
  logout: () => void;
  refreshToken: () => Promise<void>;
}

interface User {
  id: number;
  email: string;
  role: 'retail' | 'wholesale_level1' | 'wholesale_level2' | 'wholesale_level3' | 'trainer' | 'federation_rep' | 'admin';
  // ... другие поля
}
```

### Next.js SSG/ISR Configuration

**SSG Setup:** [Source: docs/architecture/tech-stack.md#Next.js]
```typescript
// src/app/page.tsx
export const revalidate = 3600; // ISR: ревалидация каждый час

export const metadata: Metadata = {
  title: "FREESPORT - Оптовые поставки спортивных товаров | B2B и Розница",
  description: "Оптовые поставки спортивных товаров для B2B и розничных покупателей. 5 брендов, дифференцированное ценообразование, интеграция с 1С.",
  openGraph: {
    title: "FREESPORT - Оптовые поставки спортивных товаров",
    description: "B2B и B2C продажи спортивных товаров",
    url: "https://freesport.ru",
    siteName: "FREESPORT",
    images: [
      {
        url: "/og-image.jpg",
        width: 1200,
        height: 630,
      },
    ],
    locale: "ru_RU",
    type: "website",
  },
};

export default async function HomePage() {
  // SSG: страница генерируется статически
  // Динамические данные (authStore) обрабатываются на клиенте
  return <HomeContent />;
}
```

### Tailwind CSS Usage

**Applying Design Tokens:** [Source: docs/architecture/coding-standards.md#Tailwind CSS]
```typescript
// Пример использования токенов в className
<div className="bg-neutral-100 text-text-primary">
  <h1 className="text-display-l font-bold text-primary-default">
    Главная страница FREESPORT
  </h1>
  <Button variant="primary" className="bg-primary-default hover:bg-primary-hover">
    Перейти в каталог
  </Button>
</div>
```

**ВАЖНО:** Tailwind классы должны соответствовать токенам из design-system.json. Если кастомные классы требуются, добавить их в `tailwind.config.js`.

### Технические ограничения

1. **TypeScript требования:** [Source: docs/architecture/coding-standards.md#TypeScript]
   - Все компоненты должны иметь явные типы для props
   - Избегать `any` типов
   - Использовать `interface` для props объектов

2. **Производительность:**
   - Lazy loading для изображений через `next/image`
   - Priority loading для hero-изображения
   - Skeleton loaders для улучшения perceived performance

3. **Accessibility (WCAG 2.1 AA):**
   - Семантические HTML теги (`<main>`, `<section>`, `<h1>`)
   - Alt текст для изображений
   - Keyboard navigation для CTA кнопок
   - Цветовой контраст минимум 4.5:1

### Testing

**Стратегия тестирования:** [Source: frontend/docs/testing-standards.md, docs/architecture/10-testing-strategy.md]

**Unit Tests (Jest + React Testing Library):**
```typescript
// src/components/home/__tests__/HeroSection.test.tsx
import { render, screen } from '@testing-library/react';
import { HeroSection } from '../HeroSection';
import { useAuthStore } from '@/stores/authStore';

jest.mock('@/stores/authStore');

describe('HeroSection', () => {
  it('renders B2B banner for wholesale user', () => {
    (useAuthStore as jest.Mock).mockReturnValue({
      user: { role: 'wholesale_level1' },
      isAuthenticated: true,
    });

    render(<HeroSection />);

    expect(screen.getByText(/Узнать оптовые условия/i)).toBeInTheDocument();
  });

  it('renders B2C banner for retail user', () => {
    (useAuthStore as jest.Mock).mockReturnValue({
      user: { role: 'retail' },
      isAuthenticated: true,
    });

    render(<HeroSection />);

    expect(screen.getByText(/Новая коллекция 2025/i)).toBeInTheDocument();
  });

  it('renders universal banner for unauthenticated user', () => {
    (useAuthStore as jest.Mock).mockReturnValue({
      user: null,
      isAuthenticated: false,
    });

    render(<HeroSection />);

    expect(screen.getByText(/FREESPORT/i)).toBeInTheDocument();
  });
});
```

**Test Coverage Requirements:** [Source: docs/architecture/10-testing-strategy.md]
- Минимум 80% покрытие кода
- 100% покрытие критических компонентов (HeroSection)
- Тестирование всех acceptance criteria

**Test File Location:**
```
src/components/home/__tests__/HeroSection.test.tsx
src/app/__tests__/page.test.tsx
```

**Testing Frameworks:** [Source: frontend/docs/testing-standards.md]
- Jest 29.7.0
- @testing-library/react 14.1.2
- @testing-library/jest-dom 6.1.4
- @testing-library/user-event 14.5.1

## Change Log

| Date       | Version | Description                              | Author        |
|------------|---------|------------------------------------------|---------------|
| 2025-11-16 | 1.0     | Initial story creation                   | Bob (SM)      |

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes List
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_
