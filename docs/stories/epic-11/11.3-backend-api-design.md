# Backend API Design –¥–ª—è Story 11.3
**–§–æ—Ä–º–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É –∏ –±–ª–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π**

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-18
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-18 (–¥–æ–±–∞–≤–ª–µ–Ω Unsubscribe API)
**–ê–≤—Ç–æ—Ä:** Winston (Architect Agent)
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** Sarah (Product Owner Agent)
**–°—Ç–∞—Ç—É—Å:** üéØ Ready for Implementation

---

## Executive Summary

**–¶–µ–ª—å:** –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å backend API endpoints –¥–ª—è Story 11.3:
- `POST /api/v1/subscribe` - –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É
- `POST /api/v1/unsubscribe` - –æ—Ç–ø–∏—Å–∫–∞ –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏ (GDPR compliance)
- `GET /api/v1/news` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å 2 –º–æ–¥–µ–ª–∏ –≤ `apps/common/`:
- `Newsletter` - —Ö—Ä–∞–Ω–µ–Ω–∏–µ email-–ø–æ–¥–ø–∏—Å–æ–∫
- `News` - —Å–∏—Å—Ç–µ–º–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –∞–∫—Ü–∏–π

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –≤ apps/common:**
- ‚úÖ –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –¥–æ–º–µ–Ω—É)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º (AuditLog, SyncLog)

---

## 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Models)

### 1.1. Newsletter Model

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ email-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É

```python
# backend/apps/common/models.py

from __future__ import annotations

from django.db import models
from django.utils import timezone


class Newsletter(models.Model):
    """
    –ú–æ–¥–µ–ª—å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É.
    –•—Ä–∞–Ω–∏—Ç email –∞–¥—Ä–µ—Å–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏.
    """

    email: models.EmailField = models.EmailField(
        "Email –∞–¥—Ä–µ—Å",
        unique=True,
        max_length=255,
        db_index=True,
        help_text="–£–Ω–∏–∫–∞–ª—å–Ω—ã–π email –∞–¥—Ä–µ—Å –ø–æ–¥–ø–∏—Å—á–∏–∫–∞",
    )
    is_active: models.BooleanField = models.BooleanField(
        "–ê–∫—Ç–∏–≤–Ω–∞",
        default=True,
        db_index=True,
        help_text="–§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∫–∏ (–¥–ª—è –æ—Ç–ø–∏—Å–∫–∏)",
    )
    subscribed_at: models.DateTimeField = models.DateTimeField(
        "–î–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏",
        auto_now_add=True,
        db_index=True,
        help_text="–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–¥–ø–∏—Å–∫–∏",
    )
    unsubscribed_at: models.DateTimeField = models.DateTimeField(
        "–î–∞—Ç–∞ –æ—Ç–ø–∏—Å–∫–∏",
        null=True,
        blank=True,
        help_text="–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ—Ç–ø–∏—Å–∫–∏ (null –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞)",
    )
    ip_address: models.GenericIPAddressField = models.GenericIPAddressField(
        "IP –∞–¥—Ä–µ—Å",
        null=True,
        blank=True,
        help_text="IP –∞–¥—Ä–µ—Å –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ (–¥–ª—è –∞–Ω—Ç–∏—Å–ø–∞–º)",
    )
    user_agent: models.TextField = models.TextField(
        "User Agent",
        blank=True,
        help_text="–ë—Ä–∞—É–∑–µ—Ä –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ",
    )

    objects = models.Manager()

    class Meta:
        verbose_name = "–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É"
        verbose_name_plural = "–ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É"
        db_table = "newsletter_subscriptions"
        ordering = ["-subscribed_at"]
        indexes = [
            models.Index(fields=["email"]),
            models.Index(fields=["is_active", "subscribed_at"]),
            models.Index(fields=["subscribed_at"]),
        ]
        constraints = [
            models.CheckConstraint(
                check=models.Q(is_active=True, unsubscribed_at__isnull=True)
                | models.Q(is_active=False, unsubscribed_at__isnull=False),
                name="newsletter_active_consistency",
            )
        ]

    def __str__(self) -> str:
        status = "–ê–∫—Ç–∏–≤–Ω–∞" if self.is_active else "–ù–µ–∞–∫—Ç–∏–≤–Ω–∞"
        return f"{self.email} ({status})"

    def unsubscribe(self) -> None:
        """–û—Ç–ø–∏—Å–∞—Ç—å email –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏."""
        self.is_active = False
        self.unsubscribed_at = timezone.now()
        self.save(update_fields=["is_active", "unsubscribed_at"])
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ `email` - —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ —Å –∏–Ω–¥–µ–∫—Å–æ–º –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ `is_active` - soft delete –ø–∞—Ç—Ç–µ—Ä–Ω (–Ω–µ —É–¥–∞–ª—è–µ–º, –∞ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º)
- ‚úÖ `ip_address` + `user_agent` - –¥–ª—è –∞–Ω—Ç–∏—Å–ø–∞–º –∑–∞—â–∏—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø–æ–ª—è—Ö
- ‚úÖ Database constraint - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç consistency –º–µ–∂–¥—É `is_active` –∏ `unsubscribed_at`
- ‚úÖ –ú–µ—Ç–æ–¥ `unsubscribe()` –¥–ª—è –±—É–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø–∏—Å–∫–∏

---

### 1.2. News Model

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –∞–∫—Ü–∏–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ

```python
# backend/apps/common/models.py

from django.db import models
from django.utils.text import slugify


class News(models.Model):
    """
    –ú–æ–¥–µ–ª—å –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –∞–∫—Ü–∏–π.
    –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏ –≤ –±–ª–æ–≥–µ –∫–æ–º–ø–∞–Ω–∏–∏.
    """

    title: models.CharField = models.CharField(
        "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
        max_length=200,
        help_text="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏",
    )
    slug: models.SlugField = models.SlugField(
        "URL slug",
        max_length=255,
        unique=True,
        db_index=True,
        help_text="–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è URL",
    )
    excerpt: models.TextField = models.TextField(
        "–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
        max_length=500,
        help_text="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)",
    )
    content: models.TextField = models.TextField(
        "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç",
        blank=True,
        help_text="–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    )
    image: models.ImageField = models.ImageField(
        "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
        upload_to="news/%Y/%m/",
        null=True,
        blank=True,
        help_text="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    )
    author: models.CharField = models.CharField(
        "–ê–≤—Ç–æ—Ä",
        max_length=100,
        blank=True,
        help_text="–ò–º—è –∞–≤—Ç–æ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    )
    category: models.CharField = models.CharField(
        "–ö–∞—Ç–µ–≥–æ—Ä–∏—è",
        max_length=50,
        blank=True,
        db_index=True,
        help_text="–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–æ–≤–æ—Å—Ç–∏ (–∞–∫—Ü–∏—è, –Ω–æ–≤–∏–Ω–∫–∞, —Å–æ–±—ã—Ç–∏–µ)",
    )
    is_published: models.BooleanField = models.BooleanField(
        "–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞",
        default=False,
        db_index=True,
        help_text="–§–ª–∞–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ)",
    )
    published_at: models.DateTimeField = models.DateTimeField(
        "–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏",
        db_index=True,
        help_text="–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏",
    )
    created_at: models.DateTimeField = models.DateTimeField(
        "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è",
        auto_now_add=True,
    )
    updated_at: models.DateTimeField = models.DateTimeField(
        "–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è",
        auto_now=True,
    )

    objects = models.Manager()

    class Meta:
        verbose_name = "–ù–æ–≤–æ—Å—Ç—å"
        verbose_name_plural = "–ù–æ–≤–æ—Å—Ç–∏"
        db_table = "news"
        ordering = ["-published_at"]
        indexes = [
            models.Index(fields=["is_published", "published_at"]),
            models.Index(fields=["slug"]),
            models.Index(fields=["category", "published_at"]),
            models.Index(fields=["published_at"]),
        ]

    def __str__(self) -> str:
        return self.title

    def save(self, *args, **kwargs) -> None:
        """–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è slug –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞."""
        if not self.slug:
            self.slug = slugify(self.title, allow_unicode=True)
        super().save(*args, **kwargs)
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ `slug` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (–¥–ª—è SEO-friendly URLs)
- ‚úÖ `excerpt` - –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è –∫—Ä–∞—Ç–∫–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è (–Ω–µ –æ–±—Ä–µ–∑–∫–∞ content)
- ‚úÖ `is_published` + `published_at` - draft/publish –ø–∞—Ç—Ç–µ—Ä–Ω
- ‚úÖ `image` - ImageField —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –ø–æ –¥–∞—Ç–∞–º (news/2025/11/)
- ‚úÖ `category` - –¥–ª—è –±—É–¥—É—â–µ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- ‚úÖ Composite –∏–Ω–¥–µ–∫—Å `(is_published, published_at)` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

---

## 2. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã (Serializers)

### 2.1. SubscribeSerializer

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∞–ª–∏–¥–∞—Ü–∏—è email –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É

```python
# backend/apps/common/serializers.py

from __future__ import annotations

from rest_framework import serializers
from .models import Newsletter


class SubscribeSerializer(serializers.Serializer):
    """
    –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É.
    –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç email –∏ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ Newsletter.
    """

    email = serializers.EmailField(
        required=True,
        max_length=255,
        help_text="Email –∞–¥—Ä–µ—Å –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏",
    )

    def validate_email(self, value: str) -> str:
        """
        –í–∞–ª–∏–¥–∞—Ü–∏—è email –∞–¥—Ä–µ—Å–∞.
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏.
        """
        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è email (lowercase)
        value = value.lower().strip()

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∞–∫—Ç–∏–≤–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É
        if Newsletter.objects.filter(email=value, is_active=True).exists():
            raise serializers.ValidationError(
                "–≠—Ç–æ—Ç email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É"
            )

        return value

    def create(self, validated_data: dict) -> Newsletter:
        """
        –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏.
        –ï—Å–ª–∏ email —Ä–∞–Ω–µ–µ –æ—Ç–ø–∏—Å–∞–ª—Å—è - —Ä–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å–∫—É.
        """
        email = validated_data["email"]

        # –ü–æ–ª—É—á–∞–µ–º IP –∏ User-Agent –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (request)
        request = self.context.get("request")
        ip_address = None
        user_agent = ""

        if request:
            # –ü–æ–ª—É—á–∞–µ–º IP —Å —É—á–µ—Ç–æ–º proxy (X-Forwarded-For)
            x_forwarded_for = request.META.get("HTTP_X_FORWARDED_FOR")
            if x_forwarded_for:
                ip_address = x_forwarded_for.split(",")[0]
            else:
                ip_address = request.META.get("REMOTE_ADDR")

            user_agent = request.META.get("HTTP_USER_AGENT", "")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
        try:
            subscription = Newsletter.objects.get(email=email, is_active=False)
            # –†–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å–∫—É
            subscription.is_active = True
            subscription.unsubscribed_at = None
            subscription.ip_address = ip_address
            subscription.user_agent = user_agent
            subscription.save(
                update_fields=[
                    "is_active",
                    "unsubscribed_at",
                    "ip_address",
                    "user_agent",
                ]
            )
            return subscription
        except Newsletter.DoesNotExist:
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É
            return Newsletter.objects.create(
                email=email,
                ip_address=ip_address,
                user_agent=user_agent,
            )


class SubscribeResponseSerializer(serializers.Serializer):
    """–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–µ."""

    message = serializers.CharField()
    email = serializers.EmailField()


class UnsubscribeSerializer(serializers.Serializer):
    """
    –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–ª—è –æ—Ç–ø–∏—Å–∫–∏ –æ—Ç email-—Ä–∞—Å—Å—ã–ª–∫–∏.
    –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç email –∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É.
    """

    email = serializers.EmailField(
        required=True,
        max_length=255,
        help_text="Email –∞–¥—Ä–µ—Å –¥–ª—è –æ—Ç–ø–∏—Å–∫–∏",
    )

    def validate_email(self, value: str) -> str:
        """
        –í–∞–ª–∏–¥–∞—Ü–∏—è email –∞–¥—Ä–µ—Å–∞.
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏.
        """
        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è email (lowercase)
        value = value.lower().strip()

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
        if not Newsletter.objects.filter(email=value, is_active=True).exists():
            raise serializers.ValidationError(
                "–≠—Ç–æ—Ç email –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω"
            )

        return value

    def save(self) -> Newsletter:
        """
        –û—Ç–ø–∏—Å–∫–∞ –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏.
        –í—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ unsubscribe() –º–æ–¥–µ–ª–∏.
        """
        email = self.validated_data["email"]
        subscription = Newsletter.objects.get(email=email, is_active=True)
        subscription.unsubscribe()
        return subscription


class UnsubscribeResponseSerializer(serializers.Serializer):
    """–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø–∏—Å–∫–µ."""

    message = serializers.CharField()
    email = serializers.EmailField()
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ **SubscribeSerializer:** Email normalization, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- ‚úÖ **UnsubscribeSerializer:** –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ `unsubscribe()`
- ‚úÖ –ó–∞—Ö–≤–∞—Ç IP –∏ User-Agent –∏–∑ request context (subscribe)
- ‚úÖ X-Forwarded-For support (–¥–ª—è —Ä–∞–±–æ—Ç—ã –∑–∞ reverse proxy)
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ Response serializers –¥–ª—è typed API responses

---

### 2.2. NewsSerializer

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è API

```python
# backend/apps/common/serializers.py

from rest_framework import serializers
from .models import News


class NewsSerializer(serializers.ModelSerializer):
    """
    –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–∏ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ API.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è.
    """

    class Meta:
        model = News
        fields = [
            "id",
            "title",
            "slug",
            "excerpt",
            "content",
            "image",
            "published_at",
            "created_at",
            "updated_at",
            "author",
            "category",
        ]
        read_only_fields = [
            "id",
            "slug",
            "created_at",
            "updated_at",
        ]

    def to_representation(self, instance):
        """
        –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞.
        –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º image –≤ –ø–æ–ª–Ω—ã–π URL.
        """
        data = super().to_representation(instance)

        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º image –≤ –ø–æ–ª–Ω—ã–π URL
        request = self.context.get("request")
        if instance.image and request:
            data["image"] = request.build_absolute_uri(instance.image.url)
        elif not instance.image:
            data["image"] = None

        return data
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ ModelSerializer –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ `to_representation()` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è image –≤ –ø–æ–ª–Ω—ã–π URL
- ‚úÖ –í—Å–µ –ø–æ–ª—è read_only –∫—Ä–æ–º–µ —Ç–µ—Ö, —á—Ç–æ –Ω—É–∂–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ `content` –≤–∫–ª—é—á–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–æ–≤–æ—Å—Ç–∏

---

## 3. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Views)

### 3.1. SubscribeView

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ POST –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É

```python
# backend/apps/common/views.py

from __future__ import annotations

from drf_spectacular.utils import (
    OpenApiExample,
    OpenApiResponse,
    extend_schema,
)
from rest_framework import status
from rest_framework.decorators import api_view, permission_classes
from rest_framework.permissions import AllowAny
from rest_framework.request import Request
from rest_framework.response import Response

from .serializers import SubscribeSerializer, SubscribeResponseSerializer


@extend_schema(
    summary="–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É",
    description=(
        "–ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É –æ –Ω–æ–≤–∏–Ω–∫–∞—Ö –∏ –∞–∫—Ü–∏—è—Ö. "
        "–ï—Å–ª–∏ email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 409 Conflict."
    ),
    request=SubscribeSerializer,
    responses={
        201: OpenApiResponse(
            description="–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞",
            examples=[
                OpenApiExample(
                    name="success_response",
                    value={
                        "message": "–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É",
                        "email": "user@example.com",
                    },
                    response_only=True,
                )
            ],
        ),
        400: OpenApiResponse(
            description="–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email",
            examples=[
                OpenApiExample(
                    name="validation_error",
                    value={
                        "email": ["–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å."],
                    },
                    response_only=True,
                )
            ],
        ),
        409: OpenApiResponse(
            description="Email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É",
            examples=[
                OpenApiExample(
                    name="already_subscribed",
                    value={
                        "email": ["–≠—Ç–æ—Ç email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É"],
                    },
                    response_only=True,
                )
            ],
        ),
    },
    tags=["Newsletter"],
)
@api_view(["POST"])
@permission_classes([AllowAny])
def subscribe(request: Request) -> Response:
    """
    –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É.

    –ü—Ä–∏–Ω–∏–º–∞–µ—Ç email –∞–¥—Ä–µ—Å –∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É.
    –ï—Å–ª–∏ email —Ä–∞–Ω–µ–µ –æ—Ç–ø–∏—Å–∞–ª—Å—è - —Ä–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É.
    """
    serializer = SubscribeSerializer(data=request.data, context={"request": request})

    if serializer.is_valid():
        subscription = serializer.save()

        response_serializer = SubscribeResponseSerializer(
            {
                "message": "–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É",
                "email": subscription.email,
            }
        )

        return Response(
            response_serializer.data,
            status=status.HTTP_201_CREATED,
        )

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ "—É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω"
    if "email" in serializer.errors:
        error_msg = str(serializer.errors["email"][0])
        if "—É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω" in error_msg:
            return Response(
                serializer.errors,
                status=status.HTTP_409_CONFLICT,
            )

    # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    return Response(
        serializer.errors,
        status=status.HTTP_400_BAD_REQUEST,
    )
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ `AllowAny` permission - –¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)
- ‚úÖ OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ `@extend_schema`
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (400 vs 409)
- ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ request –≤ serializer context (–¥–ª—è IP/User-Agent)
- ‚úÖ HTTP 201 Created –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–µ
- ‚úÖ HTTP 409 Conflict –ø—Ä–∏ –¥—É–±–ª–∏–∫–∞—Ç–µ (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)

---

### 3.2. UnsubscribeView

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ POST –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Ç–ø–∏—Å–∫—É –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏

```python
# backend/apps/common/views.py

from __future__ import annotations

from drf_spectacular.utils import (
    OpenApiExample,
    OpenApiResponse,
    extend_schema,
)
from rest_framework import status
from rest_framework.decorators import api_view, permission_classes
from rest_framework.permissions import AllowAny
from rest_framework.request import Request
from rest_framework.response import Response

from .serializers import UnsubscribeSerializer, UnsubscribeResponseSerializer


@extend_schema(
    summary="–û—Ç–ø–∏—Å–∫–∞ –æ—Ç email-—Ä–∞—Å—Å—ã–ª–∫–∏",
    description=(
        "–û—Ç–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç email-—Ä–∞—Å—Å—ã–ª–∫–∏. "
        "–ï—Å–ª–∏ email –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 Not Found."
    ),
    request=UnsubscribeSerializer,
    responses={
        200: OpenApiResponse(
            description="–û—Ç–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞",
            examples=[
                OpenApiExample(
                    name="success_response",
                    value={
                        "message": "–í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏",
                        "email": "user@example.com",
                    },
                    response_only=True,
                )
            ],
        ),
        400: OpenApiResponse(
            description="–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email",
            examples=[
                OpenApiExample(
                    name="validation_error",
                    value={
                        "email": ["–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å."],
                    },
                    response_only=True,
                )
            ],
        ),
        404: OpenApiResponse(
            description="Email –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω",
            examples=[
                OpenApiExample(
                    name="not_found",
                    value={
                        "email": [
                            "–≠—Ç–æ—Ç email –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω"
                        ],
                    },
                    response_only=True,
                )
            ],
        ),
    },
    tags=["Newsletter"],
)
@api_view(["POST"])
@permission_classes([AllowAny])
def unsubscribe(request: Request) -> Response:
    """
    –û—Ç–ø–∏—Å–∫–∞ –æ—Ç email-—Ä–∞—Å—Å—ã–ª–∫–∏.

    –ü—Ä–∏–Ω–∏–º–∞–µ—Ç email –∞–¥—Ä–µ—Å –∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É.
    """
    serializer = UnsubscribeSerializer(data=request.data)

    if serializer.is_valid():
        subscription = serializer.save()

        response_serializer = UnsubscribeResponseSerializer(
            {
                "message": "–í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏",
                "email": subscription.email,
            }
        )

        return Response(
            response_serializer.data,
            status=status.HTTP_200_OK,
        )

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ "–Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω"
    if "email" in serializer.errors:
        error_msg = str(serializer.errors["email"][0])
        if "–Ω–µ –Ω–∞–π–¥–µ–Ω" in error_msg or "—É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω" in error_msg:
            return Response(
                serializer.errors,
                status=status.HTTP_404_NOT_FOUND,
            )

    # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    return Response(
        serializer.errors,
        status=status.HTTP_400_BAD_REQUEST,
    )
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ `AllowAny` permission - –¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- ‚úÖ OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ `@extend_schema`
- ‚úÖ HTTP 200 OK –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø–∏—Å–∫–µ (–Ω–µ 204, —Ç.–∫. –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ HTTP 404 Not Found –µ—Å–ª–∏ email –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- ‚úÖ GDPR compliance - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø–∏—Å–∫–∏ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

### 3.3. NewsListView

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —Å pagination

```python
# backend/apps/common/views.py

from django.utils import timezone
from drf_spectacular.utils import (
    OpenApiExample,
    OpenApiParameter,
    OpenApiResponse,
    extend_schema,
)
from rest_framework import generics, status
from rest_framework.permissions import AllowAny

from .models import News
from .serializers import NewsSerializer


@extend_schema(
    summary="–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π",
    description=(
        "–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π. "
        "–ù–æ–≤–æ—Å—Ç–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ)."
    ),
    parameters=[
        OpenApiParameter(
            name="page_size",
            type=int,
            location=OpenApiParameter.QUERY,
            description="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10, –º–∞–∫—Å: 100)",
            required=False,
        ),
        OpenApiParameter(
            name="page",
            type=int,
            location=OpenApiParameter.QUERY,
            description="–ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)",
            required=False,
        ),
    ],
    responses={
        200: OpenApiResponse(
            description="–°–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω",
            examples=[
                OpenApiExample(
                    name="success_response",
                    value={
                        "count": 15,
                        "next": "http://api.example.com/api/v1/news?page=2",
                        "previous": None,
                        "results": [
                            {
                                "id": 1,
                                "title": "–ù–æ–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è 2025",
                                "slug": "new-collection-2025",
                                "excerpt": "–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –æ–¥–µ–∂–¥—ã...",
                                "content": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏...",
                                "image": "http://api.example.com/media/news/2025/11/collection.jpg",
                                "published_at": "2025-11-18T10:00:00Z",
                                "created_at": "2025-11-17T15:30:00Z",
                                "updated_at": "2025-11-18T09:00:00Z",
                                "author": "FREESPORT Team",
                                "category": "–Ω–æ–≤–∏–Ω–∫–∏",
                            },
                            {
                                "id": 2,
                                "title": "–°–∫–∏–¥–∫–∏ –Ω–∞ –∑–∏–º–Ω—é—é —ç–∫–∏–ø–∏—Ä–æ–≤–∫—É",
                                "slug": "winter-sale",
                                "excerpt": "–î–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞ —Å–∫–∏–¥–∫–∏ –¥–æ 30%...",
                                "content": "",
                                "image": None,
                                "published_at": "2025-11-17T12:00:00Z",
                                "created_at": "2025-11-16T10:00:00Z",
                                "updated_at": "2025-11-17T11:30:00Z",
                                "author": "",
                                "category": "–∞–∫—Ü–∏–∏",
                            },
                        ],
                    },
                    response_only=True,
                )
            ],
        ),
    },
    tags=["News"],
)
class NewsListView(generics.ListAPIView):
    """
    API endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π.

    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ (is_published=True)
    —Å –¥–∞—Ç–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ <= —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞.
    """

    serializer_class = NewsSerializer
    permission_classes = [AllowAny]

    def get_queryset(self):
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏.
        –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—à–µ–¥—à–∏–µ/—Ç–µ–∫—É—â–∏–µ).
        """
        return News.objects.filter(
            is_published=True,
            published_at__lte=timezone.now(),
        ).order_by("-published_at")
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ `ListAPIView` - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –∏–∑ DRF
- ‚úÖ `AllowAny` permission - –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π (`is_published=True`)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±—É–¥—É—â–∏–µ –Ω–æ–≤–æ—Å—Ç–∏)
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `-published_at` (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ)
- ‚úÖ OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å examples

---

## 4. URL –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 4.1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è endpoints

```python
# backend/apps/common/urls.py

from django.urls import path

from . import views

app_name = "common"

urlpatterns = [
    # Existing endpoints
    path("health/", views.health_check, name="health-check"),
    path(
        "monitoring/metrics/operations/",
        views.operation_metrics,
        name="operation-metrics",
    ),
    path(
        "monitoring/metrics/business/",
        views.business_metrics,
        name="business-metrics",
    ),
    path(
        "monitoring/metrics/realtime/",
        views.realtime_metrics,
        name="realtime-metrics",
    ),
    path("monitoring/health/", views.system_health, name="system-health"),

    # NEW: Newsletter & News endpoints
    path("subscribe/", views.subscribe, name="subscribe"),
    path("unsubscribe/", views.unsubscribe, name="unsubscribe"),
    path("news/", views.NewsListView.as_view(), name="news-list"),
]
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ RESTful naming: `/subscribe/` (POST), `/unsubscribe/` (POST), `/news/` (GET)
- ‚úÖ Naming convention —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º endpoints
- ‚úÖ URL names –¥–ª—è reverse() –≤ —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ endpoints –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏/–æ—Ç–ø–∏—Å–∫–∏

---

## 5. –ú–∏–≥—Ä–∞—Ü–∏–∏ Django

### 5.1. –ö–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
cd backend
python manage.py makemigrations common --name add_newsletter_and_news_models

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
python manage.py migrate common
```

### 5.2. –û–∂–∏–¥–∞–µ–º–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```python
# backend/apps/common/migrations/0XXX_add_newsletter_and_news_models.py

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('common', '0XXX_previous_migration'),
    ]

    operations = [
        migrations.CreateModel(
            name='Newsletter',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('email', models.EmailField(db_index=True, help_text='–£–Ω–∏–∫–∞–ª—å–Ω—ã–π email –∞–¥—Ä–µ—Å –ø–æ–¥–ø–∏—Å—á–∏–∫–∞', max_length=255, unique=True, verbose_name='Email –∞–¥—Ä–µ—Å')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='–§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∫–∏ (–¥–ª—è –æ—Ç–ø–∏—Å–∫–∏)', verbose_name='–ê–∫—Ç–∏–≤–Ω–∞')),
                ('subscribed_at', models.DateTimeField(auto_now_add=True, db_index=True, help_text='–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–¥–ø–∏—Å–∫–∏', verbose_name='–î–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏')),
                ('unsubscribed_at', models.DateTimeField(blank=True, help_text='–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ—Ç–ø–∏—Å–∫–∏ (null –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞)', null=True, verbose_name='–î–∞—Ç–∞ –æ—Ç–ø–∏—Å–∫–∏')),
                ('ip_address', models.GenericIPAddressField(blank=True, help_text='IP –∞–¥—Ä–µ—Å –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ (–¥–ª—è –∞–Ω—Ç–∏—Å–ø–∞–º)', null=True, verbose_name='IP –∞–¥—Ä–µ—Å')),
                ('user_agent', models.TextField(blank=True, help_text='–ë—Ä–∞—É–∑–µ—Ä –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ', verbose_name='User Agent')),
            ],
            options={
                'verbose_name': '–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É',
                'verbose_name_plural': '–ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É',
                'db_table': 'newsletter_subscriptions',
                'ordering': ['-subscribed_at'],
            },
        ),
        migrations.CreateModel(
            name='News',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(help_text='–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏', max_length=200, verbose_name='–ó–∞–≥–æ–ª–æ–≤–æ–∫')),
                ('slug', models.SlugField(db_index=True, help_text='–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è URL', max_length=255, unique=True, verbose_name='URL slug')),
                ('excerpt', models.TextField(help_text='–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)', max_length=500, verbose_name='–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ')),
                ('content', models.TextField(blank=True, help_text='–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)', verbose_name='–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç')),
                ('image', models.ImageField(blank=True, help_text='–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)', null=True, upload_to='news/%Y/%m/', verbose_name='–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ')),
                ('author', models.CharField(blank=True, help_text='–ò–º—è –∞–≤—Ç–æ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)', max_length=100, verbose_name='–ê–≤—Ç–æ—Ä')),
                ('category', models.CharField(blank=True, db_index=True, help_text='–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–æ–≤–æ—Å—Ç–∏ (–∞–∫—Ü–∏—è, –Ω–æ–≤–∏–Ω–∫–∞, —Å–æ–±—ã—Ç–∏–µ)', max_length=50, verbose_name='–ö–∞—Ç–µ–≥–æ—Ä–∏—è')),
                ('is_published', models.BooleanField(db_index=True, default=False, help_text='–§–ª–∞–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ)', verbose_name='–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞')),
                ('published_at', models.DateTimeField(db_index=True, help_text='–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏', verbose_name='–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è')),
            ],
            options={
                'verbose_name': '–ù–æ–≤–æ—Å—Ç—å',
                'verbose_name_plural': '–ù–æ–≤–æ—Å—Ç–∏',
                'db_table': 'news',
                'ordering': ['-published_at'],
            },
        ),
        migrations.AddIndex(
            model_name='newsletter',
            index=models.Index(fields=['email'], name='newsletter_subscriptions_email_idx'),
        ),
        migrations.AddIndex(
            model_name='newsletter',
            index=models.Index(fields=['is_active', 'subscribed_at'], name='newsletter_subscriptions_is_active_subscribed_at_idx'),
        ),
        migrations.AddIndex(
            model_name='newsletter',
            index=models.Index(fields=['subscribed_at'], name='newsletter_subscriptions_subscribed_at_idx'),
        ),
        migrations.AddIndex(
            model_name='news',
            index=models.Index(fields=['is_published', 'published_at'], name='news_is_published_published_at_idx'),
        ),
        migrations.AddIndex(
            model_name='news',
            index=models.Index(fields=['slug'], name='news_slug_idx'),
        ),
        migrations.AddIndex(
            model_name='news',
            index=models.Index(fields=['category', 'published_at'], name='news_category_published_at_idx'),
        ),
        migrations.AddIndex(
            model_name='news',
            index=models.Index(fields=['published_at'], name='news_published_at_idx'),
        ),
    ]
```

---

## 6. Backend Tests

### 6.1. Newsletter Tests

```python
# backend/apps/common/tests/test_subscribe.py

from __future__ import annotations

import pytest
from django.urls import reverse
from rest_framework import status

from apps.common.models import Newsletter


@pytest.mark.django_db
class TestSubscribeEndpoint:
    """–¢–µ—Å—Ç—ã –¥–ª—è POST /api/v1/subscribe endpoint."""

    def test_subscribe_success(self, api_client):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É."""
        url = reverse("common:subscribe")
        data = {"email": "newuser@example.com"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_201_CREATED
        assert response.data["message"] == "–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É"
        assert response.data["email"] == "newuser@example.com"

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î
        assert Newsletter.objects.filter(email="newuser@example.com").exists()
        subscription = Newsletter.objects.get(email="newuser@example.com")
        assert subscription.is_active is True

    def test_subscribe_duplicate_email(self, api_client):
        """–¢–µ—Å—Ç –ø–æ–¥–ø–∏—Å–∫–∏ —Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º email."""
        # –°–æ–∑–¥–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ø–æ–¥–ø–∏—Å–∫—É
        Newsletter.objects.create(email="existing@example.com", is_active=True)

        url = reverse("common:subscribe")
        data = {"email": "existing@example.com"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_409_CONFLICT
        assert "—É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω" in str(response.data["email"][0])

    def test_subscribe_reactivate_unsubscribed(self, api_client):
        """–¢–µ—Å—Ç —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–∞–Ω–µ–µ –æ—Ç–ø–∏—Å–∞–≤—à–µ–≥–æ—Å—è email."""
        # –°–æ–∑–¥–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É
        Newsletter.objects.create(email="unsubscribed@example.com", is_active=False)

        url = reverse("common:subscribe")
        data = {"email": "unsubscribed@example.com"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_201_CREATED

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—é
        subscription = Newsletter.objects.get(email="unsubscribed@example.com")
        assert subscription.is_active is True
        assert subscription.unsubscribed_at is None

    def test_subscribe_invalid_email(self, api_client):
        """–¢–µ—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º email –∞–¥—Ä–µ—Å–æ–º."""
        url = reverse("common:subscribe")
        data = {"email": "invalid-email"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_400_BAD_REQUEST
        assert "email" in response.data

    def test_subscribe_email_normalization(self, api_client):
        """–¢–µ—Å—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ email (lowercase)."""
        url = reverse("common:subscribe")
        data = {"email": "TestUser@EXAMPLE.COM"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_201_CREATED

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ lowercase
        subscription = Newsletter.objects.get(email="testuser@example.com")
        assert subscription.email == "testuser@example.com"


@pytest.mark.django_db
class TestUnsubscribeEndpoint:
    """–¢–µ—Å—Ç—ã –¥–ª—è POST /api/v1/unsubscribe endpoint."""

    def test_unsubscribe_success(self, api_client):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø–∏—Å–∫–∏ –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏."""
        # –°–æ–∑–¥–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É
        Newsletter.objects.create(email="subscriber@example.com", is_active=True)

        url = reverse("common:unsubscribe")
        data = {"email": "subscriber@example.com"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_200_OK
        assert response.data["message"] == "–í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏"
        assert response.data["email"] == "subscriber@example.com"

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—é –≤ –ë–î
        subscription = Newsletter.objects.get(email="subscriber@example.com")
        assert subscription.is_active is False
        assert subscription.unsubscribed_at is not None

    def test_unsubscribe_not_found(self, api_client):
        """–¢–µ—Å—Ç –æ—Ç–ø–∏—Å–∫–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ email."""
        url = reverse("common:unsubscribe")
        data = {"email": "nonexistent@example.com"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_404_NOT_FOUND
        assert "–Ω–µ –Ω–∞–π–¥–µ–Ω" in str(response.data["email"][0])

    def test_unsubscribe_already_unsubscribed(self, api_client):
        """–¢–µ—Å—Ç –æ—Ç–ø–∏—Å–∫–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω–Ω–æ–≥–æ email."""
        # –°–æ–∑–¥–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É
        Newsletter.objects.create(email="unsubscribed@example.com", is_active=False)

        url = reverse("common:unsubscribe")
        data = {"email": "unsubscribed@example.com"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_404_NOT_FOUND
        assert "—É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω" in str(response.data["email"][0])

    def test_unsubscribe_invalid_email(self, api_client):
        """–¢–µ—Å—Ç –æ—Ç–ø–∏—Å–∫–∏ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º email."""
        url = reverse("common:unsubscribe")
        data = {"email": "invalid-email"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_400_BAD_REQUEST
        assert "email" in response.data

    def test_unsubscribe_email_normalization(self, api_client):
        """–¢–µ—Å—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ email –ø—Ä–∏ –æ—Ç–ø–∏—Å–∫–µ."""
        # –°–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∏—Å–∫—É –≤ lowercase
        Newsletter.objects.create(email="testuser@example.com", is_active=True)

        url = reverse("common:unsubscribe")
        data = {"email": "TestUser@EXAMPLE.COM"}

        response = api_client.post(url, data, format="json")

        assert response.status_code == status.HTTP_200_OK

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–ø–∏—Å–∫—É
        subscription = Newsletter.objects.get(email="testuser@example.com")
        assert subscription.is_active is False
```

---

### 6.2. News Tests

```python
# backend/apps/common/tests/test_news.py

from __future__ import annotations

from datetime import timedelta

import pytest
from django.urls import reverse
from django.utils import timezone
from rest_framework import status

from apps.common.models import News


@pytest.mark.django_db
class TestNewsListEndpoint:
    """–¢–µ—Å—Ç—ã –¥–ª—è GET /api/v1/news endpoint."""

    @pytest.fixture
    def published_news(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–æ–≤."""
        now = timezone.now()
        return [
            News.objects.create(
                title="–ù–æ–≤–æ—Å—Ç—å 1",
                slug="news-1",
                excerpt="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ 1",
                is_published=True,
                published_at=now - timedelta(days=1),
            ),
            News.objects.create(
                title="–ù–æ–≤–æ—Å—Ç—å 2",
                slug="news-2",
                excerpt="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ 2",
                is_published=True,
                published_at=now - timedelta(days=2),
            ),
            News.objects.create(
                title="–ù–æ–≤–æ—Å—Ç—å 3",
                slug="news-3",
                excerpt="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ 3",
                is_published=True,
                published_at=now - timedelta(days=3),
            ),
        ]

    def test_get_news_list_success(self, api_client, published_news):
        """–¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π."""
        url = reverse("common:news-list")

        response = api_client.get(url)

        assert response.status_code == status.HTTP_200_OK
        assert response.data["count"] == 3
        assert len(response.data["results"]) == 3

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ)
        assert response.data["results"][0]["title"] == "–ù–æ–≤–æ—Å—Ç—å 1"
        assert response.data["results"][1]["title"] == "–ù–æ–≤–æ—Å—Ç—å 2"
        assert response.data["results"][2]["title"] == "–ù–æ–≤–æ—Å—Ç—å 3"

    def test_get_news_list_with_pagination(self, api_client, published_news):
        """–¢–µ—Å—Ç pagination –¥–ª—è —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π."""
        url = reverse("common:news-list")

        response = api_client.get(url, {"page_size": 2})

        assert response.status_code == status.HTTP_200_OK
        assert len(response.data["results"]) == 2
        assert response.data["next"] is not None

    def test_get_news_list_only_published(self, api_client):
        """–¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π."""
        now = timezone.now()

        # –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å
        News.objects.create(
            title="–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è",
            slug="published",
            excerpt="–û–ø–∏—Å–∞–Ω–∏–µ",
            is_published=True,
            published_at=now - timedelta(days=1),
        )

        # –ù–µ–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å (draft)
        News.objects.create(
            title="–ß–µ—Ä–Ω–æ–≤–∏–∫",
            slug="draft",
            excerpt="–û–ø–∏—Å–∞–Ω–∏–µ",
            is_published=False,
            published_at=now - timedelta(days=1),
        )

        url = reverse("common:news-list")
        response = api_client.get(url)

        assert response.status_code == status.HTTP_200_OK
        assert response.data["count"] == 1
        assert response.data["results"][0]["title"] == "–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è"

    def test_get_news_list_exclude_future_news(self, api_client):
        """–¢–µ—Å—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π —Å –±—É–¥—É—â–µ–π –¥–∞—Ç–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏."""
        now = timezone.now()

        # –ü—Ä–æ—à–ª–∞—è –Ω–æ–≤–æ—Å—Ç—å
        News.objects.create(
            title="–ü—Ä–æ—à–ª–∞—è –Ω–æ–≤–æ—Å—Ç—å",
            slug="past-news",
            excerpt="–û–ø–∏—Å–∞–Ω–∏–µ",
            is_published=True,
            published_at=now - timedelta(days=1),
        )

        # –ë—É–¥—É—â–∞—è –Ω–æ–≤–æ—Å—Ç—å
        News.objects.create(
            title="–ë—É–¥—É—â–∞—è –Ω–æ–≤–æ—Å—Ç—å",
            slug="future-news",
            excerpt="–û–ø–∏—Å–∞–Ω–∏–µ",
            is_published=True,
            published_at=now + timedelta(days=1),
        )

        url = reverse("common:news-list")
        response = api_client.get(url)

        assert response.status_code == status.HTTP_200_OK
        assert response.data["count"] == 1
        assert response.data["results"][0]["title"] == "–ü—Ä–æ—à–ª–∞—è –Ω–æ–≤–æ—Å—Ç—å"
```

---

## 7. OpenAPI Specification

### 7.1. docs/api-spec.yaml Update

```yaml
# docs/api-spec.yaml

paths:
  /api/v1/subscribe:
    post:
      operationId: subscribe_create
      summary: –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É
      description: |
        –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ email-—Ä–∞—Å—Å—ã–ª–∫—É –æ –Ω–æ–≤–∏–Ω–∫–∞—Ö –∏ –∞–∫—Ü–∏—è—Ö.
        –ï—Å–ª–∏ email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 409 Conflict.
      tags:
        - Newsletter
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  maxLength: 255
                  description: Email –∞–¥—Ä–µ—Å –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏
                  example: user@example.com
      responses:
        '201':
          description: –ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: –í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
                  email:
                    type: string
                    format: email
                    example: user@example.com
        '400':
          description: –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                    example: ["–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å."]
        '409':
          description: Email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                    example: ["–≠—Ç–æ—Ç email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É"]

  /api/v1/unsubscribe:
    post:
      operationId: unsubscribe_create
      summary: –û—Ç–ø–∏—Å–∫–∞ –æ—Ç email-—Ä–∞—Å—Å—ã–ª–∫–∏
      description: |
        –û—Ç–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç email-—Ä–∞—Å—Å—ã–ª–∫–∏.
        –ï—Å–ª–∏ email –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 Not Found.
      tags:
        - Newsletter
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  maxLength: 255
                  description: Email –∞–¥—Ä–µ—Å –¥–ª—è –æ—Ç–ø–∏—Å–∫–∏
                  example: user@example.com
      responses:
        '200':
          description: –û—Ç–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: –í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏
                  email:
                    type: string
                    format: email
                    example: user@example.com
        '400':
          description: –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                    example: ["–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å."]
        '404':
          description: Email –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                    example: ["–≠—Ç–æ—Ç email –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏–ª–∏ —É–∂–µ –æ—Ç–ø–∏—Å–∞–Ω"]

  /api/v1/news:
    get:
      operationId: news_list
      summary: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π
      description: |
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.
        –ù–æ–≤–æ—Å—Ç–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ).
      tags:
        - News
      parameters:
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            default: 10
            maximum: 100
          description: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
          description: –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      responses:
        '200':
          description: –°–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                    description: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π
                    example: 15
                  next:
                    type: string
                    nullable: true
                    format: uri
                    description: URL —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    example: "http://api.example.com/api/v1/news?page=2"
                  previous:
                    type: string
                    nullable: true
                    format: uri
                    description: URL –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    example: null
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/NewsItem'

components:
  schemas:
    NewsItem:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          example: 1
        title:
          type: string
          maxLength: 200
          example: "–ù–æ–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è 2025"
        slug:
          type: string
          maxLength: 255
          readOnly: true
          example: "new-collection-2025"
        excerpt:
          type: string
          maxLength: 500
          description: –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
          example: "–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –æ–¥–µ–∂–¥—ã..."
        content:
          type: string
          nullable: true
          description: –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
          example: "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏..."
        image:
          type: string
          format: uri
          nullable: true
          description: URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–∏
          example: "http://api.example.com/media/news/2025/11/collection.jpg"
        published_at:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
          example: "2025-11-18T10:00:00Z"
        created_at:
          type: string
          format: date-time
          readOnly: true
          example: "2025-11-17T15:30:00Z"
        updated_at:
          type: string
          format: date-time
          readOnly: true
          example: "2025-11-18T09:00:00Z"
        author:
          type: string
          maxLength: 100
          nullable: true
          example: "FREESPORT Team"
        category:
          type: string
          maxLength: 50
          nullable: true
          example: "–Ω–æ–≤–∏–Ω–∫–∏"
```

---

## 8. Admin Panel Configuration

### 8.1. Django Admin –¥–ª—è Newsletter

```python
# backend/apps/common/admin.py

from django.contrib import admin
from .models import Newsletter, News


@admin.register(Newsletter)
class NewsletterAdmin(admin.ModelAdmin):
    """Admin –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É."""

    list_display = [
        "email",
        "is_active",
        "subscribed_at",
        "unsubscribed_at",
    ]
    list_filter = [
        "is_active",
        "subscribed_at",
    ]
    search_fields = [
        "email",
    ]
    readonly_fields = [
        "subscribed_at",
        "unsubscribed_at",
        "ip_address",
        "user_agent",
    ]
    date_hierarchy = "subscribed_at"

    def has_add_permission(self, request):
        """–¢–æ–ª—å–∫–æ superuser –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ —á–µ—Ä–µ–∑ admin."""
        return request.user.is_superuser
```

---

### 8.2. Django Admin –¥–ª—è News

```python
# backend/apps/common/admin.py

@admin.register(News)
class NewsAdmin(admin.ModelAdmin):
    """Admin –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π."""

    list_display = [
        "title",
        "category",
        "is_published",
        "published_at",
        "created_at",
    ]
    list_filter = [
        "is_published",
        "category",
        "published_at",
    ]
    search_fields = [
        "title",
        "excerpt",
        "content",
    ]
    prepopulated_fields = {
        "slug": ("title",),
    }
    readonly_fields = [
        "created_at",
        "updated_at",
    ]
    date_hierarchy = "published_at"

    fieldsets = (
        ("–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", {
            "fields": (
                "title",
                "slug",
                "category",
                "author",
            )
        }),
        ("–ö–æ–Ω—Ç–µ–Ω—Ç", {
            "fields": (
                "excerpt",
                "content",
                "image",
            )
        }),
        ("–ü—É–±–ª–∏–∫–∞—Ü–∏—è", {
            "fields": (
                "is_published",
                "published_at",
            )
        }),
        ("–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ", {
            "fields": (
                "created_at",
                "updated_at",
            ),
            "classes": ("collapse",),
        }),
    )
```

---

## 9. Implementation Checklist

**Dev Agent MUST complete —ç—Ç–æ—Ç —á–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

### Phase 2: Backend Implementation

- [ ] **2.1: –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª–∏ Newsletter –∏ News**
  - [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ `backend/apps/common/models.py`
  - [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `makemigrations` –∏ `migrate`
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –ë–î

- [ ] **2.2: –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã**
  - [ ] –°–æ–∑–¥–∞—Ç—å `backend/apps/common/serializers.py` (–µ—Å–ª–∏ –Ω–µ—Ç)
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `SubscribeSerializer`, `SubscribeResponseSerializer`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `UnsubscribeSerializer`, `UnsubscribeResponseSerializer`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `NewsSerializer`
  - [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é email

- [ ] **2.3: –°–æ–∑–¥–∞—Ç—å views**
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `subscribe` view –≤ `backend/apps/common/views.py`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `unsubscribe` view –≤ `backend/apps/common/views.py`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `NewsListView` –≤ `backend/apps/common/views.py`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —á–µ—Ä–µ–∑ `@extend_schema`

- [ ] **2.4: –û–±–Ω–æ–≤–∏—Ç—å URLs**
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–æ—É—Ç—ã `/subscribe/`, `/unsubscribe/`, `/news/` –≤ `backend/apps/common/urls.py`
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL names –¥–ª—è reverse()

- [ ] **2.5: –°–æ–∑–¥–∞—Ç—å admin configuration**
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `NewsletterAdmin` –≤ `backend/apps/common/admin.py`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `NewsAdmin` –≤ `backend/apps/common/admin.py`
  - [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å admin panel

- [ ] **2.6: –ù–∞–ø–∏—Å–∞—Ç—å backend tests**
  - [ ] –°–æ–∑–¥–∞—Ç—å `backend/apps/common/tests/test_subscribe.py`
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è subscribe endpoint (5 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è unsubscribe endpoint (5 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
  - [ ] –°–æ–∑–¥–∞—Ç—å `backend/apps/common/tests/test_news.py`
  - [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `pytest apps/common/tests/`
  - [ ] –£–±–µ–¥–∏—Ç—å—Å—è –≤ –ø–æ–∫—Ä—ã—Ç–∏–∏ > 90%

- [ ] **2.7: –û–±–Ω–æ–≤–∏—Ç—å api-spec.yaml**
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `/api/v1/subscribe` endpoint
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `/api/v1/unsubscribe` endpoint
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `/api/v1/news` endpoint
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `NewsItem` schema –≤ components

- [ ] **2.8: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ**
  - [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—É —Å –Ω–æ–≤–æ—Å—Ç—è–º–∏ –¥–ª—è development
  - [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å endpoints —á–µ—Ä–µ–∑ Swagger UI

---

## 10. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –†–µ—à–µ–Ω–∏—è –∏ –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

### 10.1. –ü–æ—á–µ–º—É apps/common?

‚úÖ **Newsletter –∏ News - –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –±–∏–∑–Ω–µ—Å-–¥–æ–º–µ–Ω—É (users, products, orders)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–æ–ª–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π (AuditLog, SyncLog)

### 10.2. –ü–æ—á–µ–º—É soft delete –¥–ª—è Newsletter?

‚úÖ **is_active –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è:**
- –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–¥–ø–∏—Å–æ–∫ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥—É–º–∞—Ç—å)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ GDPR (–º–æ–∂–µ–º –∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –Ω–µ —Ç–µ—Ä—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É)

### 10.3. –ü–æ—á–µ–º—É –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ excerpt –¥–ª—è News?

‚úÖ **excerpt –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç content:**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∏—à–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ù–µ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤ content - –ª—É—á—à–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–º–µ—Ç–∞-–æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π)

### 10.4. –ü–æ—á–µ–º—É AllowAny permission?

‚úÖ **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø:**
- –§–æ—Ä–º–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º)
- –ù–æ–≤–æ—Å—Ç–∏ - –ø—É–±–ª–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (SEO, sharable links)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º Story 11.3

### 10.5. –ü–æ—á–µ–º—É HTTP 409 –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤?

‚úÖ **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥:**
- 409 Conflict = "—Ä–µ—Å—É—Ä—Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
- 400 Bad Request = "–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
- –ü–æ–∑–≤–æ–ª—è–µ—Ç frontend —Ä–∞–∑–ª–∏—á–∞—Ç—å —Ç–∏–ø—ã –æ—à–∏–±–æ–∫

### 10.6. –ü–æ—á–µ–º—É Unsubscribe API –Ω–µ–æ–±—Ö–æ–¥–∏–º?

‚úÖ **GDPR compliance –∏ legal requirements:**
- GDPR Article 7(3) - –ø—Ä–∞–≤–æ –æ—Ç–æ–∑–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
- Email marketing best practice - –∫–∞–∂–¥–æ–µ –ø–∏—Å—å–º–æ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —Å—Å—ã–ª–∫—É "–û—Ç–ø–∏—Å–∞—Ç—å—Å—è"
- –ü—Ä–æ—Å—Ç–∞—è –æ—Ç–ø–∏—Å–∫–∞ —É–ª—É—á—à–∞–µ—Ç —Ä–µ–ø—É—Ç–∞—Ü–∏—é –¥–æ–º–µ–Ω–∞ (–∏–∑–±–µ–≥–∞–µ–º "spam" –∂–∞–ª–æ–±—ã)

‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ email):**
- POST /api/v1/unsubscribe —Å email –≤ body
- –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ —Å /api/v1/subscribe (–ø–æ–Ω—è—Ç–Ω—ã–π UX)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤/—Å—Å—ã–ª–æ–∫ (–±—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è MVP)

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ Future Enhancement (Story 11.4):**
- **–¢–µ–∫—É—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:** –ü—Ä–æ—Å—Ç–æ–π (–ø–æ email) - –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è MVP
- **Future Story 11.4:** Token-based unsubscribe (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏)
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ
  - GET /api/v1/unsubscribe/{token}/ endpoint
  - –°—Å—ã–ª–∫–∞ –≤ email: `https://freesport.com/unsubscribe?token=xxx`
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π (–Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø–∏—Å–∞—Ç—å —á—É–∂–æ–π email)
  - One-click unsubscribe (RFC 8058)

---

## 11. Performance Considerations

### 11.1. Database Indexes

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
- `Newsletter.email` - unique index (–±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
- `News(is_published, published_at)` - composite index (–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
- `News.slug` - unique index (–¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–æ–≤–æ—Å—Ç–∏)

### 11.2. Queryset Optimization

‚úÖ **–¢–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```python
# ‚ùå –ü–ª–æ—Ö–æ - –∑–∞–≥—Ä—É–∂–∞–µ–º –í–°–ï –Ω–æ–≤–æ—Å—Ç–∏
News.objects.all()

# ‚úÖ –•–æ—Ä–æ—à–æ - —Ç–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ, —Å –ª–∏–º–∏—Ç–æ–º
News.objects.filter(
    is_published=True,
    published_at__lte=timezone.now()
).order_by('-published_at')[:3]
```

### 11.3. Image Optimization

‚úÖ **Recommendation –¥–ª—è –±—É–¥—É—â–µ–≥–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Django ImageKit –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è thumbnails
- –î–æ–±–∞–≤–∏—Ç—å lazy loading –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- CDN –¥–ª—è media files (production)

---

## 12. Security Considerations

### 12.1. Email Validation

‚úÖ **Multi-layer –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
- Django EmailField –≤–∞–ª–∏–¥–∞—Ü–∏—è (—Ñ–æ—Ä–º–∞—Ç)
- DRF EmailField –≤–∞–ª–∏–¥–∞—Ü–∏—è (–¥–æ–ø–æ–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
- Custom validate_email() (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)

### 12.2. Rate Limiting

‚ö†Ô∏è **–í–ê–ñ–ù–û –¥–ª—è production (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: MEDIUM):**

**–î–æ–±–∞–≤–∏—Ç—å –≤ settings.py –ø–µ—Ä–µ–¥ production deploy:**
```python
# backend/freesport/settings/production.py
REST_FRAMEWORK = {
    'DEFAULT_THROTTLE_CLASSES': [
        'rest_framework.throttling.AnonRateThrottle',
    ],
    'DEFAULT_THROTTLE_RATES': {
        'anon': '10/hour',  # SPAM protection –¥–ª—è /subscribe endpoint
    }
}
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** SPAM protection –¥–ª—è production. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è endpoint'–æ–º –ø–æ–¥–ø–∏—Å–∫–∏.

**Impact:** –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è development/testing.

### 12.3. SPAM Protection

‚úÖ **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞:**
- IP address tracking (ip_address field)
- User-Agent logging
- Email normalization (lowercase)
- Rate limiting (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

---

## 13. Next Steps

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Phase 1 (Architecture):

1. ‚úÖ **–ü–µ—Ä–µ–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç Dev Agent** –¥–ª—è implementation
2. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å Story 11.3** —Å —Ñ–∏–Ω–∞–ª—å–Ω—ã–º–∏ API contracts
3. ‚úÖ **–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Å frontend team** TypeScript types

### Phase 2: Backend Implementation

1. **Dev Agent** —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–¥ —Å–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–æ–º—É design document
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç backend —Ç–µ—Å—Ç—ã (coverage > 90%)
3. –°–æ–∑–¥–∞–µ—Ç Pull Request —Å backend changes

### Phase 3: Frontend Implementation

1. Frontend team –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MSW mocks (—É–∂–µ –≤ Story 11.3)
2. –ü–æ—Å–ª–µ merge backend PR - –∑–∞–º–µ–Ω—è–µ—Ç MSW –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API
3. Integration testing

### Phase 4: Future Enhancement (Story 11.4)

**Token-based Unsubscribe (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production):**

1. **Backend:**
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `unsubscribe_token` –≤ Newsletter model (UUID)
   - –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ
   - –°–æ–∑–¥–∞—Ç—å GET endpoint: `/api/v1/unsubscribe/{token}/`
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ –ø–æ–ª–µ `unsubscribe_token`

2. **Email Templates:**
   - –í–∫–ª—é—á–∏—Ç—å —Å—Å—ã–ª–∫—É –æ—Ç–ø–∏—Å–∫–∏ –≤ footer –≤—Å–µ—Ö email
   - Format: `https://freesport.com/unsubscribe?token={token}`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ List-Unsubscribe header (RFC 8058)

3. **Frontend:**
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–ø–∏—Å–∫–∏ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ç–æ–∫–µ–Ω–∞ –∏–∑ URL
   - UX: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø–∏—Å–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ token-based:**
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- ‚úÖ One-click unsubscribe
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è email deliverability
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê: TypeScript Types –¥–ª—è Frontend

**–î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å frontend team:**

```typescript
// frontend/src/types/api.ts

// POST /api/v1/subscribe
export interface SubscribeRequest {
  email: string;
}

export interface SubscribeResponse {
  message: string;
  email: string;
}

export interface SubscribeError {
  email?: string[];
}

// POST /api/v1/unsubscribe
export interface UnsubscribeRequest {
  email: string;
}

export interface UnsubscribeResponse {
  message: string;
  email: string;
}

export interface UnsubscribeError {
  email?: string[];
}

// GET /api/v1/news
export interface NewsItem {
  id: number;
  title: string;
  slug: string;
  excerpt: string;
  content: string | null;
  image: string | null;
  published_at: string; // ISO date
  created_at: string;
  updated_at: string;
  author: string | null;
  category: string | null;
}

export interface NewsList {
  count: number;
  next: string | null;
  previous: string | null;
  results: NewsItem[];
}
```

---

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞**

**Status:** ‚úÖ Ready for Implementation
**Next Action:** –ü–µ—Ä–µ–¥–∞—Ç—å Dev Agent –¥–ª—è Phase 2: Backend Implementation
