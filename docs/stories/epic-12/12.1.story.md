# Story 12.1: Обновление дизайн-токенов

## Status

Draft

## Story

**As a** Frontend разработчик,
**I want** иметь обновленные design tokens (цвета, типографика, spacing, радиусы, тени) согласно Design System v2.0,
**so that** все компоненты и страницы FREESPORT использовали единообразный визуальный стиль новой дизайн-системы.

## Acceptance Criteria

1. Обновлен `docs/frontend/design-system.json` с новыми токенами v2.0:
   - Новая цветовая палитра (монохромная графитовая)
   - Обновленная типографика (Inter + новая шкала размеров)
   - 8 принципов дизайна
   - Обновленные spacing, радиусы, тени

2. Обновлена Tailwind CSS конфигурация в `frontend/src/app/globals.css`:
   - CSS переменные соответствуют новой палитре
   - Utility классы для типографики актуализированы
   - Добавлены недостающие токены из спецификации

3. Созданы CSS переменные для темизации:
   - Все цвета доступны через CSS custom properties
   - Поддержка переключения тем (light/dark в будущем)
   - Семантические токены (--bg-canvas, --bg-panel, --bg-emphasis)

4. Задокументирована миграция с v1.x на v2.0:
   - Mapping старых токенов на новые
   - Breaking changes с примерами
   - Рекомендации по обновлению существующих компонентов

5. Все новые токены проходят проверку доступности:
   - Контраст текста >= 4.5:1 (WCAG 2.1 AA)
   - Документированы рекомендации по использованию

## Tasks / Subtasks

- [ ] Task 1: Анализ текущего состояния design-system.json (AC: 1)
  - [ ] 1.1 Изучить существующую структуру `docs/frontend/design-system.json`
  - [ ] 1.2 Сравнить с требованиями `docs/front-end-spec.md` секция "Руководство по бренд-стилю"
  - [ ] 1.3 Составить список расхождений и необходимых изменений

- [ ] Task 2: Обновление цветовой палитры в design-system.json (AC: 1)
  - [ ] 2.1 Обновить primary цвета: #1F1F1F (default), #3A3A3A (hover), #0D0D0D (active), #F2F2F2 (subtle)
  - [ ] 2.2 Обновить secondary цвета: #3D3D3D → #1C1C1C
  - [ ] 2.3 Обновить accent цвета для статусов (success, warning, danger, promo)
  - [ ] 2.4 Обновить neutral шкалу 100-900
  - [ ] 2.5 Обновить text цвета: primary #1B1B1B, secondary #4D4D4D, muted #7A7A7A, inverse #FFFFFF
  - [ ] 2.6 Добавить typography colorUsage: #1F2A44, #4B5C7A, #7F8CA8, #FFFFFF

- [ ] Task 3: Обновление типографики в design-system.json (AC: 1)
  - [ ] 3.1 Обновить fontFamily: Inter, SF Pro Display, system fonts
  - [ ] 3.2 Обновить scales с правильными size/lineHeight/weight:
    - display-l: 48/56/700
    - display-m: 40/48/700
    - headline-l: 32/40/700
    - headline-m: 28/36/600
    - title-l: 24/32/600
    - title-m: 20/28/600
    - body-l: 18/28/500
    - body-m: 16/24/500
    - body-s: 14/20/500
    - caption: 12/16/500

- [ ] Task 4: Обновление spacing, радиусов и теней (AC: 1)
  - [ ] 4.1 Обновить spacing scale: [4, 8, 12, 16, 20, 24, 32, 40, 48, 56, 64]
  - [ ] 4.2 Обновить sectionSpacing: aboveFold 64px, default 48px, compact 32px
  - [ ] 4.3 Обновить componentSpacing: cardGap 16px, listItemGap 12px, formVertical 16px
  - [ ] 4.4 Обновить radius: sm 6px, default 12px, md 16px, lg 20px, xl 24px, full 9999px
  - [ ] 4.5 Обновить shadows с новыми значениями rgba

- [ ] Task 5: Обновление Tailwind CSS в globals.css (AC: 2)
  - [ ] 5.1 Синхронизировать все CSS переменные с design-system.json
  - [ ] 5.2 Добавить недостающие typography colorUsage переменные
  - [ ] 5.3 Добавить переменные для backgrounds: --bg-canvas, --bg-panel, --bg-emphasis
  - [ ] 5.4 Проверить и обновить utility классы для типографики
  - [ ] 5.5 Добавить motion/easing переменные если отсутствуют

- [ ] Task 6: Создание CSS переменных для темизации (AC: 3)
  - [ ] 6.1 Создать семантические CSS переменные для цветов
  - [ ] 6.2 Добавить :root переменные для backgrounds
  - [ ] 6.3 Подготовить структуру для будущей dark theme (комментарии)

- [ ] Task 7: Документирование миграции v1.x → v2.0 (AC: 4)
  - [ ] 7.1 Создать файл `docs/frontend/design-system-migration-v2.md`
  - [ ] 7.2 Описать mapping старых токенов на новые
  - [ ] 7.3 Список breaking changes с примерами кода
  - [ ] 7.4 Рекомендации по обновлению компонентов

- [ ] Task 8: Проверка доступности (AC: 5)
  - [ ] 8.1 Проверить контраст text-primary на neutral-100 (>= 4.5:1)
  - [ ] 8.2 Проверить контраст text-secondary на neutral-100
  - [ ] 8.3 Проверить контраст text-inverse на primary
  - [ ] 8.4 Документировать результаты проверки в migration guide

- [ ] Task 9: Тестирование обновленных токенов (AC: 1, 2)
  - [ ] 9.1 Проверить что globals.css корректно импортируется
  - [ ] 9.2 Создать простой тест для проверки CSS переменных
  - [ ] 9.3 Визуально проверить применение токенов в dev режиме
  - [ ] 9.4 Убедиться что существующие компоненты не сломались

## Dev Notes

### Текущее состояние (Source: frontend/src/app/globals.css)

Globals.css уже содержит базовую структуру Tailwind CSS 4.0 с @theme inline блоком. Цветовые токены частично соответствуют v2.0, но требуется:
- Добавить typography colorUsage переменные (#1F2A44, #4B5C7A, #7F8CA8)
- Добавить background переменные (--bg-canvas, --bg-panel, --bg-emphasis)
- Синхронизировать с полной спецификацией из front-end-spec.md

### Design System JSON (Source: docs/frontend/design-system.json)

Текущий design-system.json содержит устаревшие значения:
- primary default показан как #0060FF в некоторых местах (должен быть #1F1F1F)
- Смешаны старые и новые цвета
- Требуется полная синхронизация с секцией "Руководство по бренд-стилю" из front-end-spec.md

### Ключевые изменения v2.0 (Source: docs/front-end-spec.md#руководство-по-бренд-стилю)

**Цветовая палитра - монохромная графитовая:**
```scss
// Primary
$primary-default: #1F1F1F;  // Главный акцент (НЕ синий!)
$primary-hover: #3A3A3A;
$primary-active: #0D0D0D;
$primary-subtle: #F2F2F2;

// Акцентные цвета для статусов
$accent-success: #4D4D4D;
$accent-warning: #6A6A6A;
$accent-danger: #2B2B2B;
$accent-promo: #8A8A8A;
```

**Типографика:**
- Font family: Inter, SF Pro Display, system fonts
- 10 уровней шкалы от display-l (48px) до caption (12px)
- Все weights: 500-700

**Spacing:**
- Базовый шаг 4px
- Вертикальный ритм кратен 8px
- Контентные отступы 24px

**Радиусы:**
- sm: 6px (кнопки, поля ввода)
- default: 12px (карточки)
- full: 9999px (бейджи)

### File Locations (Source: docs/architecture/source-tree.md)

```
docs/
└── frontend/
    ├── design-system.json           # Основной файл токенов (обновить)
    └── design-system-migration-v2.md  # Создать новый файл

frontend/
└── src/
    └── app/
        └── globals.css              # Tailwind CSS 4.0 токены (обновить)
```

### 8 принципов дизайна v2.0 (Source: docs/front-end-spec.md)

1. Абсолютный приоритет удобству и быстроте выбора товара
2. Оптика легкости: много белого пространства, мягкие тени
3. Чистая модульность: 8-пиксельная сетка
4. Единая визуальная иерархия: графитовые акценты, тёмный текст
5. Обязательная адаптивность: desktop-first
6. Интерактивные состояния: цвет и лёгкая анимация
7. CTA с мягкими радиусами
8. Карточки: крупные фото, разнесённые данные

### Technical Constraints

- **Tailwind CSS 4.0**: Использовать @theme inline синтаксис (не tailwind.config.js)
- **CSS Custom Properties**: Все токены должны быть доступны как CSS переменные
- **No breaking imports**: Существующие компоненты должны продолжать работать
- **TypeScript**: Токены могут потребовать обновления типов если есть type definitions

### Testing

**Test file location:** `frontend/src/__tests__/design-system/`

**Testing frameworks:**
- Vitest 2.1.5 для unit тестов
- @testing-library/react 16.3.0 для компонентных тестов

**Test standards:**
- Проверить что CSS переменные определены корректно
- Визуальная проверка токенов в браузере
- Убедиться что globals.css импортируется без ошибок

**Coverage requirements:**
- Минимум 70% покрытие для новых файлов

## Change Log

| Date       | Version | Description                              | Author       |
|------------|---------|------------------------------------------|--------------|
| 2025-11-19 | 1.0     | Создание story на основе Epic 12.1       | Bob (SM)     |
| 2025-11-19 | 1.1     | Обновлены пути файлов согласно новой структуре docs/frontend/ | Sarah (PO) |

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes List

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_To be filled by QA agent_
