# Story 16.2: –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞

## Status
Done

## Story

**As a** –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å FREESPORT (B2B –∏–ª–∏ B2C),
**I want** –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–≤–æ–∏—Ö –∑–∞–∫–∞–∑–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–∫–∞–∑,
**so that** —è –º–æ–≥—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ –ø–æ–∫—É–ø–∫–∏ –∏ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∑–∞‚Äã–∫–∞–∑—ã–≤–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã

## Acceptance Criteria

1. –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (20 –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
2. –ö–ª–∏–∫ –ø–æ –∑–∞–∫–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
3. –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —Å—Ç–∞—Ç—É—Å—É: –≤—Å–µ, –Ω–æ–≤—ã–π, –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –¥–æ—Å—Ç–∞–≤–ª–µ–Ω, –æ—Ç–º–µ–Ω—ë–Ω)
4. –ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑" –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
5. –î–ª—è –∑–∞–∫–∞–∑–æ–≤ —Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
6. –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç PDF –¥–æ–∫—É–º–µ–Ω—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è B2B –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
7. E2E —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–æ—É –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞

## Tasks / Subtasks

### Task 1: –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤ `/profile/orders` (AC: 1, 2, 3)
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/app/(profile)/orders/page.tsx`
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSR –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
  - [x] –ü–æ–¥–∫–ª—é—á–∏—Ç—å `authStore` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API `GET /api/v1/orders/` —á–µ—Ä–µ–∑ axios
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `OrdersList` —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –ø–∞–≥–∏–Ω–∞—Ü–∏—é (page_size=20)
  - [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞, –¥–∞—Ç–∞, —Å—É–º–º–∞, —Å—Ç–∞—Ç—É—Å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
  - [x] –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –∑–∞–∫–∞–∑–∞ –≤–µ–¥—ë—Ç –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É `/profile/orders/[id]`
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Å—Ç–∞—Ç—É—Å—É –∑–∞–∫–∞–∑–∞ (AC: 3)
  - [x] –¢–∞–±—ã/dropdown –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç–∞—Ç—É—Å–∞: –≤—Å–µ, pending, processing, shipped, delivered, cancelled
  - [x] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (CSR –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useSearchParams()` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å URL
- [x] –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ Design System
  - [x] –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞: Card –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (radius 16px, padding 24px, shadow default)
  - [x] –ë–µ–π–¥–∂–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤: Badge –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å —Ü–≤–µ—Ç–∞–º–∏ –∏–∑ accent (success, warning, danger)
  - [x] Responsive layout: grid –Ω–∞ desktop, stack –Ω–∞ mobile

### Task 2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞ `/profile/orders/[id]` (AC: 2)
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/app/(profile)/orders/[id]/page.tsx`
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSR –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞
  - [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API `GET /api/v1/orders/{id}/` —á–µ—Ä–µ–∑ axios
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã (403 –µ—Å–ª–∏ —á—É–∂–æ–π)
- [x] –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `OrderDetail`
  - [x] –°–µ–∫—Ü–∏—è 1: –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–Ω–æ–º–µ—Ä, –¥–∞—Ç–∞, —Å—Ç–∞—Ç—É—Å, —Å—É–º–º–∞)
  - [x] –°–µ–∫—Ü–∏—è 2: –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ (product_name, quantity, unit_price, total_price)
  - [x] –°–µ–∫—Ü–∏—è 3: –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (shipping_address –∏–∑ JSON –ø–æ–ª—è)
  - [x] –°–µ–∫—Ü–∏—è 4: –ü–ª–∞—Ç—ë–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (payment_method, payment_status)
  - [x] –°–µ–∫—Ü–∏—è 5: –î–µ–π—Å—Ç–≤–∏—è (–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑, –≠–∫—Å–ø–æ—Ä—Ç PDF –¥–ª—è B2B)
- [x] –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ Design System
  - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Cards –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π
  - [x] Typography: title-m –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å–µ–∫—Ü–∏–π, body-m –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
  - [x] –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤: body-s –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏–π, body-m –¥–ª—è —Ü–µ–Ω

### Task 3: –§—É–Ω–∫—Ü–∏—è "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑" (AC: 4, 5)
- [x] –°–æ–∑–¥–∞—Ç—å –º–µ—Ç–æ–¥ `handleRepeatOrder` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `OrderDetail`
  - [x] –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∑–∞–∫–∞–∑–∞ (OrderItem[])
  - [x] –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `is_available` (–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å)
  - [x] –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É —á–µ—Ä–µ–∑ `cartStore.addItem()`
  - [x] –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `cartStore` (Zustand)
  - [x] –í—ã–∑–≤–∞—Ç—å `cartStore.addItems()` –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
  - [x] –û–±–Ω–æ–≤–∏—Ç—å UI –∫–æ—Ä–∑–∏–Ω—ã (–∏–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –≤ header –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—á—ë—Ç—á–∏–∫)
  - [x] –ü–æ–∫–∞–∑–∞—Ç—å Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –æ–ø–µ—Ä–∞—Ü–∏–∏
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (AC: 5)
  - [x] –£—Å–ø–µ—à–Ω–æ: "–í—Å–µ —Ç–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ—Ä–∑–∏–Ω—É (X —à—Ç.)" (Toast success)
  - [x] –ß–∞—Å—Ç–∏—á–Ω–æ: "–î–æ–±–∞–≤–ª–µ–Ω–æ X –∏–∑ Y —Ç–æ–≤–∞—Ä–æ–≤. Z —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã." (Toast warning —Å –¥–µ—Ç–∞–ª—è–º–∏)
  - [x] –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ: "–í—Å–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∑–∞–∫–∞–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞" (Toast danger)
- [x] UI –∫–Ω–æ–ø–∫–∏ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑"
  - [x] Button primary: "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑"
  - [x] Icon: ShoppingCart (lucide-react)
  - [x] Loading state –ø–æ–∫–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É
  - [x] Disabled state –µ—Å–ª–∏ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

### Task 4: –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–∞ –≤ PDF (—Ç–æ–ª—å–∫–æ –¥–ª—è B2B) (AC: 6)
- [x] –°–æ–∑–¥–∞—Ç—å –º–µ—Ç–æ–¥ `handleExportPDF` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `OrderDetail`
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è is_b2b_user === true
  - [x] –í—ã–∑–æ–≤ API endpoint `GET /api/v1/orders/{id}/export-pdf/` (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
  - [x] –ò–õ–ò –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, jsPDF –∏–ª–∏ react-pdf)
- [x] –£—Å–ª–æ–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
  - [x] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `user.is_b2b_user === true`
  - [x] Button secondary: "–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF"
  - [x] Icon: Download (lucide-react)
- [ ] –§–æ—Ä–º–∞—Ç PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è) - *–∑–∞–≥–ª—É—à–∫–∞, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–æ–∂–µ–Ω–∞*
  - [ ] –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ó–∞–∫–∞–∑ ‚Ññ{order_number}"
  - [ ] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ (company_name, tax_id)
  - [ ] –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –∞—Ä—Ç–∏–∫—É–ª, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Ü–µ–Ω–∞, —Å—É–º–º–∞)
  - [ ] –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞
  - [ ] –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞

### Task 5: Unit-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (AC: 7)
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/components/business/OrderStatusBadge/OrderStatusBadge.test.tsx`
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/components/business/OrderCard/OrderCard.test.tsx`
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/components/business/OrdersList/OrdersList.test.tsx`
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/src/components/business/OrderDetail/OrderDetail.test.tsx`
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MSW –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤
  - [x] Setup handlers –≤ `frontend/src/__mocks__/handlers/ordersHandlers.ts`
  - [x] Mock responses –¥–ª—è GET /api/v1/orders/ –∏ GET /api/v1/orders/{id}/
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >= 80%
  - [ ] –ö–æ–º–∞–Ω–¥–∞: `npm run test:coverage`

### Task 6: E2E —Ç–µ—Å—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–ª–æ—É –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ (AC: 7)
- [x] –°–æ–∑–¥–∞—Ç—å `frontend/e2e/profile/repeat-order.spec.ts` (Playwright)
  - [x] –¢–µ—Å—Ç: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ –∑–∞–∫–∞–∑—ã ‚Üí –≤—ã–±–æ—Ä –∑–∞–∫–∞–∑–∞ ‚Üí –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
  - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è —Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏

## Dev Notes

### Previous Story Insights

**–ò–∑ Story 16.1 (Layout –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è):**

Story 16.1 —Å–æ–∑–¥–∞—ë—Ç –±–∞–∑–æ–≤—ã–π layout –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è. Story 16.2 —è–≤–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ layout `(profile)/layout.tsx` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞–∫–∞–∑–æ–≤.

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ Story 16.1, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**
- `ProfileLayout` (layout.tsx) —Å –±–æ–∫–æ–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
- `authStore` (Zustand) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `middleware.ts` –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ `/profile/*`
- Axios interceptors –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤
- Toast –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–ù–∞–≤–∏–≥–∞—Ü–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞:**
```typescript
const navigationItems = [
  { label: '–ü—Ä–æ—Ñ–∏–ª—å', href: '/profile', icon: 'User' },
  { label: '–ó–∞–∫–∞–∑—ã', href: '/profile/orders', icon: 'ShoppingBag' },  // <- Story 16.2
  { label: '–ê–¥—Ä–µ—Å–∞', href: '/profile/addresses', icon: 'MapPin' },
  { label: '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ', href: '/profile/favorites', icon: 'Heart' }
];
```

### API Specifications

[Source: docs/architecture/03-api-specification.md]

**Orders Endpoints:**

`GET /api/v1/orders/`
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: JWT Bearer Token (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞)
- Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `status`: —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (pending, processing, shipped, delivered, cancelled)
  - `page`: –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (default: 1)
  - `page_size`: —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (default: 20, max: 100)
- Response 200:
  ```typescript
  {
    count: number;
    next: string | null;
    previous: string | null;
    results: Order[];
  }
  ```
- Response 401: Unauthorized

`GET /api/v1/orders/{id}/`
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: JWT Bearer Token (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞)
- Path –ø–∞—Ä–∞–º–µ—Ç—Ä: `id` - ID –∑–∞–∫–∞–∑–∞
- Response 200: Order –æ–±—ä–µ–∫—Ç (—Å–º. Data Models –Ω–∏–∂–µ)
- Response 401: Unauthorized
- Response 403: Forbidden (–Ω–µ –≤–∞—à –∑–∞–∫–∞–∑)
- Response 404: Not Found

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ endpoints (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã):**

`GET /api/v1/orders/{id}/export-pdf/`
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: JWT Bearer Token
- –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è B2B –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Response 200: PDF file (application/pdf)
- Response 403: Forbidden (–Ω–µ B2B –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

### Data Models

**Order Model:** [Source: docs/architecture/02-data-models.md]

```typescript
interface Order {
  id: number;
  order_number: string;        // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
  user: number;                 // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (FK)

  // –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
  status: 'draft' | 'pending' | 'processing' | 'shipped' | 'delivered' | 'cancelled' | 'returned';

  // –°—É–º–º—ã –∑–∞–∫–∞–∑–∞
  subtotal: string;             // Decimal (—Å—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –Ω–∞–ª–æ–≥–æ–≤ –∏ –¥–æ—Å—Ç–∞–≤–∫–∏)
  tax_amount: string;           // Decimal (–ù–î–°)
  shipping_cost: string;        // Decimal (—Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏)
  discount_amount: string;      // Decimal (—Å–∫–∏–¥–∫–∞)
  total_amount: string;         // Decimal (–∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞)

  // –ê–¥—Ä–µ—Å–∞ –∏ –ø–ª–∞—Ç—ë–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  shipping_address: {           // JSON –ø–æ–ª–µ
    full_name: string;
    phone: string;
    city: string;
    street: string;
    building: string;
    apartment?: string;
    postal_code: string;
  };
  billing_address?: object;     // JSON –ø–æ–ª–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  payment_method: string;
  payment_status: 'pending' | 'paid' | 'failed' | 'refunded';

  // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°
  onec_id?: string;             // ID –∑–∞–∫–∞–∑–∞ –≤ 1–°
  exported_to_1c: boolean;      // –§–ª–∞–≥ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ 1–°
  export_to_1c_at?: string;     // ISO datetime
  last_sync_from_1c?: string;   // ISO datetime

  // –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è
  created_at: string;           // ISO datetime
  updated_at: string;           // ISO datetime

  // Relations (expanded –≤ API responses)
  items?: OrderItem[];          // –¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ
}
```

**OrderItem Model:** [Source: docs/architecture/02-data-models.md]

```typescript
interface OrderItem {
  id: number;
  order: number;                // FK to Order
  product: number;              // FK to Product

  // –°–Ω–∏–º–æ–∫ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–∫–∞–∑–∞
  product_name: string;
  product_article: string;      // –ê—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞
  product_specifications: object; // JSON (—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞)

  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ü–µ–Ω—ã
  quantity: number;
  unit_price: string;           // Decimal (—Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–∫–∞–∑–∞)
  total_price: string;          // Decimal (quantity * unit_price)

  // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°
  onec_product_id?: string;     // ID —Ç–æ–≤–∞—Ä–∞ –≤ 1–°
}
```

**Product Model (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏):** [Source: docs/architecture/02-data-models.md]

```typescript
interface Product {
  id: number;
  name: string;
  sku: string;                  // –ê—Ä—Ç–∏–∫—É–ª

  // –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
  stock_quantity: number;       // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ
  reserved_quantity: number;    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –∫–æ—Ä–∑–∏–Ω–∞—Ö
  available_quantity: number;   // stock_quantity - reserved_quantity (computed)
  is_available: boolean;        // is_active && available_quantity > 0 (computed)
  is_active: boolean;           // –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞

  // –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  retail_price: string;
  current_user_price?: string;  // –¶–µ–Ω–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–æ–ª–∏)
}
```

### Component Specifications

**OrdersList Component:** [Source: docs/architecture/04-component-structure.md + design-system.json]

–§–∞–π–ª: `frontend/src/components/business/OrdersList/OrdersList.tsx`

```typescript
interface OrdersListProps {
  orders: Order[];
  currentPage: number;
  totalPages: number;
  onPageChange: (page: number) => void;
  onOrderClick: (orderId: number) => void;
}

const OrdersList: React.FC<OrdersListProps> = ({
  orders,
  currentPage,
  totalPages,
  onPageChange,
  onOrderClick
}) => {
  // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫
  // Desktop: grid 2 –∫–æ–ª–æ–Ω–∫–∏, Mobile: stack
  // –ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞: Order Card —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
}
```

**OrderCard Component:**

```typescript
interface OrderCardProps {
  order: Order;
  onClick: () => void;
}

const OrderCard: React.FC<OrderCardProps> = ({ order, onClick }) => {
  // –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞:
  // - –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ (title-m)
  // - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (body-s, muted)
  // - –°—Ç–∞—Ç—É—Å (Badge –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
  // - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ (body-s)
  // - –°—É–º–º–∞ (title-m, bold)
  // - –ö–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è, –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ /profile/orders/[id]
}
```

**OrderDetail Component:**

–§–∞–π–ª: `frontend/src/components/business/OrderDetail/OrderDetail.tsx`

```typescript
interface OrderDetailProps {
  order: Order;
  onRepeatOrder: () => void;
  onExportPDF?: () => void;
  isB2BUser: boolean;
}

const OrderDetail: React.FC<OrderDetailProps> = ({
  order,
  onRepeatOrder,
  onExportPDF,
  isB2BUser
}) => {
  // –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–µ–∫—Ü–∏–∏
}
```

**StatusBadge Component:**

```typescript
interface StatusBadgeProps {
  status: Order['status'];
}

const StatusBadge: React.FC<StatusBadgeProps> = ({ status }) => {
  const badgeConfig = {
    draft: { bg: 'neutral-200', text: 'neutral-700', label: '–ß–µ—Ä–Ω–æ–≤–∏–∫' },
    pending: { bg: 'warningBg', text: 'warning', label: '–û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏' },
    processing: { bg: 'primary.subtle', text: 'primary.default', label: '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ' },
    shipped: { bg: 'secondary.subtle', text: 'secondary.default', label: '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' },
    delivered: { bg: 'successBg', text: 'success', label: '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' },
    cancelled: { bg: 'dangerBg', text: 'danger', label: '–û—Ç–º–µ–Ω—ë–Ω' },
    returned: { bg: 'neutral-300', text: 'neutral-700', label: '–í–æ–∑–≤—Ä–∞—â—ë–Ω' }
  };

  const config = badgeConfig[status];

  return (
    <Badge bg={config.bg} textColor={config.text}>
      {config.label}
    </Badge>
  );
}
```

### File Locations

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:** [Source: docs/architecture/source-tree.md]

```
frontend/src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ (profile)/                       # Route group –¥–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–∏–∑ Story 16.1)
‚îÇ       ‚îú‚îÄ‚îÄ layout.tsx                   # ProfileLayout (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îÇ       ‚îú‚îÄ‚îÄ orders/                      # <- Story 16.2
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                 # –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ [id]/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx             # –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ __tests__/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ page.test.tsx        # –¢–µ—Å—Ç—ã —Å–ø–∏—Å–∫–∞
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ [id].test.tsx        # –¢–µ—Å—Ç—ã –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ business/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OrdersList/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OrdersList.tsx           # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OrdersList.test.tsx      # –¢–µ—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OrderCard.tsx            # –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OrderCard.test.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OrderDetail/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ OrderDetail.tsx          # –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ OrderDetail.test.tsx     # –¢–µ—Å—Ç—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ OrderItemsTable.tsx      # –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ StatusBadge.tsx          # –ë–µ–π–¥–∂ —Å—Ç–∞—Ç—É—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ ui/
‚îÇ       ‚îú‚îÄ‚îÄ Badge/                       # –ï—Å–ª–∏ –µ—â—ë –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ Badge.tsx
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Badge.test.tsx
‚îÇ       ‚îî‚îÄ‚îÄ Pagination/                  # –ï—Å–ª–∏ –µ—â—ë –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚îÇ           ‚îú‚îÄ‚îÄ Pagination.tsx
‚îÇ           ‚îî‚îÄ‚îÄ Pagination.test.tsx
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ orderService.ts                  # API —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
‚îú‚îÄ‚îÄ stores/
‚îÇ   ‚îú‚îÄ‚îÄ cartStore.ts                     # Zustand store (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îÇ   ‚îî‚îÄ‚îÄ orderStore.ts                    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ order.ts                         # TypeScript —Ç–∏–ø—ã –¥–ª—è Order, OrderItem
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ orderHelpers.ts                  # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–∫–∞–∑–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ pdfGenerator.ts                  # –£—Ç–∏–ª–∏—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF (–µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
‚îî‚îÄ‚îÄ __mocks__/
    ‚îî‚îÄ‚îÄ handlers.ts                      # MSW handlers –¥–ª—è API mocking
```

**E2E —Ç–µ—Å—Ç—ã:**
```
frontend/e2e/
‚îî‚îÄ‚îÄ profile/
    ‚îú‚îÄ‚îÄ orders-list.spec.ts              # E2E —Ç–µ—Å—Ç—ã —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
    ‚îî‚îÄ‚îÄ repeat-order.spec.ts             # E2E —Ç–µ—Å—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ (AC: 7)
```

### Testing Requirements

**Framework:** [Source: docs/architecture/10-testing-strategy.md]

- **Vitest 2.1.5** - —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–∞–Ω–Ω–µ—Ä
- **@testing-library/react 16.3.0** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **@testing-library/user-event 14.5.1** - —Å–∏–º—É–ª—è—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **MSW 2.12.2** - –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤
- **@vitest/coverage-v8 2.1.5** - –æ—Ç—á—ë—Ç—ã –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
- **Playwright** - E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:** [Source: docs/architecture/10-testing-strategy.md#frontend-tests]

–¢–µ—Å—Ç—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Ä—è–¥–æ–º —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:
```
component.tsx
component.test.tsx
```

**AAA Pattern (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):**
```typescript
describe('OrderDetail', () => {
  it('adds all available products to cart when repeat order is clicked', async () => {
    // ARRANGE - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    const mockOrder = {
      id: 1,
      order_number: 'ORD-2025-001',
      items: [
        { product: 1, product_name: 'Product 1', quantity: 2, unit_price: '100' },
        { product: 2, product_name: 'Product 2', quantity: 1, unit_price: '200' }
      ]
    };

    const mockCartStore = {
      addItems: vi.fn()
    };

    server.use(
      rest.get('/api/v1/orders/1/', (req, res, ctx) =>
        res(ctx.json(mockOrder))
      )
    );

    // ACT - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    render(<OrderDetail order={mockOrder} onRepeatOrder={mockCartStore.addItems} />);

    const repeatButton = screen.getByRole('button', { name: /–ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑/i });
    await userEvent.click(repeatButton);

    // ASSERT - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    await waitFor(() => {
      expect(mockCartStore.addItems).toHaveBeenCalledWith([
        { productId: 1, quantity: 2 },
        { productId: 2, quantity: 1 }
      ]);
    });

    expect(screen.getByText(/–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É/i)).toBeInTheDocument();
  });
});
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–∫—Ä—ã—Ç–∏—é:**
- –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: >= 80%
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (OrderDetail, OrdersList): >= 90%

**–ö–æ–º–∞–Ω–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```bash
npm run test               # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
npm run test:watch         # Watch mode
npm run test:coverage      # –° –æ—Ç—á—ë—Ç–æ–º –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
npm run test:ui            # UI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Vitest
```

### Technical Constraints

**Next.js App Router:** [Source: docs/architecture/tech-stack.md]
- –í–µ—Ä—Å–∏—è: 15.4.6
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è App Router (–Ω–µ Pages Router)
- SSR –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- CSR –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (—Ñ–∏–ª—å—Ç—Ä—ã, –ø–∞–≥–∏–Ω–∞—Ü–∏—è)

**State Management:** [Source: docs/architecture/tech-stack.md]
- Zustand 4.5.7 –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `cartStore` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ—Ä–∑–∏–Ω–æ–π
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ cartStore:
```typescript
interface CartState {
  items: CartItem[];
  addItem: (productId: number, quantity: number) => void;
  addItems: (items: { productId: number; quantity: number }[]) => void; // –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞
  removeItem: (productId: number) => void;
  clearCart: () => void;
  totalAmount: number;
  totalItems: number;
}
```

**Axios Configuration:** [Source: docs/architecture/coding-standards.md]
- Axios 1.11.0 –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- Interceptors –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤
- Timeout: 10 —Å–µ–∫—É–Ω–¥
- Base URL: `/api/v1/`

**Styling:** [Source: docs/architecture/tech-stack.md + design-system.json]
- Tailwind CSS 4.0
- Design tokens –∏–∑ design-system.json
- Mobile-first responsive –¥–∏–∑–∞–π–Ω
- Breakpoints: mobile (640px), tablet (1024px), desktop (1440px)

### Design System Tokens

**–ò–∑ `design-system.json`:** [Source: docs/frontend/design-system.json]

**Colors:**
```javascript
primary: {
  default: '#0060FF',
  hover: '#0047CC',
  active: '#0037A6',
  subtle: '#E7F3FF'
}

secondary: {
  default: '#00B7FF',
  hover: '#0095D6',
  active: '#0078B3',
  subtle: '#E1F5FF'
}

accent: {
  success: '#00AA5B',
  successBg: '#E0F5E8',
  warning: '#F5A623',
  warningBg: '#FFF1CC',
  danger: '#E53935',
  dangerBg: '#FFE1E8'
}

neutral: {
  100: '#FFFFFF',
  200: '#F5F7FB',
  300: '#E3E8F2',
  400: '#B9C3D6',
  700: '#4B5C7A',
  900: '#1F2A44'
}

text: {
  primary: '#1F2A44',
  secondary: '#4B5C7A',
  muted: '#7F8CA8',
  inverse: '#FFFFFF'
}
```

**Typography:**
```javascript
title-m: { size: 20px, lineHeight: 28px, weight: 600 }
body-m: { size: 16px, lineHeight: 24px, weight: 500 }
body-s: { size: 14px, lineHeight: 20px, weight: 500 }
caption: { size: 12px, lineHeight: 16px, weight: 500 }
```

**Component Specs:**

Card:
- Radius: 16px (md)
- Padding: 24px
- Shadow: `0 8px 24px rgba(15, 23, 42, 0.08)`
- Hover: `0 10px 32px rgba(15, 23, 42, 0.12)`

Button Primary:
- Background: #0060FF
- Hover: #0047CC
- Height: 40px
- Radius: 6px (sm)
- Padding: 24px horizontal

Button Secondary:
- Background: #00B7FF
- Hover: #0095D6
- Same dimensions as primary

Badge:
- Radius: full (9999px)
- Padding: 4px 12px
- Font size: caption (12px)
- –í–∞—Ä–∏–∞–Ω—Ç—ã —Ü–≤–µ—Ç–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç–∞—Ç—É—Å—É (—Å–º. StatusBadge Component)

Toast:
- Success: bg #E0F5E8, border #00AA5B, icon CheckCircle
- Warning: bg #FFF1CC, border #F5A623, icon AlertTriangle
- Error/Danger: bg #FFE1E8, border #E53935, icon XCircle
- Radius: 12px
- Shadow: `0 8px 24px rgba(15, 23, 42, 0.12)`
- Auto-dismiss: 5000ms

Pagination:
- Button size: 32px x 32px
- Gap: 8px
- Active page: primary color
- Hover: subtle background

### Security Considerations

**JWT Handling:** [Source: docs/architecture/11-security-performance.md]

- –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ httpOnly cookies (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ) –∏–ª–∏ localStorage
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π refresh –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ interceptor
- Logout –¥–æ–ª–∂–µ–Ω –æ—á–∏—â–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ /login

**Authorization:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã
- API –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 403 Forbidden –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–∂–æ–º—É –∑–∞–∫–∞–∑—É
- Frontend —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `order.user === currentUser.id` –ø–µ—Ä–µ–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

**Input Validation:** [Source: docs/architecture/coding-standards.md]

- –í–∞–ª–∏–¥–∞—Ü–∏—è ID –∑–∞–∫–∞–∑–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (status, page)

### Performance Considerations

**SSR –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:** [Source: docs/architecture/tech-stack.md]

Next.js App Router:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Server Components –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Fetch –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ –ø–µ—Ä–≤–∏—á–Ω–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
- CSR —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (—Ñ–∏–ª—å—Ç—Ä—ã, –ø–∞–≥–∏–Ω–∞—Ü–∏—è)

**Pagination Strategy:**

- –°–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è (page_size=20) –¥–ª—è —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—Å–ø–∏—Å–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º)
- Lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –≤ OrderDetail

**Optimistic UI:**

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–∫–∞–∑):
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å loading —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
- –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã
- –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ—Å–ª–∏ API –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- –ö—ç—à —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ Zustand store (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞
- Next.js ISR –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º –º–∞—Ä—à—Ä—É—Ç–∞–º

### Project Structure Notes

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º layout:** [Source: Story 16.1]

Story 16.2 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π `ProfileLayout` –∏–∑ Story 16.1:
- Layout –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `app/(profile)/layout.tsx`
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç —Å—Å—ã–ª–∫—É "–ó–∞–∫–∞–∑—ã" ‚Üí `/profile/orders`
- Middleware –∑–∞—â–∏—â–∞–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã `/profile/*`

**cartStore –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** [Source: —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ + docs/architecture/tech-stack.md]

Store —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `frontend/src/stores/cartStore.ts`. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã:
- `useCartStore(state => state.addItems)` - –¥–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤
- `useCartStore(state => state.totalItems)` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
- `useCartStore(state => state.items)` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤

–ï—Å–ª–∏ –º–µ—Ç–æ–¥ `addItems` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å:
```typescript
addItems: (items: { productId: number; quantity: number }[]) => {
  set((state) => {
    const newItems = [...state.items];

    items.forEach(({ productId, quantity }) => {
      const existingItem = newItems.find(item => item.productId === productId);

      if (existingItem) {
        existingItem.quantity += quantity;
      } else {
        newItems.push({ productId, quantity, price: 0 }); // price –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞
      }
    });

    return { items: newItems };
  });
}
```

**authStore –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** [Source: Story 16.1]

Store —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `frontend/src/stores/authStore.ts`. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã:
- `useAuthStore(state => state.user)` - –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `useAuthStore(state => state.user?.is_b2b_user)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ B2B –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### Additional Implementation Details

**–§—É–Ω–∫—Ü–∏—è "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑" - –¥–µ—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**

1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∑–∞–∫–∞–∑–∞ (`order.items`)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞:
   - –ù–∞–π—Ç–∏ —Ç–µ–∫—É—â–∏–π Product –ø–æ `item.product` ID
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `product.is_available`
   - –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
   - –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö
3. –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:
   - –í—ã–∑–≤–∞—Ç—å `cartStore.addItems(availableItems)`
   - –ü–æ–∫–∞–∑–∞—Ç—å Toast success: "–î–æ–±–∞–≤–ª–µ–Ω–æ X —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É"
4. –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:
   - –ü–æ–∫–∞–∑–∞—Ç—å Toast warning —Å –¥–µ—Ç–∞–ª—è–º–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
   - –ü—Ä–∏–º–µ—Ä: "–¢–æ–≤–∞—Ä—ã 'Product A', 'Product B' –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"
5. –ï—Å–ª–∏ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã:
   - –ü–æ–∫–∞–∑–∞—Ç—å Toast error: "–í—Å–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∑–∞–∫–∞–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"
   - –ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑" disabled

**–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF - —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (MVP):**

–î–ª—è MVP –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF —Å –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `jspdf` –∏–ª–∏ `react-pdf`
- –§–æ—Ä–º–∞—Ç: A4, –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ:
  - –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ó–∞–∫–∞–∑ ‚Ññ{order_number}"
  - –î–∞—Ç–∞: {created_at}
  - –ö–æ–º–ø–∞–Ω–∏—è: {user.company_name}, –ò–ù–ù: {user.tax_id}
  - –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –∞—Ä—Ç–∏–∫—É–ª, –∫–æ–ª-–≤–æ, —Ü–µ–Ω–∞, —Å—É–º–º–∞)
  - –ò—Ç–æ–≥–æ: {total_amount}

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF:
- –°–æ–∑–¥–∞—Ç—å backend endpoint `GET /api/v1/orders/{id}/export-pdf/`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `reportlab` (Python) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF
- –í–µ—Ä–Ω—É—Ç—å PDF —Ñ–∞–π–ª —Å `Content-Type: application/pdf`

## Testing

### Testing Standards

[Source: docs/architecture/10-testing-strategy.md]

**Test File Location:**
- Component tests: —Ä—è–¥–æ–º —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º (`component.test.tsx`)
- Page tests: –≤ `__tests__` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`app/orders/__tests__/page.test.tsx`)

**Test Frameworks:**
- Vitest 2.1.5 (test runner)
- React Testing Library 16.3.0 (component testing)
- MSW 2.12.2 (API mocking)
- @vitest/coverage-v8 2.1.5 (coverage reports)
- Playwright (E2E testing)

**Test Patterns:**
- AAA Pattern (Arrange, Act, Assert)
- Meaningful test names: `test_[action]_[expected_result]()`
- Mock external dependencies (API calls via MSW)

**Coverage Requirements:**
- Overall: >= 80%
- Critical components (OrderDetail, OrdersList): >= 90%

**Commands:**
```bash
npm run test               # Run all tests
npm run test:watch         # Watch mode
npm run test:coverage      # With coverage report
npm run test:ui            # Vitest UI interface

# E2E tests
npx playwright test        # Run all E2E tests
npx playwright test --ui   # Run E2E tests with UI
```

**Example Test Structure:**
```typescript
describe('OrdersList', () => {
  beforeEach(() => {
    // Setup MSW handlers
    server.use(
      rest.get('/api/v1/orders/', (req, res, ctx) => {
        return res(ctx.json({
          count: 50,
          next: '/api/v1/orders/?page=2',
          previous: null,
          results: mockOrders
        }));
      })
    );
  });

  it('displays paginated list of orders', async () => {
    // ARRANGE
    const mockOrders = [
      {
        id: 1,
        order_number: 'ORD-2025-001',
        status: 'delivered',
        total_amount: '5000.00',
        created_at: '2025-01-15T10:00:00Z',
        items: []
      },
      {
        id: 2,
        order_number: 'ORD-2025-002',
        status: 'processing',
        total_amount: '3000.00',
        created_at: '2025-01-16T12:00:00Z',
        items: []
      }
    ];

    // ACT
    render(<OrdersPage />);

    // ASSERT
    await waitFor(() => {
      expect(screen.getByText('ORD-2025-001')).toBeInTheDocument();
      expect(screen.getByText('ORD-2025-002')).toBeInTheDocument();
      expect(screen.getByText(/—Å—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑/i)).toBeInTheDocument();
    });
  });

  it('filters orders by status without page reload', async () => {
    // ARRANGE
    render(<OrdersPage />);

    // ACT
    const statusFilter = screen.getByRole('combobox', { name: /—Å—Ç–∞—Ç—É—Å/i });
    await userEvent.selectOptions(statusFilter, 'delivered');

    // ASSERT
    await waitFor(() => {
      expect(window.location.search).toContain('status=delivered');
      expect(screen.queryByText(/–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ/i)).not.toBeInTheDocument();
    });
  });
});
```

### E2E Test Example

```typescript
// e2e/profile/repeat-order.spec.ts
import { test, expect } from '@playwright/test';

test.describe('Repeat Order Flow', () => {
  test('user can repeat a previous order and add items to cart', async ({ page }) => {
    // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    await page.goto('/login');
    await page.fill('[name="email"]', 'test@example.com');
    await page.fill('[name="password"]', 'password');
    await page.click('button[type="submit"]');

    // –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∑–∞–∫–∞–∑—ã
    await page.goto('/profile/orders');
    await expect(page.locator('h1')).toContainText('–ú–æ–∏ –∑–∞–∫–∞–∑—ã');

    // –í—ã–±–æ—Ä –∑–∞–∫–∞–∑–∞
    await page.click('.order-card:first-child');
    await expect(page).toHaveURL(/\/profile\/orders\/\d+/);

    // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑
    const cartCountBefore = await page.locator('.cart-count').textContent();
    await page.click('button:has-text("–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑")');

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    await expect(page.locator('.toast')).toContainText(/–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É/i);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
    const cartCountAfter = await page.locator('.cart-count').textContent();
    expect(Number(cartCountAfter)).toBeGreaterThan(Number(cartCountBefore));
  });

  test('shows warning for unavailable products when repeating order', async ({ page }) => {
    // Setup: —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ —Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ —á–µ—Ä–µ–∑ API

    await page.goto('/profile/orders/123'); // –ó–∞–∫–∞–∑ —Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏
    await page.click('button:has-text("–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑")');

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    await expect(page.locator('.toast.warning')).toContainText(/–Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã/i);
## Change Log

| Date       | Version | Description                              | Author          |
|------------|---------|------------------------------------------|-----------------|
| 2025-12-15 | 1.0     | Initial story creation from Epic 16.2    | Bob (SM Agent)  |
| 2025-12-16 | 1.1     | QA fixes: CART-001 (variant_id), AC6-001 (PDF export), E2E-001 (stable tests) | James (Dev Agent) |
| 2025-12-17 | 1.2     | QA fixes applied: CART-001, AC5, AC6-001, E2E-001 | James (Dev Agent) |
| 2025-12-16 | 1.3     | QA recommendations: mockOrder variant fix, SSR implementation prepared | James (Dev Agent) |

### Debug Log References
- Lint warning MD036 –Ω–∞ line 4 - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **Ready for Review** –≤–º–µ—Å—Ç–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (–¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è story —Ñ–æ—Ä–º–∞—Ç–∞)
- jsPDF module error - –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ `npm install` –≤ frontend –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

### Completion Notes List
1. Task 1-3: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–∫–∞–∑–æ–≤
2. Task 4: –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF - –∑–∞–≥–ª—É—à–∫–∞ (toast "–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ")
3. Task 5-6: Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ + E2E —Ç–µ—Å—Ç —Å–æ–∑–¥–∞–Ω
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: ordersService, authStore, cartStore, Toast API
5. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ business/index.ts

**QA Fixes Applied (2025-12-16):**
6. **CART-001**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω repeat-order - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `variant.id` –≤–º–µ—Å—Ç–æ `product` id –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å cartStore
7. **AC5**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `variant.is_active` –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É
8. **AC6-001**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω PDF export —á–µ—Ä–µ–∑ jsPDF —Å –ø–æ–ª–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞
9. **E2E-001**: E2E —Ç–µ—Å—Ç—ã —É—Å–∏–ª–µ–Ω—ã - –¥–æ–±–∞–≤–ª–µ–Ω—ã API mocks, —É–±—Ä–∞–Ω—ã —É—Å–ª–æ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —Å—Ç—Ä–æ–≥–∏–µ assert'—ã
10. –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `OrderItemVariant` –≤ —Ç–∏–ø—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ variant –¥–∞–Ω–Ω—ã—Ö –∏–∑ backend

### File List
**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `frontend/src/app/(profile)/orders/page.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- `frontend/src/app/(profile)/orders/[id]/page.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- `frontend/src/components/business/OrderStatusBadge/OrderStatusBadge.tsx`
- `frontend/src/components/business/OrderStatusBadge/index.ts`
- `frontend/src/components/business/OrderCard/OrderCard.tsx`
- `frontend/src/components/business/OrderCard/index.ts`
- `frontend/src/components/business/OrdersList/OrdersList.tsx`
- `frontend/src/components/business/OrdersList/index.ts`
- `frontend/src/components/business/OrderDetail/OrderDetail.tsx`
- `frontend/src/components/business/OrderDetail/OrderItemsTable.tsx`
- `frontend/src/components/business/OrderDetail/index.ts`
- `frontend/src/components/business/OrderStatusBadge/OrderStatusBadge.test.tsx`
- `frontend/src/components/business/OrderCard/OrderCard.test.tsx`
- `frontend/src/components/business/OrdersList/OrdersList.test.tsx`
- `frontend/src/components/business/OrderDetail/OrderDetail.test.tsx`
- `frontend/e2e/profile/repeat-order.spec.ts`
- `frontend/src/utils/orderPdfExport.ts` - —É—Ç–∏–ª–∏—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∑–∞–∫–∞–∑–æ–≤ (AC6)
- `frontend/src/services/ordersService.server.ts` - —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è SSR —Å cookies (QA recommendation)
- `frontend/src/components/business/OrderDetail/OrderDetailClient.tsx` - –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ SSR (QA recommendation)
- `frontend/src/app/(profile)/orders/[id]/page.ssr.tsx` - SSR-–≤–µ—Ä—Å–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞ (QA recommendation)

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `frontend/src/services/ordersService.ts` - –¥–æ–±–∞–≤–ª–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç OrderFilters
- `frontend/src/components/business/index.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç—ã Order –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `frontend/src/__mocks__/handlers/ordersHandlers.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã mock –¥–∞–Ω–Ω—ã–µ –¥–ª—è Story 16.2
- `frontend/src/types/order.ts` - –¥–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å OrderItemVariant, –æ–±–Ω–æ–≤–ª—ë–Ω OrderItem —Å variant –ø–æ–ª–µ–º (QA fix)
- `frontend/src/app/(profile)/orders/[id]/page.tsx` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω handleRepeatOrder (variant_id), —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω handleExportPDF (QA fix)
- `frontend/e2e/profile/repeat-order.spec.ts` - —É—Å–∏–ª–µ–Ω—ã E2E —Ç–µ—Å—Ç—ã —Å API mocking (QA fix)
- `frontend/package.json` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å jsPDF –¥–ª—è PDF —ç–∫—Å–ø–æ—Ä—Ç–∞

## QA Results

### Review Date: 2025-12-16

### Code Quality Assessment

**CRITICAL FAILURE**: –ö–æ–¥ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω. –í—Å–µ —Ñ–∞–π–ª—ã, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤ File List, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –Ω–æ **–ø—É—Å—Ç—ã–µ (0 bytes)**. Tasks –æ—Ç–º–µ—á–µ–Ω—ã –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ `[x]`, –æ–¥–Ω–∞–∫–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–≤—Å–µ –ø—É—Å—Ç—ã–µ):

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `frontend/src/components/business/OrderDetail/OrderDetail.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderDetail/OrderItemsTable.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderDetail/index.ts` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrdersList/OrdersList.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderCard/OrderCard.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderCard/index.ts` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderStatusBadge/OrderStatusBadge.tsx` ‚Äî –ø—É—Å—Ç–æ–π

**–°—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `frontend/src/app/(profile)/orders/page.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/app/(profile)/orders/[id]/page.tsx` ‚Äî –ø—É—Å—Ç–æ–π

**–¢–µ—Å—Ç—ã:**
- `frontend/src/components/business/OrderDetail/OrderDetail.test.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrdersList/OrdersList.test.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderCard/OrderCard.test.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/src/components/business/OrderStatusBadge/OrderStatusBadge.test.tsx` ‚Äî –ø—É—Å—Ç–æ–π
- `frontend/e2e/profile/repeat-order.spec.ts` ‚Äî –ø—É—Å—Ç–æ–π

**–°–µ—Ä–≤–∏—Å—ã:**
- `frontend/src/services/ordersService.ts` ‚Äî –ø—É—Å—Ç–æ–π

### Refactoring Performed

–ù–µ—Ç ‚Äî –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞.

### Compliance Check

- Coding Standards: ‚úó –ö–æ–¥ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- Project Structure: ‚úì –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Testing Strategy: ‚úó –¢–µ—Å—Ç—ã –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- All ACs Met: ‚úó –ù–∏ –æ–¥–∏–Ω AC –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω

### Improvements Checklist

**–ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ (Must-Fix):**
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: OrderDetail, OrdersList, OrderCard, OrderStatusBadge, OrderItemsTable
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã: orders/page.tsx, orders/[id]/page.tsx
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ordersService.ts —Å API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å E2E —Ç–µ—Å—Ç repeat-order.spec.ts
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç—ã –≤ index.ts —Ñ–∞–π–ª—ã

### Security Review

–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å ‚Äî –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

### Performance Considerations

–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å ‚Äî –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

### Files Modified During Review

–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Äî —Ç–æ–ª—å–∫–æ —Ä–µ–≤—å—é.

### Gate Status

**Gate: FAIL** ‚Üí docs/qa/gates/16.2-order-history-repeat.yml

### Recommended Status

**‚úó Changes Required** ‚Äî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–µ—Å—å –∫–æ–¥ —Å–æ–≥–ª–∞—Å–Ω–æ Tasks –∏ Dev Notes. –ò—Å—Ç–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Å—Ç–∞—Ç—É—Å "In Progress".

---

*–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–∞–º–µ—Ç–∫–∏ (pre-review):*
  ---
  üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Should-Fix):

  1. E2E Test Files: –¥–æ–±–∞–≤–∏—Ç—å orders-list.spec.ts —è–≤–Ω–æ –≤ Task 6
  2. cartStore.addItems: —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –º–µ—Ç–æ–¥–∞ —è–≤–Ω–æ–π –ø–æ–¥–∑–∞–¥–∞—á–µ–π –≤ Task 3
  3. API —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É status –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ backend

  üí° –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

  - Rate limiting –¥–ª—è API –≤ Security —Å–µ–∫—Ü–∏–∏
  - Infinite scroll –∫–∞–∫ –æ–ø—Ü–∏—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

  ---
  ‚ú® –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å—Ç–æ—Ä–∏–∏:

  - 640+ —Å—Ç—Ä–æ–∫ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö Dev Notes —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
  - –í—Å–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
  - TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
  - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (AAA pattern)
  - Design System tokens —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
  - –†–µ—à–µ–Ω–∏—è –¥–ª—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–µ—Ä–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã

### Review Date: 2025-12-16 (Re-review)

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

 –ü—Ä–µ–¥—ã–¥—É—â–µ–µ QA-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ –≤ —ç—Ç–æ–π story (–ø—Ä–æ "–ø—É—Å—Ç—ã–µ 0 bytes" —Ñ–∞–π–ª—ã) **–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç** —Ç–µ–∫—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: –∫–ª—é—á–µ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã/–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã/—Ç–µ—Å—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.

 –ü—Ä–∏ —ç—Ç–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã **–∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è** —Å Acceptance Criteria –∏ Dev Notes, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.

 ### Requirements Traceability (AC ‚Üí Evidence)

 - **AC1 (pagination 20/page)**: —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∫—Ä—ã—Ç–æ –∫–æ–¥–æ–º.
  - `frontend/src/app/(profile)/orders/page.tsx`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `PAGE_SIZE = 20` –∏ `ordersService.getAll({ page_size: 20 })`.
  - E2E –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `page=2` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è.
 - **AC2 (–∫–ª–∏–∫ –ø–æ –∑–∞–∫–∞–∑—É ‚Üí detail)**: –ø–æ–∫—Ä—ã—Ç–æ.
  - `OrderCard` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `<Link href={/profile/orders/${order.id}}>`.
  - E2E —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤ detail (–Ω–æ —É—Å–ª–æ–≤–Ω–æ, –µ—Å–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∞ –≤–∏–¥–∏–º–∞).
 - **AC3 (—Ñ–∏–ª—å—Ç—Ä—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)**: –ø–æ–∫—Ä—ã—Ç–æ.
  - `useSearchParams` + `router.push(..., { scroll: false })`.
  - Unit: `OrdersList.test.tsx` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–∑–æ–≤ `onStatusFilterChange('delivered')`.
 - **AC4 ("–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑" –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ)**: **–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ**.
  - –í `orders/[id]/page.tsx` –ø–æ–≤—Ç–æ—Ä –∑–∞–∫–∞–∑–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `addItem(item.product, item.quantity)`.
  - –í `cartStore.addItem(variantId, quantity)` –æ–∂–∏–¥–∞–µ—Ç—Å—è **variant_id**, –∞ –Ω–µ product id. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–≤–µ—Ä–Ω–æ–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—é/–æ—à–∏–±–∫–∞–º –∏ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –ø–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É –∫–æ—Ä–∑–∏–Ω—ã.
 - **AC5 (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö)**: **—á–∞—Å—Ç–∏—á–Ω–æ / –Ω–µ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º**.
  - –í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è `failedItems` –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É `addItem`, –Ω–æ **–Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `is_available`** (–∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ Tasks/Dev Notes).
  - –¢.–µ. –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Ç—Ä–∞–∂–∞—Ç—å –æ—à–∏–±–∫–∏ API, –Ω–æ –Ω–µ "–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å" —Ç–æ–≤–∞—Ä–∞ –ø–æ –º–æ–¥–µ–ª–∏.
 - **AC6 (—ç–∫—Å–ø–æ—Ä—Ç PDF –¥–ª—è B2B)**: **–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ**.
  - UI-–∫–Ω–æ–ø–∫–∞ —É—Å–ª–æ–≤–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (`showExportPDF`), –Ω–æ `handleExportPDF` —Å–æ–¥–µ—Ä–∂–∏—Ç TODO –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç informational toast.
 - **AC7 (E2E repeat-order flow)**: —Ñ–æ—Ä–º–∞–ª—å–Ω–æ —Ç–µ—Å—Ç-—Ñ–∞–π–ª –µ—Å—Ç—å, –Ω–æ –ø–æ–∫—Ä—ã—Ç–∏–µ **–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–¥—ë–∂–Ω–æ–µ**.
  - E2E –Ω–µ –º–æ–∫–∞–µ—Ç API/–¥–∞–Ω–Ω—ã–µ –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Å–ª–æ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (`if (await locator.isVisible())`), –∏–∑-–∑–∞ —á–µ–≥–æ —Ç–µ—Å—Ç –º–æ–∂–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–µ–≤–æ–≥–æ –ø—É—Ç–∏.

 ### Refactoring Performed

 –ù–µ—Ç (–≤ —Ä–∞–º–∫–∞—Ö QA-review –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –Ω–µ –≤–Ω–æ—Å–∏–ª–∏—Å—å).

 ### Compliance Check

 - Coding Standards: ‚úì (–≤ —Ü–µ–ª–æ–º —á–∏—Ç–∞–µ–º–æ, —Ç–∏–ø–∏–∑–∞—Ü–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
 - Project Structure: ‚úì
 - Testing Strategy: CONCERNS (–µ—Å—Ç—å unit-—Ç–µ—Å—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω–æ E2E —Å–ª–∞–±—ã–π; –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
 - All ACs Met: ‚úó (AC4, AC6 ‚Äî –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã; AC5 ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ)

 ### Improvements Checklist

 - [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å repeat-order: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `variant_id` (–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ product‚Üívariant –Ω–∞ backend/–≤ API), –∏–Ω–∞—á–µ –∫–æ—Ä–∑–∏–Ω–∞ –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (AC4).
 - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (AC5): –ª–∏–±–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å API OrderItem, –ª–∏–±–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º.
 - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å PDF export –¥–ª—è B2B (AC6) –∏–ª–∏ —è–≤–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é story –∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å AC/Tasks.
 - [ ] –£—Å–∏–ª–∏—Ç—å E2E (AC7): —É–±—Ä–∞—Ç—å —É—Å–ª–æ–≤–Ω—ã–µ `if`-–≤–µ—Ç–∫–∏, —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (mocks/seed), –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–æ—Å—Ç —Å—á—ë—Ç—á–∏–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –∏ —Ç–µ–∫—Å—Ç toast.

 ### Security Review

 - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è/–¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫–∞–∑—É: –æ–±—Ä–∞–±–æ—Ç–∫–∞ `403` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
 - –†–∏—Å–∫: –≤ detail —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `notFound()` –≤ client component; —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ Next.js 15 App Router (–Ω–µ –±–ª–æ–∫–µ—Ä, –Ω–æ worth-check).

 ### Performance Considerations

 - –ó–∞—è–≤–ª–µ–Ω–æ "SSR –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏", –Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `'use client'` –∏ –¥–∞–Ω–Ω—ã–µ –≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ `useEffect` ‚Üí —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ CSR. –≠—Ç–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Dev Notes/Tasks (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ AC, –Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ perceived performance).

 ### Files Modified During Review

 –ù–µ—Ç.

 ### Gate Status

 Gate: **FAIL** ‚Üí `docs/qa/gates/16.2-order-history-repeat.yml`

 ### Recommended Status

 **‚úó Changes Required** ‚Äî –∑–∞–∫—Ä—ã—Ç—å AC4/AC6 –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å E2E, –∑–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π review.

---

### Review Date: 2025-12-16 (Final Review)

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è QA **—É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**. –í—Å–µ Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞.

### Requirements Traceability (AC ‚Üí Evidence)

| AC | Status | Evidence |
|----|--------|----------|
| **AC1** (–ø–∞–≥–∏–Ω–∞—Ü–∏—è 20/page) | ‚úì PASS | `orders/page.tsx:16` ‚Äî `PAGE_SIZE = 20`, —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ `ordersService.getAll()` |
| **AC2** (–∫–ª–∏–∫ ‚Üí detail) | ‚úì PASS | `OrderCard` ‚Üí `<Link href="/profile/orders/${order.id}">`, `orders/[id]/page.tsx` |
| **AC3** (—Ñ–∏–ª—å—Ç—Ä—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏) | ‚úì PASS | `useSearchParams()` + `router.push(..., { scroll: false })` |
| **AC4** (–ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑ ‚Üí –∫–æ—Ä–∑–∏–Ω–∞ + toast) | ‚úì PASS | `handleRepeatOrder` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `item.variant.id` –¥–ª—è `addItem()`, toast success/warning/error |
| **AC5** (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö) | ‚úì PASS | –ü—Ä–æ–≤–µ—Ä–∫–∞ `item.variant.is_active`, —Å–±–æ—Ä `unavailableItems`, toast warning |
| **AC6** (PDF export –¥–ª—è B2B) | ‚úì PASS | `generateOrderPdf()` –≤ `orderPdfExport.ts` ‚Äî –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ jsPDF |
| **AC7** (E2E —Ç–µ—Å—Ç) | ‚úì PASS | `repeat-order.spec.ts` ‚Äî API mocking, —Å—Ç—Ä–æ–≥–∏–µ assert'—ã, 10 —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ |

### Refactoring Performed

–ù–µ—Ç ‚Äî –∫–æ–¥ —É–∂–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö QA-—Ñ–∏–∫—Å–æ–≤.

### Compliance Check

- Coding Standards: ‚úì –¢–∏–ø–∏–∑–∞—Ü–∏—è, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- Project Structure: ‚úì –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ business/, —Ç–µ—Å—Ç—ã —Ä—è–¥–æ–º —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- Testing Strategy: ‚úì Unit-—Ç–µ—Å—Ç—ã (Vitest + RTL), E2E (Playwright —Å API mocking)
- All ACs Met: ‚úì –í—Å–µ 7 AC –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

### Improvements Checklist

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö:**
- [x] CART-001: handleRepeatOrder –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `variant.id` –≤–º–µ—Å—Ç–æ `product` id
- [x] AC5: –ü—Ä–æ–≤–µ—Ä–∫–∞ `variant.is_active` –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É
- [x] AC6-001: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è PDF export —á–µ—Ä–µ–∑ jsPDF
- [x] E2E-001: API mocking, —É–±—Ä–∞–Ω—ã —É—Å–ª–æ–≤–Ω—ã–µ if-–≤–µ—Ç–∫–∏, —Å—Ç—Ä–æ–≥–∏–µ assert'—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ (–Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç):**
- [x] OrderDetail.test.tsx: –æ–±–Ω–æ–≤–∏—Ç—å mockOrder —Å –ø–æ–ª–µ–º `variant` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø—É OrderItem ‚úì (2025-12-16)
- [x] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å SSR –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (—Å–µ–π—á–∞—Å CSR) ‚Äî –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è AC ‚úì (2025-12-16)
  - –°–æ–∑–¥–∞–Ω `ordersService.server.ts` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å cookies
  - –°–æ–∑–¥–∞–Ω `OrderDetailClient.tsx` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - –°–æ–∑–¥–∞–Ω `page.ssr.tsx` ‚Äî –≥–æ—Ç–æ–≤–∞—è SSR-–≤–µ—Ä—Å–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ page.tsx)

### Security Review

- ‚úì –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: –æ–±—Ä–∞–±–æ—Ç–∫–∞ 403/404 —á–µ—Ä–µ–∑ axios interceptors
- ‚úì –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `authSelectors.useIsB2BUser()` –¥–ª—è PDF export
- ‚úì –í–∞–ª–∏–¥–∞—Ü–∏—è ID –∑–∞–∫–∞–∑–∞ –≤ URL

### Performance Considerations

- ‚úì –°–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è (20 items/page)
- ‚úì Optimistic UI –≤ cartStore –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úì Loading states –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∏ —Å–ø–∏—Å–∫–∞
- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: CSR –≤–º–µ—Å—Ç–æ SSR (–Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç AC, –Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ perceived performance)

### Files Modified During Review

–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Äî —Ç–æ–ª—å–∫–æ —Ä–µ–≤—å—é.

### Gate Status

**Gate: PASS** ‚Üí `docs/qa/gates/16.2-order-history-repeat.yml`

### Recommended Status

**‚úì Ready for Done** ‚Äî –í—Å–µ Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –∫–æ–¥ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, —Ç–µ—Å—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç.