# –≠–ø–∏–∫ 15: Checkout - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏–∏ 2.0

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-12-14
**–ü—Ä–∏—á–∏–Ω–∞:** –£–ø—Ä–æ—â–µ–Ω–∏–µ —ç–ø–∏–∫–∞ –ø–æ–¥ —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### **–í–µ—Ä—Å–∏—è 1.0 ‚Üí –í–µ—Ä—Å–∏—è 2.0: –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**

#### ‚ùå **–ß—Ç–æ –£–î–ê–õ–ï–ù–û –∏–∑ scope:**

1. **–†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏:**
   - ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CDEK API
   - ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Boxberry API
   - ‚ùå –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–¥—Ä–µ—Å–∞ –∏ –≤–µ—Å–∞
   - ‚ùå Story 15.3 (—Å—Ç–∞—Ä–∞—è): "–†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏"
   - ‚ùå `deliveryService.calculateDelivery()`
   - ‚ùå `/delivery/calculate` API endpoint

2. **–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞:**
   - ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YuKassa Payment Gateway
   - ‚ùå –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –Ω–∞ frontend
   - ‚ùå Story 15.4 (—Å—Ç–∞—Ä–∞—è): "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞–º–∏ –æ–ø–ª–∞—Ç—ã"
   - ‚ùå `paymentService.ts`
   - ‚ùå `PaymentMethods.tsx` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
   - ‚ùå `/payment/methods` API endpoint

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤:**
   - ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
   - ‚ùå `/orders/confirm` API endpoint

#### ‚úÖ **–ß—Ç–æ –î–û–ë–ê–í–õ–ï–ù–û –≤–º–µ—Å—Ç–æ:**

1. **–†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤:**
   - ‚úÖ –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ù–æ–≤—ã–π"
   - ‚úÖ Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–∫–∞–∑–∞
   - ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Ä—É—á–Ω—É—é –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã —á–µ—Ä–µ–∑ Django Admin:
     - –ù–æ–≤—ã–π ‚Üí –û–ø–ª–∞—á–µ–Ω ‚Üí –û—Ç–ø—Ä–∞–≤–ª–µ–Ω ‚Üí –î–æ—Å—Ç–∞–≤–ª–µ–Ω
   - ‚úÖ Backend –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ email –æ—Ç–ø—Ä–∞–≤–∫—É

2. **–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏:**
   - ‚úÖ –°–ø–∏—Å–æ–∫ —Å–ø–æ—Å–æ–±–æ–≤ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Django Admin
   - ‚úÖ Radio group –¥–ª—è –≤—ã–±–æ—Ä–∞: –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –ö—É—Ä—å–µ—Ä, –°–∞–º–æ–≤—ã–≤–æ–∑
   - ‚úÖ –°—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–£—Ç–æ—á–Ω—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"
   - ‚úÖ `GET /delivery/methods` API endpoint

3. **–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ checkout:**
   - ‚úÖ –ë–ï–ó —Å–µ–∫—Ü–∏–∏ "–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã"
   - ‚úÖ –°–µ–∫—Ü–∏–∏: –ö–æ–Ω—Ç–∞–∫—Ç—ã, –ê–¥—Ä–µ—Å, –î–æ—Å—Ç–∞–≤–∫–∞, –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
   - ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ –Ω–∞ success —Å—Ç—Ä–∞–Ω–∏—Ü–µ: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏"

---

## üìä **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π**

| –ê—Å–ø–µ–∫—Ç | –í–µ—Ä—Å–∏—è 1.0 | –í–µ—Ä—Å–∏—è 2.0 (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è) |
|--------|-----------|-------------------------|
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 4 –Ω–µ–¥–µ–ª–∏ | 2 –Ω–µ–¥–µ–ª–∏ |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Stories** | 6 | 5 |
| **–†–∞—Å—á—ë—Ç –¥–æ—Å—Ç–∞–≤–∫–∏** | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π (CDEK/Boxberry) | –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ |
| **–û–ø–ª–∞—Ç–∞** | –û–Ω–ª–∞–π–Ω (YuKassa) | –†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–¥–º–∏–Ω–æ–º |
| **API endpoints** | 6 | 3 |
| **External Services** | 3 (CDEK, Boxberry, YuKassa) | 1 (Email) |
| **–°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ | –†—É—á–Ω—ã–µ (Django Admin) |
| **Unit-—Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã—Ç–∏–µ** | 80%+ | 70%+ |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è |

---

## üîÑ **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ Stories**

### –í–µ—Ä—Å–∏—è 1.0 (6 stories):
1. Story 15.1: Checkout —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏ —Ñ–æ—Ä–º–∞
2. Story 15.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Orders API
3. Story 15.3: –†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ ‚ùå **–£–î–ê–õ–ï–ù–ê**
4. Story 15.4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞–º–∏ –æ–ø–ª–∞—Ç—ã ‚ùå **–£–î–ê–õ–ï–ù–ê**
5. Story 15.5: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
6. Story 15.6: E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í–µ—Ä—Å–∏—è 2.0 (5 stories):
1. **Story 15.1:** Checkout —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏ —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
   - –ë–ï–ó —Å–µ–∫—Ü–∏–∏ "–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã"
2. **Story 15.2:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Orders API –∏ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
3. **Story 15.3:** –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ (–ë–ï–ó —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏) ‚≠ê **–ù–û–í–ê–Ø**
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ Django Admin
4. **Story 15.4:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞–¥–º–∏–Ω–æ–º
5. **Story 15.5:** E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ —Ñ–ª–æ—É
   - –ë–ï–ó —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–ª–∞—Ç—ã

---

## üèóÔ∏è **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | V1.0 | V2.0 |
|-----------|------|------|
| `CheckoutForm.tsx` | ‚úÖ | ‚úÖ |
| `ContactSection.tsx` | ‚úÖ | ‚úÖ |
| `AddressSection.tsx` | ‚úÖ | ‚úÖ |
| `DeliveryOptions.tsx` | ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç | ‚úÖ –°–ø–∏—Å–æ–∫ –∏–∑ API |
| `PaymentMethods.tsx` | ‚úÖ | ‚ùå –£–î–ê–õ–Å–ù |
| `OrderSummary.tsx` | ‚úÖ | ‚úÖ |

### –°–µ—Ä–≤–∏—Å—ã:

| –°–µ—Ä–≤–∏—Å | V1.0 | V2.0 |
|--------|------|------|
| `ordersService.ts` | ‚úÖ | ‚úÖ |
| `deliveryService.ts` | ‚úÖ calculate() | ‚úÖ getMethods() |
| `paymentService.ts` | ‚úÖ | ‚ùå –£–î–ê–õ–Å–ù |

### API Endpoints:

| Endpoint | V1.0 | V2.0 |
|----------|------|------|
| `POST /orders/create` | ‚úÖ | ‚úÖ + email –∞–¥–º–∏–Ω—É |
| `POST /orders/confirm` | ‚úÖ | ‚ùå |
| `POST /delivery/calculate` | ‚úÖ | ‚ùå |
| `GET /delivery/methods` | ‚ùå | ‚úÖ **–ù–û–í–´–ô** |
| `GET /payment/methods` | ‚úÖ | ‚ùå |
| `GET /cart/` | ‚úÖ | ‚úÖ |
| `GET /profile/addresses` | ‚úÖ | ‚úÖ |

---

## üìù **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**

### V1.0:
- –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ YuKassa
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤

### V2.0:
- ‚úÖ –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è
- ‚úÖ Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–æ—Å—Ç–∞–≤–ª–µ–Ω
- ‚úÖ –°–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞
- ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–∫–∞–∑–∞–º–∏ —á–µ—Ä–µ–∑ Django Admin
- ‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ

---

## üöÄ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏**

1. **–ë—ã—Å—Ç—Ä–µ–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:** 2 –Ω–µ–¥–µ–ª–∏ –≤–º–µ—Å—Ç–æ 4
2. **–ü—Ä–æ—â–µ –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:** –ú–µ–Ω—å—à–µ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–ú–µ–Ω—å—à–µ —Ä–∏—Å–∫–æ–≤:** –ë–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
4. **–õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞:** –í—Å—ë —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Django Admin
5. **–ë—ã—Å—Ç—Ä–µ–µ MVP:** –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞–Ω—å—à–µ
6. **–ì–∏–±–∫–æ—Å—Ç—å:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å

---

## üîÆ **–ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (—Å–ª–µ–¥—É—é—â–∏–µ –≤–µ—Ä—Å–∏–∏)**

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

### **–í–µ—Ä—Å–∏—è 3.0 (–±—É–¥—É—â–∞—è):**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CDEK/Boxberry –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
- –û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ YuKassa
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –ø–ª–∞—Ç—ë–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –¢—Ä–µ–∫–∏–Ω–≥ –¥–æ—Å—Ç–∞–≤–∫–∏

---

## üìã **Migration Notes**

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Ä–∞–±–æ—Ç—É –Ω–∞–¥ —ç–ø–∏–∫–æ–º:

1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **epic-15-checkout.md –≤–µ—Ä—Å–∏–∏ 2.0**
2. ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é V1.0 –ø–æ CDEK/Boxberry/YuKassa
3. ‚úÖ –§–æ–∫—É—Å –Ω–∞ —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ —á–µ—Ä–µ–∑ Django Admin
4. ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
5. ‚úÖ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏

---

**–ê–≤—Ç–æ—Ä:** John (PM Agent) üìã
**–î–∞—Ç–∞:** 2025-12-14
**–í–µ—Ä—Å–∏—è:** 2.0.0
