# Docker Configuration –¥–ª—è FREESPORT Platform

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é FREESPORT Platform, –≤–∫–ª—é—á–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (docker-compose.yml)

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      FREESPORT Platform                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  nginx:80,443 ‚îÄ‚îÄ‚î¨‚îÄ‚ñ∫ backend:8000 (Django API)                  ‚îÇ
‚îÇ                 ‚îî‚îÄ‚ñ∫ frontend:3000 (Next.js)                    ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  backend:8001 ‚îÄ‚îÄ‚ñ∫ db:5432 (PostgreSQL)                        ‚îÇ
‚îÇ              ‚îî‚îÄ‚îÄ‚ñ∫ redis:6379 (–ö–µ—à –∏ —Å–µ—Å—Å–∏–∏)                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–°–µ—Ä–≤–∏—Å—ã:**

- **nginx** - Reverse proxy, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã, load balancing
- **backend** - Django REST API (–ø–æ—Ä—Ç 8001 ‚Üí 8000)
- **frontend** - Next.js SSR/SSG –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç 3000)
- **db** - PostgreSQL 15 –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Ä—Ç 5432)
- **redis** - Redis –∫–µ—à –∏ –æ—á–µ—Ä–µ–¥–∏ (–ø–æ—Ä—Ç 6379)

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã (docker-compose.test.yml)

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  backend-test ‚îÄ‚îÄ‚ñ∫ test-db:5432 (PostgreSQL —Ç–µ—Å—Ç—ã)             ‚îÇ
‚îÇ               ‚îî‚îÄ‚îÄ‚ñ∫ test-redis:6379 (Redis —Ç–µ—Å—Ç—ã)              ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  –û—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ—Ç—å: freesport-test-network                       ‚îÇ
‚îÇ  –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã: 5433, 6380                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–º–∞ (tmpfs) –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è

## –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker

```text
freesport/
‚îú‚îÄ‚îÄ docker-compose.yml          # –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ docker-compose.test.yml     # –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞
‚îú‚îÄ‚îÄ Makefile                    # –ö–æ–º–∞–Ω–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile              # Production –æ–±—Ä–∞–∑ Django
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.test         # –¢–µ—Å—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ Django  
‚îÇ   ‚îî‚îÄ‚îÄ .dockerignore          # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îî‚îÄ‚îÄ nginx/
‚îÇ       ‚îú‚îÄ‚îÄ nginx.conf         # –ì–ª–∞–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îÇ       ‚îî‚îÄ‚îÄ conf.d/
‚îÇ           ‚îî‚îÄ‚îÄ default.conf   # –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç
‚îî‚îÄ‚îÄ scripts/
    ‚îú‚îÄ‚îÄ test.sh               # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Unix
    ‚îî‚îÄ‚îÄ test.bat              # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Windows
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (23.08.2025)

### üî¥ –†–µ—à–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ë–î

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ production-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –í–æ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ `.env`

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** docker-compose.test.yml –Ω–µ —Å–æ–¥–µ—Ä–∂–∞–ª db –∏ redis —Å–µ—Ä–≤–∏—Å—ã

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ —Å:

- PostgreSQL —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (tmpfs, shm_size)
- Redis –±–µ–∑ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (tmpfs)  
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å freesport-test-network
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã (5433, 6380)

#### 3. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Å—ã–ª–∫–∏ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã nginx

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω—ã –ø–æ–ª–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

- `docker/nginx/nginx.conf` - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `docker/nginx/conf.d/default.conf` - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç

#### 4. –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤ 8000

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å –¥—Ä—É–≥–∏–º–∏ —Å–ª—É–∂–±–∞–º–∏ –Ω–∞ –ø–æ—Ä—Ç—É 8000

**–†–µ—à–µ–Ω–∏–µ:** Django —Å–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8001:

- –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ docker-compose —Ñ–∞–π–ª—ã
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã frontend –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ CI/CD

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ä–µ–¥–∞

| –°–µ—Ä–≤–∏—Å   | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π | –í–Ω–µ—à–Ω–∏–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|------------|---------|----------|
| nginx    | 80, 443    | 80, 443 | HTTP/HTTPS proxy |
| backend  | 8000       | 8001    | Django API |
| frontend | 3000       | 3000    | Next.js app |
| db       | 5432       | 5432    | PostgreSQL |  
| redis    | 6379       | 6379    | Redis cache |

### –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞

| –°–µ—Ä–≤–∏—Å     | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π | –í–Ω–µ—à–Ω–∏–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|------------|---------|----------|
| test-db    | 5432       | 5433    | PostgreSQL —Ç–µ—Å—Ç—ã |
| test-redis | 6379       | 6380    | Redis —Ç–µ—Å—Ç—ã |

## –ö–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Make –∫–æ–º–∞–Ω–¥—ã

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make build          # –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
make up             # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—Ä–µ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
make down           # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ä–µ–¥—É
make logs           # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
make clean          # –û—á–∏—Å—Ç–∏—Ç—å volumes –∏ –æ–±—Ä–∞–∑—ã

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  
make test           # –í—Å–µ —Ç–µ—Å—Ç—ã –≤ Docker
make test-unit      # Unit —Ç–µ—Å—Ç—ã
make test-integration # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
make test-fast      # –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑ —Å–±–æ—Ä–∫–∏

# –û—Ç–ª–∞–¥–∫–∞
make shell          # Shell –≤ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
make db-shell       # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make format         # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
make lint           # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
make migrate        # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```

### –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

**Windows:**

```cmd
scripts\test.bat
scripts\test-unit.bat  
scripts\test-integration.bat
```

**Linux/macOS:**

```bash
./scripts/test.sh
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã

### Dockerfile.test –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```dockerfile
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
RUN pip install --no-cache-dir \
    pytest-xdist \
    pytest-mock \  
    pytest-env \
    pytest-sugar \
    pytest-clarity

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
RUN mkdir -p /app/test-reports /app/htmlcov /app/test-logs

# –ö–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
CMD ["pytest", "-v", "--tb=short", "--cov=apps", 
     "--cov-report=html", "--cov-report=term-missing", 
     "--cov-fail-under=70"]
```

### PostgreSQL —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```yaml
# docker-compose.test.yml
db:
  tmpfs:
    - /tmp
  shm_size: 256mb
  healthcheck:
    interval: 10s  # –ë—ã—Å—Ç—Ä–µ–µ —á–µ–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ä–µ–¥–µ
    timeout: 5s
    retries: 5
```

### Redis —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```yaml
redis:
  command: redis-server --appendonly no --save "" --requirepass redis123
  tmpfs:
    - /data  # –í –ø–∞–º—è—Ç–∏ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ä–µ–¥–∞

```env
# Backend
DJANGO_SETTINGS_MODULE=freesport.settings.development
SECRET_KEY=development-secret-key
DB_HOST=db
DB_NAME=freesport
REDIS_URL=redis://:redis123@redis:6379/0

# Frontend  
NEXT_PUBLIC_API_URL=http://localhost:8001/api/v1
NODE_ENV=development
```

### –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞

```env
# Backend
DJANGO_SETTINGS_MODULE=freesport.settings.test
SECRET_KEY=test-secret-key-for-testing-only
DB_HOST=db
DB_NAME=freesport_test  
REDIS_URL=redis://:redis123@redis:6379/1
PYTEST_CURRENT_TEST=1
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### Health Checks

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏–º–µ—é—Ç health check'–∏:

- **PostgreSQL:** `pg_isready`
- **Redis:** `redis-cli ping`
- **Django:** `python manage.py check`
- **Next.js:** HTTP –ø—Ä–æ–≤–µ—Ä–∫–∞ `/api/health`

### –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

```bash
# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose logs -f backend

# Shell –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker compose exec backend bash

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker compose exec db psql -U postgres -d freesport
```

### Volumes –∏ –¥–∞–Ω–Ω—ã–µ

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä volumes
docker volume ls | grep freesport

# –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
docker compose --env-file .env -f docker-compose.test.yml down --volumes

# –ë—ç–∫–∞–ø –ë–î (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
docker compose exec db pg_dump -U postgres freesport > backup.sql
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### .dockerignore –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏

```gitignore
# backend/.dockerignore
.pytest_cache
__pycache__
*.pyc
.coverage
htmlcov/
node_modules/
.git
```

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤ Docker

```dockerfile
# –ö–æ–ø–∏—Ä—É–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–Ω–∞—á–∞–ª–∞ –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
COPY requirements.txt .
RUN pip install -r requirements.txt

# –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–¥ –ø–æ—Ç–æ–º
COPY . .
```

### –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞

```dockerfile
# –°—Ç–∞–¥–∏—è —Å–±–æ—Ä–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
FROM python:3.12-slim as builder
RUN python -m venv /opt/venv
COPY --from=builder /opt/venv /opt/venv

# –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Å—Ç–∞–¥–∏—è
FROM python:3.12-slim as production
COPY --from=builder /opt/venv /opt/venv
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```dockerfile
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
RUN groupadd -r freesport && useradd -r -g freesport freesport
USER freesport
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Nginx

```nginx
# –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-XSS-Protection "1; mode=block" always;  
add_header X-Content-Type-Options "nosniff" always;
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

**1. –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã**

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç–∞—Ö
netstat -tulpn | grep :8001
lsof -i :8001

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down
docker stop $(docker ps -aq)
```

**2. –û—à–∏–±–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π**  

```bash  
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫–∏
sudo chown -R $USER:$USER .
chmod -R 755 scripts/
```

**3. –ü—Ä–æ–±–ª–µ–º—ã —Å –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check –ë–î
docker compose ps
docker compose exec db pg_isready -U postgres
```

**4. –ü—Ä–æ–±–ª–µ–º—ã —Å Redis**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ  
docker compose exec redis redis-cli -a redis123 ping
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Docker Compose –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.docker.com/compose/)
- [Django –≤ Docker best practices](https://docs.docker.com/samples/django/)
- [Next.js Docker deployment](https://nextjs.org/docs/deployment#docker-image)
- [PostgreSQL Docker](https://hub.docker.com/_/postgres)
- [Redis Docker](https://hub.docker.com/_/redis)
