# Технический долг по Epic 12: Миграция на Design System v2.0

Этот документ содержит список задач, представляющих собой технический долг, который необходимо погасить для полного и качественного завершения миграции на дизайн-систему v2.0 в соответствии с [`docs/epics/epic-12/epic-12.design-system-v2-migration.md`](docs/epics/epic-12/epic-12.design-system-v2-migration.md:1).

## 1. Документация и Developer Experience (DX)

- [ ] **(Story 12.1, Gate 12.1)** Задокументировать процесс миграции: Создать руководство по миграции компонентов с v1.x на v2.0 для будущих разработчиков.
- [ ] **(Epic)** Обновить всю документацию по компонентам: Убедиться, что JSDoc и другие документы соответствуют реализации v2.0.
- [ ] **(Story 12.1, Gate 12.1)** Экспортировать дизайн-токены как JS/TS модуль для программного доступа в JavaScript (например, для Chart.js, canvas). _(Приоритет: Low, P3)_
- [ ] **(Story 12.1, Gate 12.1)** Создать UI-страницу (`/design-system`) для визуальной демонстрации всех токенов. _(Приоритет: Low, P3)_
- [ ] **(Story 12.1, Gate 12.1)** Интегрировать документацию по дизайн-токенам в Storybook. _(Приоритет: Low, P4)_
- [ ] **(Story 12.7)** Составить список недостающих изображений: Создать задачу для контент-менеджера со списком всех placeholder-изображений, их размерами и расположением (например, `images/categories/`, `images/blog/`).

## 2. Тестирование и QA

- [ ] **(Story 12.12)** Настроить Visual Regression тесты: Внедрить и настроить тесты визуальной регрессии для всех ключевых компонентов и страниц.
- [ ] **(Story 12.12)** Провести полное Cross-browser тестирование: Обеспечить корректное отображение на всех целевых браузерах (Chrome, Firefox, Safari, Edge).
- [ ] **(Epic)** Увеличить тестовое покрытие: Довести тестовое покрытие для всех новых и обновленных компонентов до >= 80%.
- [ ] **(Story 12.12)** Провести полное тестирование на реальных устройствах: Проверить адаптивность на популярных мобильных и планшетных устройствах.
- [ ] **(Story 12.3, Gate 12.3)** Создать comprehensive тесты для компонента `Header`, включая интеграцию с `authStore` через MSW. _(Приоритет: High, P0)_
- [ ] **(Story 12.4, Gate 12.4)** Увеличить `branch coverage` для `ProductCard`: Повысить с 62.5% до >= 70%, добавив тесты для edge cases (fallback-цены, роль `federation_rep`). _(Приоритет: Low, P3)_
- [ ] **(Story 12.4, Gate 12.4)** Добавить E2E тесты для `ProductCard`: Написать интеграционные тесты (например, с Playwright). _(Приоритет: Low, P3)_
- [ ] **(Story 12.5, Gate 12.5)** Исправить 8 неработающих тестов: 6 в `Chip` и 2 в `PriceRangeSlider` (валидация). _(Приоритет: Medium)_
- [ ] **(Story 12.6, Gate 12.6)** Исправить 2 "flaky" (нестабильных) теста в `Toast.test.tsx`, связанных с `fake timers` и `React.act`. _(Приоритет: Low)_
- [ ] **(Epic)** Провести тестирование на реальных данных: Выполнить E2E-тестирование и ручную проверку на данных, импортированных из 1С, для проверки ролевой модели, ценообразования и отображения каталога.

## 3. Доступность (Accessibility)

- [ ] **(Story 12.12)** Провести полный Accessibility audit: Выполнить аудит всех страниц и компонентов на соответствие стандарту WCAG 2.1 AA.
- [ ] **(Story 12.3, Gate 12.3)** Интегрировать `axe-core` в тесты для автоматической проверки WCAG 2.1 AA. _(Приоритет: Medium)_
- [ ] **(Story 12.1, 12.2)** Скорректировать контрастность: Исправить недостаточный контраст для `text-muted` (4.29:1 -> >=4.5:1), а также в компонентах `Badge` ("transit", "cancelled") и `Input` (helper text).

## 4. Производительность

- [ ] **(Story 12.12)** Провести полный Performance audit: Проанализировать производительность ключевых страниц (Главная, Каталог, Карточка товара) с помощью Core Web Vitals и Lighthouse.
- [ ] **(Story 12.12)** Внедрить мониторинг производительности: Настроить Lighthouse CI и мониторинг размера бандла.
- [ ] **(Story 12.4, Gate 12.4)** Оптимизировать `getProductPrice` в `ProductCard` с помощью `useMemo` для больших списков. _(Приоритет: Low, P3)_
- [ ] **(Story 12.5, Gate 12.5)** Оптимизировать `renderCategories` в `SidebarFilters` с помощью `useMemo` для больших списков категорий. _(Приоритет: Low)_

## 5. Рефакторинг и Улучшения

- [ ] **(Story 12.3, Gate 12.3)** Интегрировать `Header` с `cartStore` вместо использования placeholder данных. _(Приоритет: High, P0)_
- [ ] **(Story 12.3, Gate 12.3)** Выделить `ActionIcons` в `Header` в отдельный компонент для устранения дублирования кода. _(Приоритет: Low, P3)_
- [ ] **(Story 12.5, Gate 12.5)** Заменить inline-стиль в `SidebarFilters` (line 127) на Tailwind-классы. _(Приоритет: Low)_
- [ ] **(Story 12.6, Gate 12.6)** Выделить логику `useFocusTrap` из компонента `Modal` в отдельный переиспользуемый хук. _(Приоритет: Low)_
- [ ] **(Story 12.4, Gate 12.4)** Исправить warning `Next.js Image`: передавать проп `fill` как строку (`fill='true'`) или удалить его. _(Приоритет: Low, P3)_
